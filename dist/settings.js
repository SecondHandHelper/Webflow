!// modules are defined as an array
// [ module function, map of requires ]
//
// map of requires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the require for previous bundles
function(t,n,s,r,a){/* eslint-disable no-undef */var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},d="function"==typeof i[r]&&i[r],o=d.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function u(n,s){if(!o[n]){if(!t[n]){// if we cannot find the module within our internal map or
// cache jump to the current global require ie. the last bundle
// that was added to the page.
var a="function"==typeof i[r]&&i[r];if(!s&&a)return a(n,!0);// If there are other bundles on this page the require from the
// previous one is saved to 'previousRequire'. Repeat this as
// many times as there are bundles until the module is found or
// we exhaust the require chain.
if(d)return d(n,!0);// Try the node require function if it exists.
if(l&&"string"==typeof n)return l(n);var c=Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(s){var r=t[n][1][s];return null!=r?r:s},p.cache={};var m=o[n]=new u.Module(n);t[n][0].call(m.exports,p,m,m.exports,this)}return o[n].exports;function p(t){var n=p.resolve(t);return!1===n?{}:u(n)}}u.isParcelRequire=!0,u.Module=function(t){this.id=t,this.bundle=u,this.exports={}},u.modules=t,u.cache=o,u.parent=d,u.register=function(n,s){t[n]=[function(t,n){n.exports=s},{}]},Object.defineProperty(u,"root",{get:function(){return i[r]}}),i[r]=u;for(var c=0;c<n.length;c++)u(n[c]);if(s){// Expose entry point to Node, AMD or browser globals
// Based on https://github.com/ForbesLindesay/umd/blob/master/template.js
var m=u(s);// CommonJS
"object"==typeof exports&&"undefined"!=typeof module?module.exports=m:"function"==typeof define&&define.amd?define(function(){return m}):a&&(this[a]=m)}}({"3jmDt":[function(t,n,s){let r;var a=t("./general");async function i(){try{g(),await callBackendApi("/api/users",{data:{data:(0,a.getFormAddressFields)()},method:"PUT"}),await y()}catch(t){errorHandler.report(t),console.log("Error updating user",t)}}async function d(){g();let t="",n=document.getElementsByName("shippingMethodSettings");for(let s=0;s<n.length;s++)n[s].checked&&(t=n[s].value);// "Service point" or "Pickup"
await callBackendApi("/api/users",{data:{data:{preferences:{shippingMethod:t}}},method:"PUT"}),await y()}async function o(t){try{let n;g(),await callBackendApi("/api/users",{data:{data:(n=t?swishNumber.value.trim():phoneNumber.value.trim(),t?{swishPayeeAlias:formatPhoneNumber(n)}:{phoneNumber:formatPhoneNumber(n)})},method:"PUT"}),await y()}catch(t){errorHandler.report(t)}}async function l(){try{g(),await callBackendApi("/api/users",{data:{data:{personalId:(0,a.formatPersonalId)(personalId.value.trim().replace(/\D/g,""))}},method:"PUT"}),await y()}catch(t){errorHandler.report(t),console.log("Error updating user",t)}}let u="",c=document.getElementById("pageTitleText");async function m(t){try{let t=await callBackendApi("/api/users",{requiresAuth:!0});r=t.data,await p(r.personalId),console.log("data",r);let n=r?.preferences?.shippingMethod||null;console.log("shippingMethod",n),addressDisplay.innerHTML=r.addressStreetAddress?`${r.addressFirstName} ${r.addressLastName}${r.addressCO?`, C/o ${r.addressCO}`:""}<br/>${r.addressStreetAddress}<br/>${r.addressPostalCode} ${r.addressCity}`:"-",console.log("address displayed"),swishNumberDisplay.innerHTML=r.swishPayeeAlias||"-",console.log("swish displayed"),phoneNumberDisplay.innerHTML=r.phoneNumber||"-",console.log("phoneNumberDisplay"),console.log("data.phoneNumber",r.phoneNumber),n?("Pickup"===n&&(shippingPreferencesDisplay.innerHTML="Upph\xe4mtning vid d\xf6rren"),"Service point"===n&&(shippingPreferencesDisplay.innerHTML="L\xe4mna till ombud",// Hide expand button since we don't allow users to change to Pickup anymore
expandShippingPrefButton.style.display="none")):shippingPreferencesDisplay.innerHTML="-"}catch(t){errorHandler.report(t),console.log("error fetching user data",t)}finally{t||(loadingDiv.style.display="none",settingsContainer.style.display="block")}}async function p(t){let n="-";if((u=t||"").length>4){n=u.substring(u.length-4),personalIdDisplay.innerHTML=`XXXXXXXX${n}`;return}personalIdDisplay.innerHTML=n}async function y(){await m(!0),savedCheckIcon.style.display="flex",saveLoadingSpinner.style.display="none"}function g(){saveButton.style.display="none",saveLoadingSpinner.style.display="flex"}function f(t,n,s,r){document.getElementById(n).style.display="block",document.getElementById("updateContainer").style.display="block",document.getElementById("goBackDiv").style.display="none",document.getElementById("resetPageDiv").style.display="block",saveButton.style.display="block",saveButtonContainer.style.display="flex",settingsContainer.style.display="none",c.innerHTML=r,c.value=r,s&&(s===personalId?s.value=u:s.value=document.getElementById(t).innerHTML.length>2?document.getElementById(t).innerHTML:"",s.dispatchEvent(new Event("input"))),"shippingPrefForm"===n&&(document.getElementById(t).innerHTML.includes("ombud")&&(servicePointSettings.previousElementSibling.classList.add("w--redirected-checked"),servicePointSettings.checked=!0),document.getElementById(t).innerHTML.includes("Upph\xe4mtning")&&(pickupSettings.previousElementSibling.classList.add("w--redirected-checked"),pickupSettings.checked=!0))}function h(t){return!!t.validity.valid&&"Spara"===saveButton.innerHTML}function v(t,n){t.style.display=n?"inline-block":"none"}function b(){saveButton.style.display="flex",savedCheckIcon.style.display="none",saveLoadingSpinner.style.display="none"}//Address
adressDiv.addEventListener("click",async function(){await (0,a.setFormAddressFields)(r),f("adressDiv","addressForm",null,"Adress")}),addressFirstName.addEventListener("input",function(){v(firstNameLabel,addressFirstName.value),b()}),addressLastName.addEventListener("input",function(){v(lastNameLabel,addressLastName.value),b()}),addressStreetAddress.addEventListener("input",function(){v(streetAddressLabel,addressStreetAddress.value),b()}),addressCO.addEventListener("input",function(){v(addressCoLabel,addressCO.value),b()}),addressPostalCode.addEventListener("input",function(){v(postalCodeLabel,addressPostalCode.value),b()}),addressCity.addEventListener("input",function(){v(cityLabel,addressCity.value),b()}),addressDoorCode.addEventListener("input",function(){v(doorCodeLabel,addressDoorCode.value),b()}),//Phone
phoneDiv.addEventListener("click",function(){f("phoneNumberDisplay","phoneForm",phoneNumber,"Mobilnummer")}),phoneNumber.addEventListener("input",function(){v(phoneNumberLabel,phoneNumber.value),b();let t=formatPhoneNumber(phoneNumber.value),n=t.length>=12&&t.includes("+")?"":"Ogiltigt mobilnummer";phoneNumber.setCustomValidity(n)}),//Shipping
shippingPrefDiv.addEventListener("click",function(){shippingPreferencesDisplay.innerHTML.includes("ombud")?(shippingPrefInfoText.style.display="block",setTimeout(function(){shippingPrefInfoText.style.display="none"},3e3)):f("shippingPreferencesDisplay","shippingPrefForm",null,"Skicka plagg")}),//Swish
swishDiv.addEventListener("click",function(){f("swishNumberDisplay","swishForm",swishNumber,"Swish")}),swishNumber.addEventListener("input",()=>{v(swishNumberLabel,swishNumber.value),b();let t=0!==swishNumber.length?"":"Ogiltigt swishnummer";swishNumber.setCustomValidity(t)}),personIdDiv.addEventListener("click",function(){f("fullPersonId","personIdForm",personalId,"Personnummer")}),personalId.addEventListener("input",()=>{v(personalIdLabel,personalId.value),b();let t=(0,a.isValidSwedishSsn)(personalId.value)?"":"Ogiltigt personnummer";personalId.setCustomValidity(t)}),saveButton.addEventListener("click",async function(){switch(c.value){case"Adress":(function(t){let n=!0;for(let s of t)s.validity.valid||(n=!1);return!!n&&"Spara"===saveButton.innerHTML})([addressFirstName,addressLastName,addressCity,addressPostalCode,addressStreetAddress])&&await i(),addressFirstName.reportValidity(),addressLastName.reportValidity(),addressCity.reportValidity(),addressPostalCode.reportValidity(),addressStreetAddress.reportValidity();break;case"Skicka plagg":await d();break;case"Personnummer":h(personalId)&&await l(),personalId.reportValidity();break;case"Swish":h(swishNumber)&&await o(!0),swishNumber.reportValidity();break;case"Mobilnummer":h(phoneNumber)&&await o(),phoneNumber.reportValidity()}}),resetPageButton.addEventListener("click",()=>{document.getElementById({Adress:"addressForm",Mobilnummer:"phoneForm",Swish:"swishForm",Personnummer:"personIdForm","Skicka plagg":"shippingPrefForm"}[c.value]).style.display="none",document.getElementById("updateContainer").style.display="none",document.getElementById("goBackDiv").style.display="block",document.getElementById("resetPageDiv").style.display="none",settingsContainer.style.display="block",saveButton.style.display="none",saveLoadingSpinner.style.display="none",savedCheckIcon.style.display="none",c.innerHTML="Inst\xe4llningar",c.value="Inst\xe4llningar"}),m()},{"./general":"1tOWF"}],"1tOWF":[function(t,n,s){var r=t("@parcel/transformer-js/src/esmodule-helpers.js");function a(){firebase.auth().signOut().then(()=>{console.log("User signed out"),authUser.current=null,user.current=null,userId=null,localStorage.removeItem("sessionUser"),localStorage.removeItem("idToken"),localStorage.removeItem("authUserId"),localStorage.removeItem("authUser"),deleteCookie("maiAuth"),callBackendApi("/api/users/session",{method:"DELETE",extraHeaders:{credentials:"include"}}).catch(t=>{errorHandler.report(t),console.warn("[SSO] Error clearing session cookie:",e)}),location.href="/"}).catch(t=>{errorHandler.report(t),console.log(t)})}function i(t){document.getElementById("addressFirstName").value=t.addressFirstName||"",document.getElementById("addressFirstName").dispatchEvent(new Event("input")),document.getElementById("addressLastName").value=t.addressLastName||"",document.getElementById("addressLastName").dispatchEvent(new Event("input")),document.getElementById("addressStreetAddress").value=t.addressStreetAddress||"",document.getElementById("addressStreetAddress").dispatchEvent(new Event("input")),document.getElementById("addressCO").value=t.addressCO||"",document.getElementById("addressCO").dispatchEvent(new Event("input")),document.getElementById("addressPostalCode").value=t.addressPostalCode||"",document.getElementById("addressPostalCode").dispatchEvent(new Event("input")),document.getElementById("addressCity").value=t.addressCity||"",document.getElementById("addressCity").dispatchEvent(new Event("input")),document.getElementById("addressDoorCode").value=t.addressDoorCode||"",document.getElementById("addressDoorCode").dispatchEvent(new Event("input"))}function d(){let t=document.getElementById("addressFirstName").value,n=document.getElementById("addressLastName").value,s=document.getElementById("addressStreetAddress").value,r=document.getElementById("addressCO").value,a=document.getElementById("addressPostalCode").value,i=document.getElementById("addressCity").value,d=document.getElementById("addressDoorCode").value;return t=t?t.trim().charAt(0).toUpperCase()+t.trim().slice(1):"",n=n?n.trim().charAt(0).toUpperCase()+n.trim().slice(1):"",s=s?s.trim().charAt(0).toUpperCase()+s.trim().slice(1):"",r=r?r.trim():"",{addressFirstName:t,addressLastName:n,addressStreetAddress:s,addressCO:r,addressPostalCode:a=a?a.trim().replace(/\D/g,""):"",addressCity:i=i?i.trim().charAt(0).toUpperCase()+i.trim().slice(1):"",addressDoorCode:d=d?d.trim():""}}function o(t){// verify we got 10 digits, otherwise it is invalid
if(10!==(t=t.replace(/\D/g,"")// strip out all but digits
.split("")// convert string to array
.reverse()// reverse order for Luhn
.slice(0,10)).length)return!1;let n=t.map(t=>Number(t)).reduce((t,n,s)=>(s%2&&(n*=2),n>9&&(n-=9),t+n));return 0==n%10}function l(t){let n=t.replace("-","");return(12!==n.length&&("19"!==n.substring(0,2)||"20"!==n.substring(0,2))&&(n=99>=Number(n.substring(0,2))&&Number(n.substring(0,2))>25?"19"+n:"20"+n),12===n.length)?n:null}function u(t){if(t.images){let n=t.images;return n.modelImageSmall||n.modelImage||n.coverImageSmall||n.coverImage||n.enhancedFrontImageSmall||n.enhancedFrontImage||n.frontImageSmall||n.frontImage}if(t.imagesv2)for(let n of["modelImage","enhancedFrontImage","frontImage"]){let s=t.imagesv2.find(t=>t.name===n);if(s){if(s?.versions?.small)return s.versions.small;if(s?.versions?.medium)return s.versions.medium;if(s?.versions?.large)return s.versions.large;if(s.url)return s.url}}return null}function c(){let t;let n=user.current.referralData.referralCode;if(t=user.current?.maiCircle?"H\xe4r f\xe5r du en exklusiv inbjudan till Mai, som ger en extra fin start med tre kommissionsfria f\xf6rs\xe4ljningar.":"Jag bjuder in dig till Mai f\xf6r att s\xe4lja dina kl\xe4der! G\xe5 genom min l\xe4nk f\xf6r att f\xe5 en extra kommissionsfri f\xf6rs\xe4ljning.",navigator.share)navigator.share({text:t,url:`https://invite.maiapp.se/refer?invite=${n}`}).then(()=>{console.log("Thanks for sharing!")}).catch(t=>{console.error(t),errorHandler.report(t)});else{console.log("Browser doesn't support navigator.share => Copy to clipboard!");let s=t+"\n"+`https://invite.maiapp.se/refer?invite=${n}`;navigator.clipboard.writeText(s),linkCopiedBanner.style.display="flex",setTimeout(function(){linkCopiedBanner.style.display="none"},1500)}}function m(t){let n=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;n?(document.getElementById("continueOnWebBottomSheet").href=window.location.origin+t,document.getElementById("darkOverlay").classList.add("active"),document.getElementById("channelBottomSheet").classList.add("active")):window.location.href=t}function p(){document.getElementById("darkOverlay").classList.remove("active"),document.getElementById("channelBottomSheet").classList.remove("active")}function y(t){let n=document.getElementById(t);n&&(// Set initial position below screen
n.style.transform="translateY(100%)",n.style.transition="transform 0.3s ease-out",n.style.display="block",// Animate to visible position
setTimeout(()=>{n.style.transform="translateY(0%)"},10),document.getElementById("darkOverlay").classList.add("active"))}function g(t){let n=document.getElementById(t);// Add the visibility check here
n&&"none"!==n.style.display&&(// Animate down and hide
n.style.transform="translateY(100%)",n.style.transition="transform 0.3s ease-in",// Hide after animation completes
setTimeout(()=>{n.style.display="none"},300),document.getElementById("darkOverlay").classList.remove("active"))}function f(t){let n=document.getElementById(t);if(n){n.style.display="none";// Check if there are any remaining visible cards
let t=document.getElementById("infoRequestsList");if(t){let n=t.querySelectorAll('[id^="infoRequest"]:not([style*="display: none"])');if(0===n.length){let t=document.getElementById("infoRequestsDiv");t&&(t.style.display="none")}}}}r.defineInteropFlag(s),r.export(s,"signOut",()=>a),r.export(s,"setFormAddressFields",()=>i),r.export(s,"getFormAddressFields",()=>d),// Validate Swedish Social Security Number (personnummer) using checksum
//   Note: this is somewhat simplified because it does not take into account
//   that the date of the number is valid (e.g. "000000-0000" does return as true)
r.export(s,"isValidSwedishSsn",()=>o),r.export(s,"formatPersonalId",()=>l),r.export(s,"itemCoverImage",()=>u),r.export(s,"shareCode",()=>c),// Channel bottom sheet
r.export(s,"channelRouter",()=>m),r.export(s,"hideChannelBottomSheet",()=>p),// End of channel bottom sheet
// Toast animation functions
r.export(s,"animateOpenToast",()=>y),r.export(s,"animateCloseToast",()=>g),r.export(s,"hideInfoRequestCard",()=>f)},{"@parcel/transformer-js/src/esmodule-helpers.js":"bNgzC"}],bNgzC:[function(t,n,s){s.interopDefault=function(t){return t&&t.__esModule?t:{default:t}},s.defineInteropFlag=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.exportAll=function(t,n){return Object.keys(t).forEach(function(s){"default"===s||"__esModule"===s||n.hasOwnProperty(s)||Object.defineProperty(n,s,{enumerable:!0,get:function(){return t[s]}})}),n},s.export=function(t,n,s){Object.defineProperty(t,n,{enumerable:!0,get:s})}},{}]},["3jmDt"],"3jmDt","parcelRequire81ca")//# sourceMappingURL=settings.js.map
;
//# sourceMappingURL=settings.js.map
