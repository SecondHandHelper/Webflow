{"mappings":"A,+C","sources":["<anon>","sellItemModelSearch.js"],"sourcesContent":["(function () {\nconst $e77017ff7d94c51d$export$6556d46d2662453c = (fieldId, value)=>{\n    document.getElementById(fieldId).value = value || \"\";\n    document.getElementById(fieldId).dispatchEvent(new Event(\"input\"));\n};\nconst $e77017ff7d94c51d$var$selectSize = (modelClicked)=>(event)=>{\n        $e77017ff7d94c51d$var$closeModelSelect();\n        // Show selected model in search box\n        document.getElementById(\"findModelBoxEmpty\").style.display = \"none\";\n        document.getElementById(\"findModelBoxFilled\").style.display = \"flex\";\n        const modelJson = modelClicked.getAttribute(\"data-model\");\n        document.getElementById(\"findModelBoxFilled\").setAttribute(\"data-model\", modelJson);\n        const model = JSON.parse(modelJson);\n        document.getElementById(\"findModelBoxImage\").style.backgroundImage = `url('${model[\"coverImageSmall\"]}')`;\n        document.getElementById(\"findModelBoxNameCategory\").innerText = `${model[\"brand\"]}, ${model[\"category\"]}`;\n        document.getElementById(\"findModelBoxName\").innerText = `${model[\"maiName\"]}`;\n        document.getElementById(\"findModelBoxColor\").innerText = `${model[\"color\"]}`;\n        document.getElementById(\"findModelBoxGender\").innerText = `${model[\"gender\"]}`;\n        // Fill form with attributes from selected model\n        document.getElementById(model[\"gender\"]).parentElement.click();\n        $e77017ff7d94c51d$export$6556d46d2662453c(\"itemSize\", event.target.innerText);\n        $e77017ff7d94c51d$export$6556d46d2662453c(\"itemMaterial\", model[\"material\"]);\n        $e77017ff7d94c51d$export$6556d46d2662453c(\"itemModel\", model[\"maiName\"]);\n        $e77017ff7d94c51d$export$6556d46d2662453c(\"itemOriginalPrice\", model[\"originalPriceSek\"]);\n        document.getElementById(\"findModelDescription\").style.display = \"none\";\n        document.getElementById(\"findNewModel\").style.display = \"flex\";\n        if (model[\"collectionYear\"] + 1 >= new Date().getFullYear()) {\n            document.getElementById(\"itemAge\").selectedIndex = 1;\n            document.getElementById(\"itemAge\").style.color = \"rgb(51, 51, 51)\";\n            document.getElementById(\"itemAge\").dispatchEvent(new Event(\"input\"));\n        }\n        document.getElementById(\"itemCategory\").value = model[\"category\"];\n        $(\"#itemCategory\").trigger(\"change\");\n        document.getElementById(\"itemColor\").value = model[\"color\"];\n        $(\"#itemColor\").trigger(\"change\");\n        document.getElementById(\"findModelDiv\").scrollIntoView(true);\n    };\nconst $e77017ff7d94c51d$var$showModelSizes = (modelClicked)=>{\n    window.scrollTo({\n        top: 0\n    });\n    const templateSize = document.getElementById(\"modelSizeTemplate\");\n    const modelSizeList = document.getElementById(\"modelSizeList\");\n    while(modelSizeList.firstChild)modelSizeList.removeChild(modelSizeList.lastChild);\n    const model = JSON.parse(modelClicked.getAttribute(\"data-model\"));\n    if (model.sizes.length === 1) return $e77017ff7d94c51d$var$selectSize(modelClicked)({\n        target: {\n            innerText: model.sizes[0]\n        }\n    });\n    for (const [idx, size] of model.sizes.sort($e77017ff7d94c51d$var$sizeCompare).entries()){\n        const newNode = templateSize.cloneNode(true);\n        newNode.id = `${templateSize.id}_${idx}`;\n        newNode.addEventListener(\"click\", linkClickTracker);\n        newNode.style.display = \"block\";\n        newNode.addEventListener(\"click\", function clickHandler(event) {\n            $e77017ff7d94c51d$var$selectSize(modelClicked)(event);\n            this.removeEventListener(\"click\", clickHandler);\n        });\n        for (const child of Array.from(newNode.getElementsByTagName(\"*\")))child.id = `${child.id}_${idx}`;\n        modelSizeList.appendChild(newNode);\n        document.getElementById(`modelSize_${idx}`).innerText = size;\n    }\n};\nconst $e77017ff7d94c51d$var$selectModel = (event)=>{\n    document.getElementById(\"modelList\").style.display = \"none\";\n    document.getElementById(\"modelSizeSelect\").style.display = \"block\";\n    document.getElementById(\"modelSelectTitle\").innerText = \"V\\xe4lj storlek\";\n    $e77017ff7d94c51d$var$showModelSizes(event.currentTarget);\n};\nconst $e77017ff7d94c51d$var$showModelItems = (models)=>{\n    window.scrollTo({\n        top: 0\n    });\n    const templateCard = document.getElementById(\"modelCardTemplate\");\n    const modelResultList = document.getElementById(\"modelResultList\");\n    while(modelResultList.firstChild)modelResultList.removeChild(modelResultList.lastChild);\n    for (const [idx, model] of models.entries()){\n        const newNode = templateCard.cloneNode(true);\n        newNode.id = `${templateCard.id}_${idx}`;\n        newNode.addEventListener(\"click\", linkClickTracker);\n        newNode.style.display = \"flex\";\n        newNode.style.cursor = \"pointer\";\n        newNode.setAttribute(\"data-model\", JSON.stringify(model));\n        newNode.addEventListener(\"click\", $e77017ff7d94c51d$var$selectModel);\n        for (const child of Array.from(newNode.getElementsByTagName(\"*\")))child.id = `${child.id}_${idx}`;\n        modelResultList.appendChild(newNode);\n        document.getElementById(`modelImage_${idx}`).src = model[\"coverImageSmall\"];\n        document.getElementById(`brandNameCategory_${idx}`).innerText = `${model[\"brand\"]}, ${model[\"category\"]}`;\n        document.getElementById(`modelName_${idx}`).innerText = `${model[\"maiName\"]}`;\n        document.getElementById(`modelColor_${idx}`).innerText = `${model[\"color\"]}`;\n        document.getElementById(`modelGender_${idx}`).innerText = `${model[\"gender\"]}`;\n    }\n};\nfunction $e77017ff7d94c51d$var$modelCompare(a, b) {\n    const nameA = a[\"maiName\"].toLowerCase();\n    const nameB = b[\"maiName\"].toLowerCase();\n    if (nameA > nameB) return 1;\n    if (nameA < nameB) return -1;\n    return 0;\n}\nfunction $e77017ff7d94c51d$var$sizeCompare(a, b) {\n    const sizeOrdering = [\n        \"XXS\",\n        \"XS\",\n        \"S\",\n        \"M\",\n        \"L\",\n        \"XL\",\n        \"XXL\"\n    ];\n    if (sizeOrdering.indexOf(a) > -1 && sizeOrdering.indexOf(b) > -1) return sizeOrdering.indexOf(a) - sizeOrdering.indexOf(b);\n    return a - b;\n}\nfunction $e77017ff7d94c51d$var$showFindModelPage() {\n    document.getElementById(\"addItemFormDiv\").style.display = \"none\";\n    document.getElementById(\"modelSelectError\").style.display = \"none\";\n    document.getElementById(\"modelSizeSelect\").style.display = \"none\";\n    document.getElementById(\"modelSelectTitle\").innerText = \"V\\xe4lj modell\";\n    document.getElementById(\"modelSelectDiv\").style.display = \"block\";\n    document.getElementById(\"modelList\").style.display = \"block\";\n    document.getElementById(\"modelSearchInput\").value = \"\";\n    window.scrollTo({\n        top: 0\n    });\n    let modelDb = sessionStorage.getItem(\"models\");\n    if (!modelDb) {\n        document.getElementById(\"modelSpinner\").style.display = \"flex\";\n        const timerId = setInterval(()=>{\n            modelDb = sessionStorage.getItem(\"models\");\n            if (modelDb) {\n                clearInterval(timerId);\n                document.getElementById(\"modelSpinner\").style.display = \"none\";\n                $e77017ff7d94c51d$var$showModelItems(JSON.parse(modelDb).sort($e77017ff7d94c51d$var$modelCompare));\n            }\n        }, 1000);\n    } else {\n        document.getElementById(\"modelSpinner\").style.display = \"none\";\n        $e77017ff7d94c51d$var$showModelItems(JSON.parse(modelDb).sort($e77017ff7d94c51d$var$modelCompare));\n    }\n}\nconst $e77017ff7d94c51d$var$closeModelSelect = ()=>{\n    document.getElementById(\"addItemFormDiv\").style.display = \"block\";\n    document.getElementById(\"modelSelectDiv\").style.display = \"none\";\n    document.getElementById(\"modelSizeSelect\").style.display = \"none\";\n};\nconst $e77017ff7d94c51d$export$db031f5bdb61d38b = ()=>{\n    document.getElementById(\"findModelBoxEmpty\").addEventListener(\"click\", $e77017ff7d94c51d$var$showFindModelPage);\n    document.getElementById(\"findNewModel\").addEventListener(\"click\", $e77017ff7d94c51d$var$showFindModelPage);\n    document.getElementById(\"modelSelectClose\").addEventListener(\"click\", ()=>{\n        $e77017ff7d94c51d$var$closeModelSelect();\n    });\n    document.getElementById(\"modelSearchInput\").addEventListener(\"input\", ()=>{\n        const modelSearchString = document.getElementById(\"modelSearchInput\").value;\n        const modelDb = JSON.parse(sessionStorage.getItem(\"models\"));\n        if (modelSearchString && modelSearchString.length > 0) {\n            const fuse = new Fuse(modelDb, {\n                includeScore: true,\n                keys: [\n                    \"maiName\",\n                    \"category\",\n                    \"color\",\n                    \"maiColor\",\n                    \"articleNumber\",\n                    \"name\"\n                ]\n            });\n            const searchResult = fuse.search(modelSearchString.replace(\", \", \" \"));\n            $e77017ff7d94c51d$var$showModelItems(searchResult.map((r)=>r.item));\n        } else $e77017ff7d94c51d$var$showModelItems(modelDb.sort($e77017ff7d94c51d$var$modelCompare));\n    });\n    document.getElementById(\"removeModelIcon\").addEventListener(\"click\", (event)=>{\n        document.getElementById(\"findModelBoxEmpty\").style.display = \"flex\";\n        document.getElementById(\"findModelBoxFilled\").style.display = \"none\";\n        document.getElementById(\"findModelDescription\").style.display = \"block\";\n        document.getElementById(\"findNewModel\").style.display = \"none\";\n        event.stopPropagation();\n    });\n};\nconst $e77017ff7d94c51d$export$3fc08105d74e7970 = async (value)=>{\n    if (featureIsEnabled(\"modelDB\")) {\n        if (value === \"Rodebjer\") {\n            findModelDiv.style.display = \"block\";\n            let response = await fetch(\"https://getbrandmodels-heypmjzjfq-ew.a.run.app?brand=Rodebjer\", {\n                method: \"GET\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n            const models = await response.json();\n            sessionStorage.setItem(\"models\", JSON.stringify(models));\n        }\n    }\n};\n\n})();\n//# sourceMappingURL=sellItemModelSearch.js.map\n","export const setFieldValue = (fieldId, value) => {\n  document.getElementById(fieldId).value = value || '';\n  document.getElementById(fieldId).dispatchEvent(new Event('input'));\n}\n\nconst selectSize = (modelClicked) => (event) => {\n  closeModelSelect();\n  // Show selected model in search box\n  document.getElementById('findModelBoxEmpty').style.display = 'none';\n  document.getElementById('findModelBoxFilled').style.display = 'flex';\n  const modelJson = modelClicked.getAttribute(\"data-model\");\n  document.getElementById('findModelBoxFilled').setAttribute(\"data-model\", modelJson)\n  const model = JSON.parse(modelJson);\n  document.getElementById('findModelBoxImage').style.backgroundImage = `url('${model[\"coverImageSmall\"]}')`;\n  document.getElementById('findModelBoxNameCategory').innerText = `${model['brand']}, ${model['category']}`;\n  document.getElementById('findModelBoxName').innerText = `${model['maiName']}`;\n  document.getElementById('findModelBoxColor').innerText = `${model['color']}`;\n  document.getElementById('findModelBoxGender').innerText = `${model['gender']}`;\n\n  // Fill form with attributes from selected model\n  document.getElementById(model['gender']).parentElement.click();\n  setFieldValue('itemSize', event.target.innerText);\n  setFieldValue('itemMaterial', model['material']);\n  setFieldValue('itemModel', model['maiName']);\n  setFieldValue('itemOriginalPrice', model['originalPriceSek']);\n  document.getElementById('findModelDescription').style.display = 'none';\n  document.getElementById('findNewModel').style.display = 'flex';\n  if (model['collectionYear'] + 1 >= new Date().getFullYear()) {\n    document.getElementById('itemAge').selectedIndex = 1;\n    document.getElementById('itemAge').style.color = 'rgb(51, 51, 51)';\n    document.getElementById('itemAge').dispatchEvent(new Event('input'));\n  }\n  document.getElementById('itemCategory').value = model['category'];\n  $('#itemCategory').trigger('change');\n  document.getElementById('itemColor').value = model['color'];\n  $('#itemColor').trigger('change');\n  document.getElementById('findModelDiv').scrollIntoView(true);\n}\n\nconst showModelSizes = (modelClicked) => {\n  window.scrollTo({ top: 0 });\n  const templateSize = document.getElementById('modelSizeTemplate');\n  const modelSizeList = document.getElementById('modelSizeList');\n  while (modelSizeList.firstChild) {\n    modelSizeList.removeChild(modelSizeList.lastChild);\n  }\n  const model = JSON.parse(modelClicked.getAttribute(\"data-model\"));\n  if (model.sizes.length === 1) {\n    return selectSize(modelClicked)({target: { innerText: model.sizes[0] }});\n  }\n  for (const [idx, size] of model.sizes.sort(sizeCompare).entries()) {\n    const newNode = templateSize.cloneNode(true);\n    newNode.id = `${templateSize.id}_${idx}`;\n    newNode.addEventListener('click', linkClickTracker);\n    newNode.style.display = 'block';\n    newNode.addEventListener('click', function clickHandler(event) {\n      selectSize(modelClicked)(event);\n      this.removeEventListener('click', clickHandler);\n    });\n    for (const child of Array.from(newNode.getElementsByTagName('*'))) {\n      child.id = `${child.id}_${idx}`;\n    }\n    modelSizeList.appendChild(newNode);\n    document.getElementById(`modelSize_${idx}`).innerText = size;\n  }\n}\n\nconst selectModel = (event) => {\n  document.getElementById('modelList').style.display = 'none';\n  document.getElementById('modelSizeSelect').style.display = 'block';\n  document.getElementById('modelSelectTitle').innerText = 'Välj storlek';\n  showModelSizes(event.currentTarget);\n}\n\nconst showModelItems = (models) => {\n  window.scrollTo({ top: 0 });\n  const templateCard = document.getElementById('modelCardTemplate');\n  const modelResultList = document.getElementById('modelResultList');\n  while (modelResultList.firstChild) {\n    modelResultList.removeChild(modelResultList.lastChild);\n  }\n  for (const [idx, model] of models.entries()) {\n    const newNode = templateCard.cloneNode(true);\n    newNode.id = `${templateCard.id}_${idx}`;\n    newNode.addEventListener('click', linkClickTracker);\n    newNode.style.display = 'flex';\n    newNode.style.cursor = 'pointer';\n    newNode.setAttribute(\"data-model\", JSON.stringify(model));\n    newNode.addEventListener('click', selectModel);\n    for (const child of Array.from(newNode.getElementsByTagName('*'))) {\n      child.id = `${child.id}_${idx}`;\n    }\n    modelResultList.appendChild(newNode);\n    document.getElementById(`modelImage_${idx}`).src = model['coverImageSmall'];\n    document.getElementById(`brandNameCategory_${idx}`).innerText = `${model['brand']}, ${model['category']}`;\n    document.getElementById(`modelName_${idx}`).innerText = `${model['maiName']}`;\n    document.getElementById(`modelColor_${idx}`).innerText = `${model['color']}`;\n    document.getElementById(`modelGender_${idx}`).innerText = `${model['gender']}`;\n  }\n}\n\nfunction modelCompare(a, b) {\n  const nameA = a[\"maiName\"].toLowerCase();\n  const nameB = b[\"maiName\"].toLowerCase();\n  if (nameA > nameB) {\n    return 1;\n  }\n  if (nameA < nameB) {\n    return -1;\n  }\n  return 0;\n}\n\nfunction sizeCompare(a, b) {\n  const sizeOrdering = ['XXS', 'XS', 'S', 'M', 'L', 'XL', 'XXL']\n  if (sizeOrdering.indexOf(a) > -1 && sizeOrdering.indexOf(b) > -1) {\n    return sizeOrdering.indexOf(a) - sizeOrdering.indexOf(b)\n  }\n  return a - b;\n}\n\nfunction showFindModelPage() {\n  document.getElementById('addItemFormDiv').style.display = 'none';\n  document.getElementById('modelSelectError').style.display = 'none';\n  document.getElementById('modelSizeSelect').style.display = 'none';\n  document.getElementById('modelSelectTitle').innerText = 'Välj modell';\n  document.getElementById('modelSelectDiv').style.display = 'block';\n  document.getElementById('modelList').style.display = 'block';\n  document.getElementById('modelSearchInput').value = '';\n  window.scrollTo({ top: 0 });\n  let modelDb = sessionStorage.getItem('models');\n  if (!modelDb) {\n    document.getElementById('modelSpinner').style.display = 'flex'\n    const timerId = setInterval(() => {\n      modelDb = sessionStorage.getItem('models');\n      if (modelDb) {\n        clearInterval(timerId);\n        document.getElementById('modelSpinner').style.display = 'none';\n        showModelItems(JSON.parse(modelDb).sort(modelCompare));\n      }\n    }, 1000);\n  } else {\n    document.getElementById('modelSpinner').style.display = 'none';\n    showModelItems(JSON.parse(modelDb).sort(modelCompare));\n  }\n}\n\nconst closeModelSelect = () => {\n  document.getElementById('addItemFormDiv').style.display = 'block';\n  document.getElementById('modelSelectDiv').style.display = 'none';\n  document.getElementById('modelSizeSelect').style.display = 'none';\n}\n\nexport const setupModelSearchEventListeners = () => {\n  document.getElementById('findModelBoxEmpty').addEventListener('click', showFindModelPage)\n  document.getElementById('findNewModel').addEventListener('click', showFindModelPage)\n  document.getElementById('modelSelectClose').addEventListener('click', () => {\n    closeModelSelect();\n  })\n\n  document.getElementById('modelSearchInput').addEventListener('input', () => {\n    const modelSearchString = document.getElementById('modelSearchInput').value;\n    const modelDb = JSON.parse(sessionStorage.getItem('models'));\n    if (modelSearchString && modelSearchString.length > 0) {\n      const fuse = new Fuse(modelDb, {\n        includeScore: true,\n        keys: [\"maiName\", \"category\", \"color\", \"maiColor\", \"articleNumber\", \"name\"]\n      });\n      const searchResult = fuse.search(modelSearchString.replace(', ', ' '));\n      showModelItems(searchResult.map(r => r.item));\n    } else {\n      showModelItems(modelDb.sort(modelCompare));\n    }\n  })\n\n  document.getElementById('removeModelIcon').addEventListener('click', (event) => {\n    document.getElementById('findModelBoxEmpty').style.display = 'flex';\n    document.getElementById('findModelBoxFilled').style.display = 'none';\n    document.getElementById('findModelDescription').style.display = 'block';\n    document.getElementById('findNewModel').style.display = 'none';\n    event.stopPropagation();\n  });\n}\n\nexport const displayFindModelDiv = async (value) => {\n  if (featureIsEnabled('modelDB')) {\n    if (value === 'Rodebjer'){\n      findModelDiv.style.display = 'block';\n      let response = await fetch('https://getbrandmodels-heypmjzjfq-ew.a.run.app?brand=Rodebjer', {\n        method: 'GET',\n        headers: { 'Content-Type': 'application/json' },\n      });\n      const models = await response.json();\n      sessionStorage.setItem('models', JSON.stringify(models));\n    }\n  }\n}\n"],"names":[],"version":3,"file":"sellItemModelSearch.js.map"}