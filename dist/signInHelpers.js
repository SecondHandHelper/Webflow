!function(e,t,n,o,i,s,r,l){var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},d="function"==typeof a[o]&&a[o],u=d.i||{},c=d.cache||{},g="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function p(t,n){if(!c[t]){if(!e[t]){if(i[t])return i[t];var s="function"==typeof a[o]&&a[o];if(!n&&s)return s(t,!0);if(d)return d(t,!0);if(g&&"string"==typeof t)return g(t);var r=Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}u.resolve=function(n){var o=e[t][1][n];return null!=o?o:n},u.cache={};var l=c[t]=new p.Module(t);e[t][0].call(l.exports,u,l,l.exports,a)}return c[t].exports;function u(e){var t=u.resolve(e);if(!1===t)return{};if(Array.isArray(t)){var n={__esModule:!0};return t.forEach(function(e){var t=e[0],o=e[1],i=e[2]||e[0],s=p(o);"*"===t?Object.keys(s).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:function(){return s[e]}})}):"*"===i?Object.defineProperty(n,t,{enumerable:!0,value:s}):Object.defineProperty(n,t,{enumerable:!0,get:function(){return"default"===i?s.__esModule?s.default:s:s[i]}})}),n}return p(t)}}p.isParcelRequire=!0,p.Module=function(e){this.id=e,this.bundle=p,this.require=g,this.exports={}},p.modules=e,p.cache=c,p.parent=d,p.distDir=void 0,p.publicUrl=void 0,p.devServer=void 0,p.i=u,p.register=function(t,n){e[t]=[function(e,t){t.exports=n},{}]},Object.defineProperty(p,"root",{get:function(){return a[o]}}),a[o]=p;for(var m=0;m<t.length;m++)p(t[m]);if(n){var y=p(n);"object"==typeof exports&&"undefined"!=typeof module?module.exports=y:"function"==typeof define&&define.amd&&define(function(){return y})}}({ioxVe:[function(e,t,n,o){async function i(){if(function(){for(let[e,t]of Object.entries({facebook:/\bFB[\w_]+\//,twitter:/\bTwitter/i,tiktok:/\bBytedance\//i,instagram:/\bInstagram/i}))if(t.test(navigator.userAgent))return e;return!1}()){let e=document.getElementById("inAppBrowserInfo");e.classList.contains("tooltip-show")||setTimeout(()=>{e.classList.add("tooltip-show"),analytics.track("Element Viewed",{elementID:"googleInAppBrowserPopup"})},0);return}googleButtonText.style.display="none",googleButtonLoadingIcon.style.display="block";var e=new firebase.auth.GoogleAuthProvider;try{await firebase.auth().signInWithPopup(e),await authUser.whenSet(signedInNextStep)}catch(e){errorHandler.report(e),console.log(`[webflow] Error signing in with Google: ${e.code}, ${e.message}, ${e.email}, ${e}`)}}function s(e){if(!e.length)return;let t="google.com"===e?"googleSignInButton":"phone"===e?"smsCodeButton":"emailAndPasswordButton",n=document.getElementById(t),o=n.parentElement;preferredSignInMethodDiv.appendChild(o.removeChild(n)),preferredSignInMethodDiv.style.display="block",showOtherSignInMethodsButton.style.display="flex",otherSignInMethodsDiv.style.display="none"}document.addEventListener("click",e=>{let t=document.getElementById("inAppBrowserInfo");t.contains(e.target)||t.classList.remove("tooltip-show")});let r=new URL(window.location).searchParams;if(r.has("s")&&r.get("s").length>=3?getSignInInfo(r.get("s")).then(e=>{(e.email||e.phone||e.method)&&(emailAddress.value=e.email,document.getElementById("signinPhoneNumber").value=e.phone?.replace("+46",""),"google.com"===e.method?(displayIntroDivText("logInIntroText",e.email),s("google.com")):"password"===e.method?(loginAlternativesDiv.style.display="none",displayIntroDivText("logInIntroText"),l()):"phone"===e.method&&(displayIntroDivText("logInIntroText"),phoneLoginDiv.style.display="block",mobileNumberDiv.style.display="block",orLoginOtherWayDiv.style.display="block",loginAlternativesDiv.style.display="none"))}):s(getPreferredLogInMethodCookie()),userIsSellingNewItem()){let e=JSON.parse(sessionStorage.getItem("itemToBeCreatedAfterSignIn")).item;itemImage.src=e?.images?.enhancedFrontImageSmall||e?.images?.enhancedFrontImage||"",notificationText.innerHTML=`F\xf6r att fullf\xf6lja f\xf6rs\xe4ljningen av ditt ${e.brand}-plagg beh\xf6ver du logga in eller skapa konto`,itemToBeCreatedDiv.style.display="block"}function l(){let e=emailAddress.value;firebase.auth().fetchSignInMethodsForEmail(e).then(t=>{chooseEmailDiv.style.display="none",-1!==t.indexOf(firebase.auth.EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD)?(signinWithEmailDiv.style.display="block",document.getElementById("prefilledEmail").innerText=`Ange l\xf6senord f\xf6r ${e}`):(choosePasswordDiv.style.display="block",document.getElementById("createAccountEmail").innerText=`V\xe4lj l\xf6senord f\xf6r ${e}`)}).catch(e=>{errorHandler.report(e),console.log("Error message:",e.code,e.message)})}$("#Password-form").submit(function(){return!1}),$("#Choose-password-form").submit(function(){return!1}),document.getElementById("Phone-number-form").addEventListener("submit",function(e){e.preventDefault(),submitLoadIcon.style.display="block",sendCodeButton.style.display="none";let t=signinPhoneNumber.value.startsWith("0")?signinPhoneNumber.value.slice(1):signinPhoneNumber.value,n=t.startsWith("+46")?t:`+46${t}`;console.log("signInWithPhoneNumber",n),callBackendApi("/api/users/authStart",{data:{phoneNumber:n},requiresAuth:!1}).then(()=>{window.phoneNumber=n,mobileNumberDiv.style.display="none",verifyDiv.style.display="block"}).catch(e=>{submitLoadIcon.style.display="none",errorMessageDiv.innerText=e.message,console.log("Error message: "+e.message),errorHandler.report(e)})}),signinButton.addEventListener("click",function(){let e=verificationCode.value;console.log("Verify screen. My code: ",e),console.log("phone number to verify",phoneNumber);let t=!1;callBackendApi("/api/users/phoneNumberExists",{data:{phoneNumber},requiresAuth:!1}).then(n=>{console.log("phoneNumberExists result",phoneNumber,JSON.stringify(n));let o=n.data.exists?"signIn":"signUp";return t="signUp"===o,callBackendApi("/api/users/authVerify",{data:{phoneNumber,code:e,type:o},requiresAuth:!1})}).then(e=>{let t=e.data.customToken;return firebase.auth().signInWithCustomToken(t)}).then(e=>{"undefined"!=typeof Storage?(sessionStorage.setItem("userId",e.uid),sessionStorage.setItem("phone",e.phoneNumber)):console.log("Sorry, your browser does not support Web Storage..."),console.log("isNewUser",t),t?(emailForTipsDiv.style.display="block",verifyDiv.style.display="none",phoneLoginDiv.style.display="none"):authUser.whenSet(signedInNextStep)}).catch(e=>{console.log("My error: "+e.message),errorHandler.report(e)})}),smsCodeButton.addEventListener("click",function(){phoneLoginDiv.style.display="block",mobileNumberDiv.style.display="block",orLoginOtherWayDiv.style.display="block",loginAlternativesDiv.style.display="none"}),emailNextStepButton.addEventListener("click",l),tipsEmailButton.addEventListener("click",function(){try{tipsEmailButton.style.display="none",loadingSpinnerDiv.style.display="flex","undefined"!=typeof Storage?sessionStorage.setItem("email",emailTipsInput.value):console.log("Sorry, your browser does not support Web Storage..."),authUser.whenSet(signedInNextStep)}catch(e){console.log("failed to add email",e),loadingSpinnerDiv.style.display="none",tipsEmailButton.style.display="block",errorHandler.report(e)}}),resetPasswordLink.addEventListener("click",function(){let e=emailAddress.value;firebase.auth().sendPasswordResetEmail(e).then(()=>{console.log("Reset password email sent"),forgotPasswordText.innerHTML=`Email skickat till ${e}`}).catch(e=>{errorHandler.report(e),console.log(e.code,e.message)})}),signUpWithEmailButton.addEventListener("click",function(){let e=emailAddress.value,t=newPassword.value;signUpWithEmailButton.style.display="none",passwordGoBack.style.display="none",newPasswordLoadIcon.style.display="block",firebase.auth().createUserWithEmailAndPassword(e,t).then(e=>{let t=e.user;window.userId=t.uid,console.log("Logged in user: ",t),firebase.auth().currentUser.sendEmailVerification().then(()=>{authUser.whenSet(()=>signedInNextStep("./user-management?mode=sendEmailVerification"))})}).catch(e=>{errorHandler.report(e);var t=e.code,n=e.message;console.log("Error message:",t,n),newPasswordFeedback.innerText=n,signUpWithEmailButton.style.display="block",passwordGoBack.style.display="block",newPasswordLoadIcon.style.display="none"})}),signInWithEmailButton.addEventListener("click",function(){let e=emailAddress.value,t=emailPassword.value;signInWithEmailButton.style.display="none",passwordLoadIcon.style.display="block",firebase.auth().signInWithEmailAndPassword(e,t).then(e=>{let t=e.user;window.userId=t.uid,console.log("Logged in user: ",t.uid),authUser.whenSet(()=>{authUser.current.emailVerified||"true"===getCookie("viewedVerifyEmailDiv")?signedInNextStep():signedInNextStep("./user-management?mode=sendEmailVerification")})}).catch(e=>{errorHandler.report(e),console.log("Error message:",e.code,e.message),"auth/wrong-password"===e.code&&(passwordFeedback.innerText="Fel lÃ¶senord",passwordFeedback.style.display="block",signInWithEmailButton.style.display="block",passwordLoadIcon.style.display="none")})}),showOtherSignInMethodsButton.addEventListener("click",function(){triggerOtherSignInMethodsView.click()}),document.getElementById("passwordGoBack").addEventListener("click",()=>{chooseEmailDiv.style.display="block",choosePasswordDiv.style.display="none",document.getElementById("Choose-email-form").style.display="block",document.querySelector(".success-message").style.display="none"}),googleSignInButton.addEventListener("click",i),googleSignInButton2.addEventListener("click",i),document.getElementById("emailAndPasswordButton").addEventListener("click",function(){console.log("button clicked"),chooseEmailDiv.style.display="block",loginAlternativesDiv.style.display="none"})},{}]},["ioxVe"],"ioxVe","parcelRequire81ca",{});
//# sourceMappingURL=signInHelpers.js.map
