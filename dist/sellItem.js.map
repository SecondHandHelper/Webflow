{"mappings":"C,A,eCgBI,EChBG,eAAe,EAAgB,CAAK,CAAE,CAAQ,EAC5C,eAAe,OAAA,CAAQ,cACxB,eAAe,OAAA,CAAQ,YAAa,MAAO,KAE/C,IAAM,EAAS,eAAe,OAAA,CAAQ,aAClC,EAAQ,MAAM,EAAoB,GACtC,GAAI,CAAC,EACD,KAAM,oCAEV,IAAM,EAAO,IAAI,SACjB,EAAK,MAAA,CAAO,SAAU,GACtB,EAAK,MAAA,CAAO,WAAY,GACxB,EAAK,MAAA,CAAO,OAAQ,GACpB,EAAK,MAAA,CAAO,YAAa,QACzB,EAAK,MAAA,CAAO,qBAAsB,QAClC,IAAM,EAAW,MAAM,MAAM,wDAAyD,CAClF,OAAQ,OACR,KAAM,CACV,GACA,OAAO,MAAM,EAAS,IAAtB,EACJ,CAEA,eAAe,EAAoB,CAAK,SACpC,AAAI,EAAM,IAAA,CAAO,QAEN,QAAQ,OAAA,CAAQ,GAEpB,IAAI,QAAQ,CAAC,EAAS,KAGzB,IAAM,EAAS,IAAI,UACnB,CAAA,EAAO,MAAA,CAAS,KACZ,IAAM,EAAM,SAAS,aAAA,CAAc,MACnC,CAAA,EAAI,MAAA,CAAS,KACT,IAAI,EAAQ,EAAI,KAAhB,CACI,EAAS,EAAI,MAAjB,AACI,CAAA,EAAQ,EACJ,EATE,OAUF,GAAmB,AAVjB,KAU6B,EAC/B,EAXE,MAcF,EAbG,OAcH,GAAiB,AAdd,KAc2B,EAC9B,EAfG,MAkBX,IAAM,EAAS,SAAS,aAAA,CAAc,SACtC,CAAA,EAAO,KAAA,CAAQ,EACf,EAAO,MAAA,CAAS,EAChB,IAAM,EAAM,EAAO,UAAA,CAAW,KAC9B,CAAA,EAAI,qBAAA,CAAwB,OAC5B,EAAI,SAAA,CAAU,EAAK,EAAG,EAAG,EAAO,GAChC,EAAO,MAAA,CAAO,EAAS,aAC3B,EACA,EAAI,GAAA,CAAM,EAAO,MAAjB,CACA,EAAO,OAAA,CAAU,CACrB,EACA,EAAO,aAAA,CAAc,EACzB,EACJ,CAEO,eAAe,IAElB,GAAI,CACA,IAAM,EAAW,MAAM,MAFP,mDAE0B,CACtC,OAAQ,OACR,QAAS,CACL,eAAgB,kBACpB,CACJ,GACA,GAAI,CAAC,EAAS,EAAA,CAEV,OADA,QAAQ,KAAA,CAAM,CAAC,OAAO,EAAE,EAAS,UAAA,CAAW,CAAC,EACtC,KAEX,IAAM,EAAO,MAAM,EAAS,IAA5B,GACA,OAAO,EAAK,EAAZ,AACJ,CAAE,MAAO,EAAO,CAEZ,OADA,QAAQ,KAAA,CAAM,CAAC,iDAAiD,EAAE,EAAM,OAAA,CAAQ,CAAC,CAAE,GAC5E,QACX,CACJ,CAEO,eAAe,EAAkB,CAAQ,CAAE,EAAY,CAAA,CAAI,EAC9D,IAAM,EAAoB,MAAM,EAAoB,GAMpD,OALI,GAAmB,MACnB,EAA0B,qBAAsB,EAAkB,GAAA,CAAK,EAAkB,QAAzF,EACA,EAAiB,aAAc,OAAO,UAAA,EAAc,IAAM,EAAkB,QAAA,CAAW,EAAkB,GAAzG,GAEJ,EAAoB,cACb,CACX,CAEA,eAAe,EAAoB,CAAQ,EACvC,GAAI,CACA,IAAM,EAAW,MAAM,SAAS,GAAA,GAAM,SAAA,CAAU,gBAAgB,aAAA,CAAc,qBAAqB,CAAE,SAAA,CAAS,GAE9G,OADA,eAAe,OAAA,CAAQ,qBAAsB,EAAS,IAAA,CAAK,GAA3D,EACO,EAAS,IAAhB,AACJ,CAAE,MAAO,EAAI,CAGT,OAFA,aAAa,MAAA,CAAO,GACpB,QAAQ,KAAA,CAAM,GACP,EACX,CACJ,CAEO,SAAS,EAAoB,CAAS,EACzC,SAAS,cAAA,CAAe,CAAC,OAAO,EAAE,EAAsB,GAAW,IAAI,CAAC,EAAE,KAAA,CAAM,OAAA,CAAU,OAC1F,SAAS,cAAA,CAAe,CAAC,MAAM,EAAE,EAAsB,GAAW,IAAI,CAAC,EAAE,KAAA,CAAM,OAAA,CAAU,eACvE,eAAd,GACA,CAAA,SAAS,cAAA,CAAe,wBAAwB,KAAA,CAAM,OAAA,CAAU,MADpE,CAGJ,CAEO,SAAS,EAA0B,CAAS,CAAE,CAAQ,CAAE,CAAa,EACxE,IAAI,EAAU,KAAK,KAAA,CAAM,aAAa,OAAA,CAAQ,YAAc,KAAK,SAAA,CAAU,CAAC,IACtE,EAAS,EAAQ,MAAA,EAAU,CAAC,CAClC,CAAA,CAAM,CAAC,EAAU,CAAG,EACpB,CAAM,CAAC,CAAC,EAAE,EAAU,KAAK,CAAC,CAAC,CAAG,EAC9B,EAAQ,MAAA,CAAS,EACjB,aAAa,OAAA,CAAQ,UAAW,KAAK,SAAA,CAAU,GACnD,CAEO,SAAS,EAAiB,CAAS,CAAE,CAAG,EAC3C,SAAS,cAAA,CAAe,CAAC,EAAE,EAAU,OAAO,CAAC,EAAE,KAAA,CAAM,eAAA,CAAkB,CAAC,KAAK,EAAE,EAAI,EAAE,CAAC,CACtF,EAAoB,EACxB,CAEO,SAAS,EAAsB,CAAM,EACxC,OAAO,EAAO,MAAA,CAAO,GAAG,WAAA,GAAgB,EAAO,KAAA,CAAM,EACzD,CAEO,eAAe,EAA0B,CAAK,CAAE,CAAS,EAC5D,GAAI,EACA,AA+BR,SAAwB,CAAS,EAC7B,IAAM,EAAa,SAAS,cAAA,CAAe,GAAW,UAAA,CAAW,UAAjE,AACA,CAAA,EAAW,aAAA,CAAc,wBAAwB,KAAA,CAAM,OAAA,CAAU,MACrE,EAlCuB,GACf,IAAI,EAAM,IAAI,eAAA,CAAgB,EAC9B,CAAA,SAAS,cAAA,CAAe,CAAC,EAAE,EAAU,gBAAgB,CAAC,EAAE,KAAA,CAAM,eAAA,CAAkB,CAAC,KAAK,EAAE,EAAI,EAAE,CAAC,CAC/F,SAAS,cAAA,CAAe,CAAC,EAAE,EAAU,OAAO,CAAC,EAAE,KAAA,CAAM,eAAA,CAAkB,CAAC,KAAK,EAAE,EAAI,EAAE,CAAC,CACtF,AA4CR,SAAyB,CAAS,EAC9B,GAAI,AAAc,eAAd,EAA2B,CAC3B,SAAS,cAAA,CAAe,CAAC,MAAM,EAAE,EAAsB,GAAW,IAAI,CAAC,EAAE,KAAA,CAAM,OAAA,CAAU,OACzF,SAAS,cAAA,CAAe,wBAAwB,KAAA,CAAM,OAAA,CAAU,QAChE,0BAA0B,KAA1B,GACA,MACJ,CACA,SAAS,cAAA,CAAe,CAAC,OAAO,EAAE,EAAsB,GAAW,IAAI,CAAC,EAAE,KAAA,CAAM,OAAA,CAAU,eAC1F,SAAS,cAAA,CAAe,CAAC,MAAM,EAAE,EAAsB,GAAW,IAAI,CAAC,EAAE,KAAA,CAAM,OAAA,CAAU,MAC7F,EArDwB,GAChB,EAAe,EAAW,iBAC1B,GAAM,CAAE,IAAK,CAAQ,CAAE,SAAU,CAAa,CAAE,CAAG,MAAM,EAAgB,EAAO,GAEhF,OADA,EAA0B,EAAW,EAAU,GACxC,CACX,CAAE,MAAO,EAAI,CACT,QAAQ,KAAA,CAAM,yBAA0B,GACxC,aAAa,MAAA,CAAO,GACpB,SAAS,cAAA,CAAe,CAAC,EAAE,EAAU,gBAAgB,CAAC,EAAE,KAAA,CAAM,eAAA,CAAkB,GAChF,SAAS,cAAA,CAAe,CAAC,EAAE,EAAU,OAAO,CAAC,EAAE,KAAA,CAAM,eAAA,CAAkB,GACvE,SAAS,cAAA,CAAe,CAAC,OAAO,EAAE,EAAsB,GAAW,IAAI,CAAC,EAAE,KAAA,CAAM,OAAA,CAAU,OAC1F,EAAe,EAAW,iBACtB,EAAM,IAAA,CAAO,SACb,EAAe,EAAW,+CAE1B,EAAe,EAAW,uGAE9B,SAAS,cAAA,CAAe,GAAW,KAAA,CAAQ,EAC/C,CACJ,CAEA,SAAS,EAAe,CAAS,CAAE,CAAK,EACpC,IAAM,EAAa,SAAS,cAAA,CAAe,GAAW,UAAA,CAAW,UAAjE,AACA,CAAA,EAAW,aAAA,CAAc,wBAAwB,KAAA,CAAM,OAAA,CAAU,QACjE,EAAW,aAAA,CAAc,4BAA4B,SAAA,CAAY,CACrE,CAOO,SAAS,EAAe,CAAS,CAAE,CAAK,EAC3C,IAAM,EAAW,SAAS,cAAA,CAAe,GAAW,UAAA,CAAW,UAAA,CAAW,UAA1E,CACA,IAAK,IAAI,EAAI,EAAG,EAAI,EAAS,MAAA,CAAQ,IAC7B,CAAQ,CAAC,EAAE,CAAC,SAAA,CAAU,QAAA,CAAS,GAC/B,CAAQ,CAAC,EAAE,CAAC,KAAA,CAAM,OAAA,CAAU,QAG5B,CAAQ,CAAC,EAAE,CAAC,KAAA,CAAM,OAAA,CAAU,MAGxC,CD1KA,SAAS,IACP,OAAO,IAAI,MAAM,GAAA,CAAI,OAAQ,UAAO,GAAA,CAAI,QAAS,YAAS,GAAA,CAAI,UAAW,mBAAmB,GAAA,CAAI,UAAW,WAAW,GAAA,CAAI,WAAY,mBAAa,GAAA,CAAI,cAAe,qBAAe,GAAA,CAAI,cAAe,QAC1M,CACA,SAAS,IACP,MAAO,CAAC,aAAc,gBAAiB,cAAe,mBAAoB,aAAa,AACzF,CA2BA,eAAe,IAMb,kCAAkC;AAClC,GANA,QAAQ,GAAA,CAAI,6BAA+B,IAAI,MAE/C,8CAA8C;AAC9C,qBAAqB,KAArB,GAGI,eAAe,OAAA,CAAQ,8BAA3B,CACE,sDAAsD;AACtD,GAAI,SAAS,QAAA,CAAS,QAAA,CAAS,YAAa,CAC1C,SAAS,cAAA,CAAe,cAAc,KAAA,CAAM,OAAA,CAAU,OACtD,SAAS,cAAA,CAAe,oBAAoB,KAAA,CAAM,OAAA,CAAU,QAC5D,MAAM,IACN,IAAM,EAAiB,eAAe,OAAA,CAAQ,kBAC1C,GACF,MAAM,SAAS,GAAA,GAAM,SAAA,CAAU,gBAAgB,aAAA,CAAc,sBAAsB,CAAE,YAAa,CAAE,eAAA,CAAe,CAAE,GAEvH,IAAM,EAAe,KAAK,OAAA,EAAS,aAAa,OAChD,OAAO,SAAS,IAAA,CAAO,EAAe,qBAAuB,eAC/D,CAEE,eAAe,UAAA,CAAW,6B,CAI9B,kEAAkE;AAClE,IAAM,EAAQ,MAAM,SAAS,SAAS,OAAA,CAAQ,GAA9C,EACA,EAAiB,EAAM,IAAvB,AACF,CAEA,eAAe,QApDT,EACA,EACA,EACA,EACA,EACA,EAgDJ,aAAa,UAAA,CAAW,qBACxB,eAAe,UAAA,CAAW,iBAtDtB,EAAmB,SAAS,cAAA,CAAe,cAC3C,EAAsB,SAAS,cAAA,CAAe,iBAC9C,EAAqB,SAAS,cAAA,CAAe,gBAC7C,EAAoB,SAAS,cAAA,CAAe,eAC5C,EAAyB,SAAS,cAAA,CAAe,oBACjD,EAAmB,SAAS,cAAA,CAAe,cAE/C,4CAA4C;AAC5C,EAAE,eAAe,GAAA,CAAI,UACrB,EAAiB,gBAAA,CAAiB,SAAU,EAAyB,CAAC,QAAS,CAAA,CAAI,GACnF,EAAE,kBAAkB,GAAA,CAAI,UACxB,EAAoB,gBAAA,CAAiB,SAAU,EAA4B,CAAC,QAAS,CAAA,CAAI,GACzF,EAAE,iBAAiB,GAAA,CAAI,UACvB,EAAmB,gBAAA,CAAiB,SAAU,EAA2B,CAAC,QAAS,CAAA,CAAI,GACvF,EAAE,gBAAgB,GAAA,CAAI,UACtB,EAAkB,gBAAA,CAAiB,SAAU,EAA0B,CAAC,QAAS,CAAA,CAAI,GACrF,EAAE,gBAAgB,GAAA,CAAI,UACtB,EAAuB,gBAAA,CAAiB,SAAU,EAA+B,CAAC,QAAS,CAAA,CAAI,GAC/F,EAAE,eAAe,GAAA,CAAI,UACrB,EAAiB,gBAAA,CAAiB,SAAU,EAAyB,CAAC,QAAS,CAAA,CAAI,GAuCnF,iCACA,AA8jBF,WACE,IAAM,EAAY,SAAS,cAAA,CAAe,YAC1C,CAAA,EAAU,QAAA,CAAW,WAEf,AAAU,KADF,IAAI,CAAC,KAAjB,CAEE,EAAU,KAAA,CAAM,KAAA,CAAQ,OAExB,EAAU,KAAA,CAAM,KAAA,CAAQ,SAE5B,CACA,mEAAkE;AAClE,IAAM,EAAU,SAAS,cAAA,CAAe,UACxC,CAAA,EAAQ,QAAA,CAAW,WAEb,AAAU,KADF,IAAI,CAAC,KAAjB,CAEE,EAAQ,KAAA,CAAM,KAAA,CAAQ,OAEtB,EAAQ,KAAA,CAAM,KAAA,CAAQ,SAE1B,CACF,IAhSE,UAAU,gBAAA,CAAiB,QAAS,EAAiB,mBACrD,UAAU,gBAAA,CAAiB,QAAS,GACpC,UAAU,gBAAA,CAAiB,QAAS,EAAiB,mBACrD,SAAS,gBAAA,CAAiB,QAAS,EAAiB,kBACpD,SAAS,gBAAA,CAAiB,QAAS,GACnC,aAAa,gBAAA,CAAiB,QAAS,EAAiB,sBACxD,aAAa,gBAAA,CAAiB,QAAS,GACvC,kBAAkB,gBAAA,CAAiB,QAAS,EAAiB,2BAC7D,QAAQ,gBAAA,CAAiB,QAAS,EAAiB,iBACnD,cAAc,gBAAA,CAAiB,QAAS,EAAiB,uBACzD,UAAU,gBAAA,CAAiB,SAAU,EAAiB,mBACtD,UAAU,gBAAA,CAAiB,QAAS,GACpC,gBAAgB,gBAAA,CAAiB,QAAS,EAAiB,qBAE3D,SAAS,cAAA,CAAe,iBAAiB,gBAAA,CAAiB,QAAS,KACjE,SAAS,cAAA,CAAe,oBAAoB,cAA5C,GACA,IAAM,EAAkB,SAAS,cAAA,CAAe,oBAAoB,gBAAA,CAAiB,YAC/E,EAAU,GAAiB,CAAC,EAAE,CAChC,GAAW,EAAQ,qBAAA,GAAwB,MAAA,EAAU,GACvD,CAAA,EAAQ,KAAA,CAAM,OAAA,CAAU,+CAD1B,EAGA,WAAW,KACT,GAAI,EAAgB,MAAA,CAAS,EAAG,CAC9B,GAAI,CAAC,AAab,SAA0B,CAAE,EACJ,YAAlB,OAAO,QAAyB,aAAc,QAChD,CAAA,EAAK,CAAE,CAAC,EAAE,AAAF,EAEV,IAAM,EAAO,EAAG,qBAAhB,GACA,OACI,EAAK,GAAA,EAAO,GACZ,EAAK,IAAA,EAAQ,GACb,EAAK,MAAA,EAAW,CAAA,OAAO,WAAA,CAAY,GAAK,SAAS,eAAA,CAAgB,YAAW,AAAX,GACjE,EAAK,KAAA,EAAU,CAAA,OAAO,UAAA,EAAc,SAAS,eAAA,CAAgB,WAAU,AAAV,CAEnE,EAxB6B,GAAU,CAC7B,IAAM,EAAI,EAAQ,qBAAA,GAAwB,GAAA,CAAM,OAAO,OAAA,CAAU,GACjE,OAAO,QAAA,CAAS,CAAE,IAAK,EAAG,SAAU,QAAQ,EAC9C,CACA,SAAS,cAAA,CAAe,oBAAoB,cAA5C,EACF,CACF,EAAG,IACL,GACA,YAAY,gBAAA,CAAiB,SAAU,GACvC,gBAAgB,gBAAA,CAAiB,SAAU,gBAhV3C,aAAa,SAAS,cAAA,CAAe,aAAc,OAEnD,6DAA4D;AAC5D,IAAI,EAAQ,SAAS,cAAA,CAAe,aA4CpC,GA3CoB,SAAS,cAAA,CAAe,iBAG5C,EAAM,OAAA,CAAU,WACd,aAAa,KAAA,CAAM,OAAA,CAAU,OAExB,AAshBT,SAAoB,CAAK,EACvB,GAAI,MAAM,IAAA,CAAK,AAAA,GAAS,EAAM,WAAA,GAAc,QAAA,CAAS,EAAM,WAAA,KAGzD,OAFA,eAAe,SAAA,CAAY,CAAC,0BAAuB,EAAE,EAAM,6EAAiE,CAAC,CAC7H,cAAc,KAAA,CAAM,OAAA,CAAU,OAG9B,CAAA,cAAc,KAAA,CAAM,OAAA,CAAU,MAElC,EA/hBgB,IAAI,CAAC,KAAjB,CAKF,EAEA,qCAAqC;AACrC,cAAc,QAAA,CAAW,WACvB,IAAI,EAAQ,IAAI,CAAC,KAAjB,AACI,AAAS,CAAA,mCAAT,GACF,cAAc,KAAA,CAAM,OAAA,CAAU,QAC9B,cAAc,KAAA,CAAM,KAAA,CAAQ,QACnB,AAAS,IAAT,GACT,cAAc,KAAA,CAAM,OAAA,CAAU,OAC9B,cAAc,KAAA,CAAM,KAAA,CAAQ,YAE5B,cAAc,KAAA,CAAM,OAAA,CAAU,OAC9B,cAAc,KAAA,CAAM,KAAA,CAAQ,OAEhC,EAEA,WAAW,gBAAA,CAAiB,QAAS,KACnC,IAAM,EAAQ,kBAAkB,WAAW,KAAA,EAAS,GAAK,wBACzD,WAAW,iBAAA,CAAkB,EAC/B,GAEA,MAAM,IACN,MAAM,IACN,MAAM,IACN,MAAM,IACN,MAAM,IACN,AAkyBF,WACE,IAAM,EAAW,IAAI,iBAAiB,CAAC,EAAe,KACpD,IAAM,EAAiB,EAAc,IAAA,CAAK,AAAA,GAAO,AAAsB,UAAtB,EAAI,aAAA,EACjD,GAAkB,AAAwC,SAAxC,EAAe,MAAA,CAAO,KAAA,CAAM,OAAA,EAChD,GAEJ,GACA,MAAM,IAAA,CAAK,SAAS,gBAAA,CAAiB,qBAAqB,OAAA,CAAQ,AAAA,GAChE,EAAS,OAAA,CAAQ,EAAK,CAAE,WAAY,CAAA,CAAI,GAE5C,IA3yBE,AAuuBF,WACE,SAAS,EAAwB,CAAK,EACpC,IAAI,EAAQ,EAAM,MAAlB,CACA,GAAI,aAAiB,QAAS,CAC5B,IAAM,EAAe,GAAkB,CAAC,EAAM,IAAA,CAAK,CAC/C,IAAiB,EAAM,KAAA,EAAS,AAAgB,KAAhB,EAAM,KAAA,EACxC,CAAA,SAAS,cAAA,CAAe,iBAAiB,KAAA,CAAM,OAAA,CAAU,OAD3D,CAGF,CACF,CACA,SAAS,cAAA,CAAe,oBAAoB,gBAAA,CAAiB,QAAS,GACtE,SAAS,aAAA,CAAc,4BAA4B,gBAAA,CAAiB,SAAU,EAChF,IAsHE,IAAgB,OAAA,CAAQ,AAAA,IACtB,SAAS,cAAA,CAAe,CAAC,MAAM,EAAE,AAAA,EAAsB,GAAW,IAAI,CAAC,EAAE,gBAAA,CAAiB,QAAS,KACjG,EAAiB,EACnB,EACF,GACA,SAAS,cAAA,CAAe,wBAAwB,gBAAA,CAAiB,QAAS,KACxE,SAAS,cAAA,CAAe,cAAc,QAAA,CAAW,CAAA,EACjD,EAAiB,qBACnB,GACA,SAAS,cAAA,CAAe,2BAA2B,gBAAA,CAAiB,QAAS,KAC3E,SAAS,cAAA,CAAe,iBAAiB,QAAA,CAAW,CAAA,CACtD,GAj3BA,SAAS,cAAA,CAAe,iBAAiB,gBAAA,CAAiB,QAAS,GAE/D,OAAO,EAAA,CACT,iEAAiE;AACjE,eAAe,UAAA,CAAW,aAC1B,aAAa,UAAA,CAAW,WACxB,KAAK,kBAAA,CAAmB,SAAU,CAAI,EAC/B,GAAQ,CAAA,SAAS,cAAA,CAAe,YAAY,KAAA,CAAM,OAAA,CAAU,OAAjE,CACF,GACA,SAAS,cAAA,CAAe,eAAe,KAAA,CAAM,OAAA,CAAU,QACvD,MAAM,EAAS,OAAO,EAAtB,EACA,SAAS,cAAA,CAAe,8BAA8B,KAAtD,QACK,GAAI,eAAe,OAAA,CAAQ,+BAAiC,SAAS,QAAA,CAAS,QAAA,CAAS,kBAEvF,GAAI,aAAa,OAAA,CAAQ,YAAc,CAAC,EAAmB,KAAK,KAAA,CAAM,aAAa,OAAA,CAAQ,aAAc,CAC9G,qEAAqE;AACrE,IAAM,EAAU,KAAK,KAAA,CAAM,aAAa,OAAA,CAAQ,WAChD,CAAA,SAAS,cAAA,CAAe,cAAc,QAAA,CAAW,CAAA,EACjD,SAAS,cAAA,CAAe,iBAAiB,QAAA,CAAW,CAAA,EACpD,MAAM,EAAS,KAAM,EAAS,CAAA,GAC9B,SAAS,cAAA,CAAe,iBAAiB,KAAA,CAAM,OAAA,CAAU,QACzD,SAAS,cAAA,CAAe,8BAA8B,KAAtD,EACF,MACE,SAAS,cAAA,CAAe,8BAA8B,KAAtD,GACA,SAAS,cAAA,CAAe,cAAc,QAAA,CAAW,CAAA,EACjD,SAAS,cAAA,CAAe,iBAAiB,QAAA,CAAW,CAAA,EA0tBtD,4FAA4F;AAC5F,SAAS,cAAA,CAAe,oBAAoB,gBAAA,CAAiB,SAAS,OAAA,CAAQ,AAAA,IAC5E,EAAI,gBAAA,CAAiB,QAAS,EAChC,GACA,SAAS,cAAA,CAAe,oBAAoB,gBAAA,CAAiB,uBAAuB,OAAA,CAAQ,AAAA,IAC1F,EAAI,gBAAA,CAAiB,SAAU,EACjC,GACA,SAAS,cAAA,CAAe,oBAAoB,gBAAA,CAAiB,0BAA0B,OAAA,CAAQ,AAAA,IAC7F,EAAI,gBAAA,CAAiB,SAAU,EACjC,GACA,4FAA4F;AAC5F,SAAS,cAAA,CAAe,oBAAoB,gBAAA,CAAiB,UAAU,OAAA,CAAQ,AAAA,IAC7E,EAAI,gBAAA,CAAiB,SAAU,EACjC,GACA,SAAS,cAAA,CAAe,oBAAoB,gBAAA,CAAiB,YAAY,OAAA,CAAQ,AAAA,IAC/E,EAAI,gBAAA,CAAiB,QAAS,EAChC,GAIA,OAAO,gBAAA,CAAiB,WAAY,AAAC,IAC/B,EAAM,SAAA,EAAa,aAAa,OAAA,CAAQ,YAE1C,WAAW,UACP,MAAM,EAAS,KAAM,KAAK,KAAA,CAAM,aAAa,OAAA,CAAQ,YAAa,CAAA,EACpE,EACA,GAEN,EAlvBF,CAEA,eAAe,EAAQ,CAAK,EAC1B,IAAM,EAAK,eAAe,OAAA,CAAQ,cAAgB,MAAM,AAAA,IACxD,GAAI,CACF,SAAS,cAAA,CAAe,kBAAkB,KAAA,CAAM,OAAA,CAAU,OAC1D,SAAS,cAAA,CAAe,cAAc,KAAA,CAAM,OAAA,CAAU,OACtD,SAAS,cAAA,CAAe,iBAAiB,KAAA,CAAM,OAAA,CAAU,OACzD,IAAM,EAAO,MAAM,EAAa,GAC1B,EAAW,MAAM,EAAsB,EAAI,EAAK,WAAA,CAAY,qBAAlE,CAEuB,CAAA,IAAnB,GACF,UAAU,KAAA,CAAM,kBAElB,SAAS,IAAA,CAAO,CAClB,CAAE,MAAO,EAAG,CACV,aAAa,MAAA,CAAO,GACpB,QAAQ,KAAA,CAAM,iBAAkB,EAClC,CACF,CAEA,SAAS,EAAgB,CAAA,iBAAE,CAAgB,CAAA,aAAE,CAAY,CAAE,EACzD,OAAO,GAAoB,EAAa,KAAA,CAAM,6BAChD,CAEA,eAAe,EAAkB,CAAM,CAAE,CAAe,CAAE,CAAqB,EAC7E,GAAM,CAAA,SAAE,CAAQ,CAAA,SAAE,CAAQ,CAAA,QAAE,CAAO,CAAA,iBAAE,CAAgB,CAAA,sBAAE,CAAqB,CAAA,YAAE,CAAW,CAAA,UAAE,CAAS,CAAA,QAAE,CAAO,CAAA,oBAC3G,CAAmB,CAAA,oBAAE,CAAmB,CAAA,aAAE,CAAY,CAAA,kBAAE,CAAiB,CAAA,SAAE,CAAQ,CAAA,iBAAE,CAAgB,CAAE,CAAG,GAAmB,CAAC,EAChI,GAAI,CAAC,GAAY,CAAC,EAChB,OAEF,IAAM,EAAgB,CACpB,YAAa,CACX,QAAA,EAAS,iBAAA,EAAkB,iBAAkB,EAAU,iBAAkB,EACzE,sBAAuB,EACvB,sBAAuB,EACvB,kBAAmB,EACnB,aAAc,GAAS,WACvB,oBAAA,EAAqB,oBAAA,EAAqB,aAAA,EAAc,kBAAA,EAAmB,SAAA,EAAU,iBAAA,CACvF,EACA,GAAI,GAAW,EAAgB,GAAmB,CAAC,EAAI,CACrD,gBAAiB,YACjB,cAAe,IAAI,OAAO,WAA1B,GACA,GAAI,EAAwB,CAAC,EAAI,CAAE,iBAAkB,EAAU,iBAAkB,CAAS,CAAC,CAC3F,aAAc,CACZ,MAAO,CACL,OAAQ,EAAwB,SAAW,WAC3C,SAAU,EAAwB,GAAK,WACvC,YAAa,sLACb,SAAU,GAAuB,EACjC,SAAU,GAAuB,CACnC,CACF,CACF,CAAC,AACH,EACA,GAAI,eAAe,OAAA,CAAQ,8BAA+B,CACxD,IAAM,EAAO,KAAK,KAAA,CAAM,eAAe,OAAA,CAAQ,+BAC/C,eAAe,OAAA,CAAQ,6BAA8B,KAAK,SAAA,CAAU,CAClE,GAAI,EAAK,EAAT,CACA,KAAM,CAAE,GAAG,EAAK,IAAI,CAAE,GAAG,CAAa,AAAC,CACzC,GACF,KAAO,CACL,MAAM,SAAS,GAAA,GAAM,SAAA,CAAU,gBAAgB,aAAA,CAAc,2BAA2B,CAAE,OAAA,EAAQ,GAAG,CAAa,AAAC,GACnH,IAAM,EAAoB,KAAK,KAAA,CAAM,aAAa,OAAA,CAAQ,sBAC1D,aAAa,OAAA,CAAQ,oBAAqB,KAAK,SAAA,CAAU,CAAE,GAAG,CAAiB,CAAE,GAAG,CAAa,AAAC,GACpG,CACF,CAEA,eAAe,EAAsB,CAAM,CAAE,CAAqB,EAChE,IAAM,EAAO,KAAK,KAAA,CAAM,eAAe,OAAA,CAAQ,+BAAiC,MAAM,IAAtF,CACA,GAAI,CAAC,GAAU,CAAC,EAEd,OADA,QAAQ,KAAA,CAAM,uCACP,qBAET,GAAI,CACF,IAAM,EAAM,MAAM,SAAS,GAAA,GAAM,SAAA,CAAU,gBAAgB,aAAA,CAAc,mBAAmB,CAAC,OAAA,EAAQ,KAAA,CAAI,GACnG,CAAA,SAAE,CAAQ,CAAA,SAAE,CAAQ,CAAA,QAAE,CAAO,CAAE,CAAG,EAAI,IAAA,EAAQ,CAAC,EAErD,OADA,MAAM,EAAkB,EAAQ,EAAI,IAAA,CAAM,GACnC,EAAyB,GAAY,EAAU,EAAS,EAAgB,EAAI,IAAA,EAAO,EAC5F,CAAE,MAAO,EAAG,CACV,QAAQ,KAAA,CAAM,6BAA8B,EAC9C,CACA,OAAO,GACT,CAEA,SAAS,EAAyB,CAAkB,CAAE,CAAO,CAAE,CAAsB,CAAE,CAAqB,EAC1G,GAAI,CAAC,GAAsB,GAA0B,CAAC,EAAuB,CAC3E,GAAI,eAAe,OAAA,CAAQ,8BACzB,MAAO,WAET,IAAM,EAAe,KAAK,OAAA,EAAS,aAAa,OAChD,OAAO,EAAe,qBAAuB,eAC/C,CACA,MAAO,iBACT,CAEA,SAAS,IACP,MAAO,CACL,YAAa,KACb,IAAK,KACL,MAAO,KACP,SAAU,KACV,MAAO,KACP,UAAW,KACX,kBAAmB,KACnB,QAAS,EAAE,CACX,OAAQ,CAAC,EACT,SAAU,KACV,MAAO,KACP,cAAe,KACf,sBAAuB,CAAA,EACvB,IAAK,QACL,KAAM,KACN,YAAa,IACf,CACF,CAEA,SAAS,IACP,IAAI,EAAM,GACJ,EAAM,IAAI,KAGV,EAAO,SAAS,KAAtB,CACM,EAAW,aAAa,KAAA,CAAQ,aAAa,KAAA,CAAM,IAAA,GAAS,GAC5D,EAAQ,UAAU,KAAA,CAAQ,UAAU,KAAA,CAAM,IAAA,GAAS,GACnD,EAAQ,UAAU,KAAA,CAAQ,UAAU,KAAA,CAAM,IAAA,GAAS,GACnD,EAAgB,OAAO,kBAAkB,KAA/C,EACM,EAAM,QAAQ,KAApB,CACM,EAAY,cAAc,KAAhC,CACM,EAAoB,sBAAsB,KAAA,CAAQ,sBAAsB,KAAA,CAAM,IAAA,GAAS,GACvF,EAAc,gBAAgB,KAAA,CAAQ,gBAAgB,KAAA,CAAM,IAAA,GAAS,GACrE,EAAc,OAAO,sBAAsB,KAAjD,EACM,EAAwB,0BAA0B,OAAxD,CAGI,EAAiB,IAAI,MAAM,GAAA,CAAI,OAAQ,KAAK,OAAA,EAAS,GAAA,CAAI,QAAS,MAAM,OAAA,EAAS,GAAA,CAAI,UAAW,QAAQ,OAAA,EAAS,GAAA,CAAI,UAAW,QAAQ,OAAA,EAAS,GAAA,CAAI,WAAY,SAAS,OAAA,EAAS,GAAA,CAAI,cAAe,YAAY,OAAA,EAAS,GAAA,CAAI,cAAe,YAAY,OAA9P,EACI,EAAU,EAAE,AACE,CAAA,oCAAd,GACF,EAAe,OAAA,CAAQ,CAAC,EAAO,KAC7B,GAAI,EAAO,CACT,IAAI,EAAS,IAA0B,GAAA,CAAI,GAC3C,EAAQ,IAAA,CAAK,EACf,CACF,GAMF,IAAK,IADD,EAAkB,SAAS,iBAAA,CAAkB,OACxC,EAAI,EAAG,EAAI,EAAgB,MAAA,CAAQ,IACtC,CAAe,CAAC,EAAE,CAAC,OAAA,EACrB,CAAA,EAAM,CAAe,CAAC,EAAE,CAAC,EAF7B,AAAA,EAMA,IAAM,EAAiB,SAAS,cAAA,CAAe,sBAC3C,EAAqB,CAAC,EAC1B,GAAI,AAAiC,SAAjC,EAAe,KAAA,CAAM,OAAA,CAAoB,CAC3C,wEAAwE;AACxE,IAAM,EAAY,KAAK,KAAA,CAAM,EAAe,YAAA,CAAa,eACzD,EAAqB,CACnB,mBAAoB,EAAU,UAAa,CAC3C,iBAAkB,EAAU,WAAc,AAC5C,CACF,CAEA,IAAM,EAAS,KAAK,KAAA,CAAM,aAAa,OAAA,CAAQ,YAAc,MAAM,MAAnE,CAEA,MAAO,CACL,KAAM,SAAS,OAAA,EAAS,KAAO,KAC/B,UAAW,EAAI,WAAf,GACA,OAnDW,MAoDX,eAnDmB,WAoDnB,IAAA,EACA,KAAA,EACA,SAAA,EACA,MAAO,UAAU,KAAjB,CACA,SAAU,aAAa,KAAvB,CACA,MAAA,EACA,MAAA,EACA,cAAA,EACA,IAAA,EACA,UAAA,EACA,QAAA,EACA,kBAAA,EACA,YAAA,EACA,YAAA,EACA,YAAa,CAAE,sBAAA,CAAsB,EACrC,GAAG,CAAkB,CACrB,OAAA,CACF,CACF,CAEA,eAAe,IACb,2EAA2E;AAC3E,IAAI,EAAiB,gBAUrB,OATK,KAAK,OAAA,EAAS,aAAa,eAO9B,EAAiB,KAAK,OAAA,EAAS,aAAa,eANxC,SAAS,OAAA,CACX,MAAM,SAAS,GAAA,GAAM,SAAA,CAAU,gBAAgB,aAAA,CAAc,sBAAsB,CAAE,YAAa,CAAE,eAAA,CAAe,CAAE,GAErH,eAAe,OAAA,CAAQ,iBAAkB,GAKtC,CACT,CAEA,eAAe,EAAa,CAAE,EAC5B,GAAM,CAAA,mBAAE,CAAkB,CAAA,OAAE,CAAM,CAAE,GAAG,EAAU,CAAG,IAC9C,EAAiB,MAAM,IACzB,IACF,EAAO,UAAa,CAAG,EACvB,EAAS,mBAAsB,CAAG,IAAI,OAAO,WAA7C,IAEF,IAAM,EAAkB,OAAO,EAAA,CAAK,CAAE,gBAAiB,OAAO,EAAxB,AAA2B,EAAI,CAAC,EAChE,EAAO,CAAE,GAAG,CAAQ,CAAE,eAAA,EAAgB,OAAA,EAAQ,GAAG,CAAe,CAAE,QAAS,GAAI,EAErF,GAAK,SAAS,OAAA,CAEP,CACL,IAAM,EAAqB,MAAM,SAAS,GAAA,GAAM,SAAA,CAAU,gBAAgB,aAAA,CAAc,cAAc,CAAE,GAAA,EAAI,KAAA,CAAK,GACjH,aAAa,UAAA,CAAW,WACxB,eAAe,UAAA,CAAW,aAC1B,aAAa,OAAA,CAAQ,oBAAqB,KAAK,SAAA,CAAU,EAAmB,IAA5E,EACF,MANE,eAAe,OAAA,CAAQ,6BAA8B,KAAK,SAAA,CAAU,CAAE,GAAA,EAAI,KAAA,CAAK,IAOjF,OAAO,CACT,CAoDA,eAAe,IACb,IAAM,EAAkB,KAAK,KAAA,CAAM,eAAe,OAAA,CAAQ,+BAC1D,eAAe,UAAA,CAAW,8BAC1B,eAAe,UAAA,CAAW,aAC1B,MAAM,SAAS,GAAA,GAAM,SAAA,CAAU,gBAAgB,aAAA,CAAc,cAAc,GAC3E,aAAa,UAAA,CAAW,WACxB,EAAgB,IAAA,CAAK,EAAA,CAAK,EAAgB,EAA1C,CACA,aAAa,OAAA,CAAQ,oBAAqB,KAAK,SAAA,CAAU,EAAgB,IAAzE,EACF,CAEA,SAAS,IACP,GAAI,aAAa,OAAA,CAAQ,qBACvB,OAEF,GAAM,CACJ,KAAA,CAAI,CAAA,UAAE,CAAS,CAAA,OAAE,CAAM,CAAA,eAAE,CAAc,CAAA,mBAAE,CAAkB,CAAE,GAAG,EACjE,CAAG,IAEE,EAAO,OAAO,IAAA,CAAK,GAAY,MAAA,CAAO,CAAC,EAAK,KAChD,CAAG,CAAC,EAAI,CAAG,AAAoB,KAApB,CAAU,CAAC,EAAI,CAAU,KAAO,CAAU,CAAC,EAAI,CACnD,GACN,CAAC,EACJ,CAAA,EAAK,OAAA,CAAU,EAAK,OAAA,CAAU,EAAK,OAAA,CAAU,EAAE,CAC/C,EAAK,qBAAA,CAAwB,EAAK,WAAA,CAAY,qBAA9C,CACA,OAAO,EAAK,WAAZ,CACA,EAAK,WAAA,CAAc,EAAK,WAAA,EAAe,EAAK,WAAA,CAAc,EAAI,EAAK,WAAA,CAAc,KACjF,EAAK,aAAA,CAAgB,EAAK,aAAA,EAAiB,EAAK,aAAA,CAAgB,EAAI,EAAK,aAAA,CAAgB,KACzF,CAAE,YAAa,WAAY,eAAgB,YAAa,CAAC,OAAA,CAAQ,AAAA,IAC/D,IAAM,EAAiB,SAAS,cAAA,CAAe,GAAW,UAAA,CAAW,aAAA,CAAc,qBACjF,SAAS,cAAA,CAAe,GAAW,UAAA,CAAW,UAAA,CAAW,aAAA,CAAc,oBACrE,GAAgB,OAAO,UAAY,SACrC,CAAA,CAAI,CAAC,CAAC,EAAE,EAAU,OAAO,CAAC,CAAC,CAAG,CAAA,CADhC,CAGF,GACK,EAAmB,GAGtB,aAAa,UAAA,CAAW,WAFxB,aAAa,OAAA,CAAQ,UAAW,KAAK,SAAA,CAAU,GAInD,CAEA,SAAS,EAAmB,CAAS,EACnC,IAAM,EAAe,IACrB,IAAK,IAAM,KAAS,EAClB,GAAM,KAAS,GAGf,GAAI,CAAY,CAAC,EAAM,WAAY,OAAQ,CACzC,GAAI,KAAK,SAAA,CAAU,CAAY,CAAC,EAAM,IAAM,KAAK,SAAA,CAAU,CAAS,CAAC,EAAM,EACzE,MAAO,CAAA,EAET,QACF,CACA,GAAI,CAAS,CAAC,EAAM,GAAK,CAAY,CAAC,EAAM,CAC1C,MAAO,CAAA,EAGX,MAAO,CAAA,CACT,CAEA,SAAS,EAAiB,CAAO,EAC/B,OAAO,AAAC,IACN,SAAS,cAAA,CAAe,GAAS,KAAA,CAAM,OAAA,CAAU,EAAM,MAAA,CAAO,KAAA,CAAM,MAAA,CAAS,EAAI,eAAiB,MACpG,CACF,CAEA,SAAS,EAAmB,CAAS,CAAE,CAAiB,CAAE,CAAgB,EACxE,GAAI,GAAqB,EAAkB,CACzC,IAAM,EAAiB,SAAS,cAAA,CAAe,GAAW,UAAA,CAAW,aAAA,CAAc,qBACjF,SAAS,cAAA,CAAe,GAAW,UAAA,CAAW,UAAA,CAAW,aAAA,CAAc,mBACzE,CAAA,EAAe,KAAA,CAAM,OAAA,CAAU,QAC/B,SAAS,cAAA,CAAe,GAAW,iBAAA,CAAkB,uCACvD,CACF,CAEA,eAAe,EAAS,CAAM,CAAE,EAAY,IAAI,CAAE,EAAoB,CAAA,CAAK,EACzE,GAAI,CACF,IAAI,EAAO,CAAE,KAAM,CAAU,EACxB,GACH,CAAA,EAAO,MAAM,SAAS,GAAA,GAAM,SAAA,CAAU,gBAAgB,aAAA,CAAc,WAAW,CAAE,OAAA,CAAO,EAAA,EAE1F,IAAM,EAAO,EAAK,IAAlB,CACM,EAAS,EAAK,MAAA,EAAU,CAAC,EAC3B,EAAgB,EAAK,aAAzB,CAKA,kBAAkB;AAClB,IAAK,IAAM,KALP,GAAiB,GACnB,CAAA,EAAgB,IADlB,EAKwB,EAAQ,CAC9B,IAAI,EAAW,CAAM,CAAC,CAAC,EAAE,EAAU,KAAK,CAAC,CAAC,EAAI,CAAM,CAAC,CAAC,EAAE,EAAU,MAAM,CAAC,CAAC,EAAI,CAAM,CAAC,EAAU,EAAI,CAAM,CAAC,CAAC,EAAE,EAAU,KAAK,CAAC,CAAC,CAC1H,EAAW,CAAM,CAAC,EAAU,EAAI,CAAM,CAAC,CAAC,EAAE,EAAU,KAAK,CAAC,CAAC,EAAI,CAAM,CAAC,CAAC,EAAE,EAAU,MAAM,CAAC,CAAC,EAAI,CAAM,CAAC,CAAC,EAAE,EAAU,KAAK,CAAC,CAAC,CAC1H,IAAgB,QAAA,CAAS,KAC3B,AAAA,EAA0B,EAAW,EAAU,GAC7B,eAAd,GAA8B,EAAO,kBAAA,GACvC,EAAW,EAAO,uBAA0B,EAAI,EAAO,wBAA2B,EAAI,EAAO,kBAAqB,EAAI,EAAO,uBAA0B,CACvJ,EAAW,EAAO,kBAAqB,EAAI,EAAO,uBAA0B,EAAI,EAAO,wBAA2B,EAAI,EAAO,uBAA0B,CACvJ,AAAA,EAA0B,qBAAsB,EAAU,IAE5D,AAAA,EAAiB,EAAW,GAC5B,AAAA,EAAe,EAAW,iBAC1B,SAAS,cAAA,CAAe,GAAW,QAAA,CAAW,CAAA,EAElD,CAEA,oFAAoF;AACpF,eAAe,UAAA,CAAW,wBAC1B,IAAM,EAAkB,EAAO,eAAA,EAAmB,EAAO,UAAA,EAAc,KACjE,EAAkB,EAAO,UAAA,EAAc,EAAO,eAAA,EAAmB,KACnE,GAAmB,CAAE,MAAM,EAAY,KACzC,SAAS,cAAA,CAAe,uBAAuB,KAAA,CAAM,eAAA,CAAkB,CAAC,KAAK,EAAE,EAAgB,EAAE,CAAC,CAClG,SAAS,cAAA,CAAe,qBAAqB,KAAA,CAAM,OAAA,CAAU,QAC7D,AAAA,EAA0B,aAAc,EAAiB,IAG3D,6BAA6B;AAC7B,UAAU,KAAA,CAAQ,EAAK,KAAA,EAAS,GAChC,EAAmB,YAAa,EAAmB,EAAK,gBAAxD,EACA,mFAAmF;AACnF,SAAS,cAAA,CAAe,kBAAkB,KAAA,CAAM,OAAA,CAAU,EAAK,KAAA,CAAQ,eAAiB,OACxF,cAAc,WAAY,EAAK,IAA/B,EACA,EAAmB,WAAY,EAAmB,EAAK,eAAvD,EACA,cAAc,eAAgB,EAAK,QAAnC,EACA,EAAmB,eAAgB,EAAmB,EAAK,mBAA3D,EACA,cAAc,YAAa,EAAK,KAAhC,EACA,cAAc,oBAAqB,GAE/B,IACF,cAAc,kBAAmB,EAAK,WAAtC,EACA,cAAc,wBAAyB,EAAK,iBAA5C,EACA,cAAc,wBAAyB,EAAK,WAAA,EAAe,EAAI,KAAO,EAAK,WAA3E,GAGF,yBAAyB;AACzB,EAAiB,QAAS,EAAK,GAA/B,EACA,EAAiB,UAAW,EAAK,KAAjC,EACA,EAAmB,YAAa,EAAmB,EAAK,gBAAxD,EACA,EAAiB,cAAe,EAAK,SAArC,EACI,cAAc,aAAA,EAAiB,GAAK,AAA4D,oCAA5D,cAAc,OAAO,CAAC,cAAc,aAAA,CAAc,CAAC,IAAA,EACzF,CAAA,cAAc,KAAA,CAAM,OAAA,CAAU,OADhC,EAGA,IAAM,EAAe,EAAE,iBACvB,EAAa,GAAA,CAAI,EAAK,QAAtB,EACA,EAAa,OAAA,CAAQ,UAGjB,EAAK,GAAA,EACP,SAAS,cAAA,CAAe,SAAS,sBAAA,CAAuB,SAAA,CAAU,MAAA,CAAO,yBACzE,SAAS,cAAA,CAAe,SAAS,OAAA,CAAU,CAAA,EAC3C,SAAS,cAAA,CAAe,EAAK,GAAA,EAAK,sBAAA,CAAuB,SAAA,CAAU,GAAA,CAAI,yBACvE,SAAS,cAAA,CAAe,EAAK,GAAA,EAAK,OAAA,CAAU,CAAA,IAE5C,SAAS,cAAA,CAAe,SAAS,sBAAA,CAAuB,SAAA,CAAU,GAAA,CAAI,yBACtE,SAAS,cAAA,CAAe,SAAS,OAAA,CAAU,CAAA,GAG7C,sBAAsB;AACtB,IAA0B,OAAA,CAAQ,CAAC,EAAO,KACpC,EAAK,OAAA,EAAW,EAAK,OAAA,CAAQ,QAAA,CAAS,KACxC,SAAS,cAAA,CAAe,GAAK,sBAAA,CAAuB,SAAA,CAAU,GAAA,CAAI,yBAClE,SAAS,cAAA,CAAe,GAAK,OAAA,CAAU,CAAA,EAE3C,GACI,GACE,0BAA2B,GAAQ,CAAC,EAAK,qBAAA,GAC3C,SAAS,cAAA,CAAe,6BAA6B,KAArD,GACA,SAAS,cAAA,CAAe,6BAA6B,sBAAA,CAAuB,SAAA,CAAU,MAAA,CAAO,yBAGnG,CAAE,MAAO,EAAO,CACd,QAAQ,KAAA,CAAM,+BAAgC,GAC9C,aAAa,MAAA,CAAO,EACtB,CACA,SAAS,cAAA,CAAe,cAAc,KAAA,CAAM,OAAA,CAAU,MACxD,CAEA,SAAS,EAAiB,CAAK,CAAE,CAAK,EACpC,IAAM,EAAc,MAAM,IAAA,CAAK,EAAM,OAAA,EAClC,GAAA,CAAI,AAAA,GAAO,EAAI,UAAA,CAAW,KAAA,CAAM,KAAA,EAChC,OAAA,CAAQ,EACP,CAAA,EAAc,GAChB,EAAM,aAAA,CAAgB,EACtB,EAAM,KAAA,CAAM,KAAA,CAAQ,SAEpB,EAAM,aAAA,CAAgB,EACtB,EAAM,KAAA,CAAM,KAAA,CAAQ,WAEtB,EAAM,aAAA,CAAc,IAAI,MAAM,UAC9B,EAAM,aAAA,CAAc,IAAI,MAAM,UAChC,CAoDA,IAAM,EAAkB,CACtB,MAAS,QACT,MAAS,QACT,KAAQ,OACR,KAAQ,OACR,UAAa,OACb,sBAAuB,cACvB,IAAO,MACP,KAAQ,OACR,MAAS,QACT,MAAS,QACT,WAAc,OACd,MAAS,QACT,OAAU,SACV,OAAU,SACV,OAAU,WACV,KAAQ,OACR,OAAU,SACV,OAAU,SACV,KAAQ,YACR,MAAS,QACT,KAAQ,YACR,QAAW,OACX,QAAW,QACb,EAEA,eAAe,EAAwB,CAAK,EAC1C,IAAI,EAAQ,IAAI,CAAC,KAAK,CAAC,EAAE,CACzB,GAAI,EAAO,CACT,EAAM,eAAN,GACA,IAAM,EAAW,MAAM,AAAA,EAA0B,EAAO,cACxD,GAAI,CAAC,GAAY,AAAiC,IAAjC,OAAO,IAAA,CAAK,GAAU,MAAA,CACrC,OAEF,IAAM,EAAW,EAAE,CACnB,EAAS,IAAA,CAAK,EAAmB,GAAW,EAAqC,GAAW,AAAA,EAAkB,IAC9G,MAAM,QAAQ,GAAA,CAAI,GAClB,GACF,CACF,CAEA,eAAe,EAA2B,CAAK,EAC7C,IAAI,EAAQ,IAAI,CAAC,KAAK,CAAC,EAAE,CACzB,GAAI,EAAO,CACT,EAAM,eAAN,GACA,IAAM,EAAW,MAAM,AAAA,EAA0B,EAAO,iBACxD,AAAA,EAAoB,iBACpB,MAAM,EAAqC,GAC3C,GACF,CACF,CAEA,eAAe,EAA0B,CAAK,EAC5C,IAAI,EAAQ,IAAI,CAAC,KAAK,CAAC,EAAE,CACzB,GAAI,EAAO,CACT,EAAM,eAAN,GACA,IAAM,EAAW,MAAM,AAAA,EAA0B,EAAO,gBACxD,AAAA,EAAoB,gBACpB,MAAM,EAAqC,GAC3C,GACF,CACF,CAEA,eAAe,EAAyB,CAAK,EAC3C,IAAI,EAAQ,IAAI,CAAC,KAAK,CAAC,EAAE,CACzB,GAAI,EAAO,CACT,EAAM,eAAN,GACA,IAAM,EAAW,MAAM,AAAA,EAA0B,EAAO,eACxD,AAAA,EAAoB,eACpB,MAAM,EAAqC,GAC3C,GACF,CACF,CAEA,eAAe,EAA8B,CAAK,EAChD,IAAI,EAAQ,IAAI,CAAC,KAAK,CAAC,EAAE,CACzB,GAAI,EAAO,CACT,EAAM,eAAN,GACA,IAAM,EAAW,MAAM,AAAA,EAA0B,EAAO,oBACxD,AAAA,EAAoB,oBACpB,MAAM,EAAqC,GAC3C,GACF,CACF,CAEA,eAAe,EAAwB,CAAK,EAC1C,IAAI,EAAQ,IAAI,CAAC,KAAK,CAAC,EAAE,CACzB,GAAI,EAAO,CACT,EAAM,eAAN,GACA,IAAM,EAAW,MAAM,AAAA,EAA0B,EAAO,cACxD,AAAA,EAAoB,cACpB,MAAM,EAAqC,GAC3C,GACF,CACF,CAEA,SAAS,EAA2B,CAAK,EACvC,EAAM,aAAA,CAAc,iBAAA,CAAkB,IACtC,IAAM,EAAiB,EAAM,aAAA,CAAc,UAAA,CAAW,aAAA,CAAc,qBAChE,EAAM,aAAA,CAAc,UAAA,CAAW,UAAA,CAAW,aAAA,CAAc,mBAC5D,CAAA,EAAe,KAAA,CAAM,OAAA,CAAU,MACjC,CAEA,eAAe,EAAqC,CAAQ,EAC1D,GAAI,CACF,GAAI,SAAS,aAAA,CAAc,cAAc,KAAA,CAAM,MAAA,EAAU,SAAS,aAAA,CAAc,iBAAiB,KAAA,CAAM,MAAA,EAClG,SAAS,aAAA,CAAc,aAAa,KAAA,CAAM,MAAA,CAE7C,OAEF,IAAM,EAAW,MAAM,SAAS,GAAA,GAAM,SAAA,CAAU,gBAAgB,aAAA,CAAc,qCAAqC,CAAE,SAAA,CAAS,EAC1H,EAAC,SAAS,aAAA,CAAc,cAAc,KAAA,CAAM,MAAA,EAAU,EAAS,IAAA,EAAM,QACvE,SAAS,aAAA,CAAc,cAAc,KAAA,CAAQ,EAAS,IAAA,CAAK,KAA3D,CACA,SAAS,aAAA,CAAc,cAAc,iBAAA,CAAkB,wCACvD,SAAS,cAAA,CAAe,kBAAkB,KAAA,CAAM,OAAA,CAAU,eAC1D,SAAS,aAAA,CAAc,wBAAwB,KAAA,CAAM,OAAA,CAAU,QAC/D,SAAS,aAAA,CAAc,cAAc,aAAA,CAAc,IAAI,MAAM,WAC7D,UAAU,KAAA,CAAM,iBAAkB,CAAE,UAAW,qBAAsB,IAEnE,CAAC,SAAS,aAAA,CAAc,iBAAiB,KAAA,CAAM,MAAA,EAAU,EAAS,IAAA,EAAM,YAC1E,SAAS,aAAA,CAAc,iBAAiB,KAAA,CAAQ,EAAS,IAAA,CAAK,SAA9D,CACA,SAAS,aAAA,CAAc,iBAAiB,iBAAA,CAAkB,yCAC1D,SAAS,cAAA,CAAe,qBAAqB,KAAA,CAAM,OAAA,CAAU,eAC7D,SAAS,aAAA,CAAc,2BAA2B,KAAA,CAAM,OAAA,CAAU,QAClE,SAAS,aAAA,CAAc,iBAAiB,aAAA,CAAc,IAAI,MAAM,WAChE,UAAU,KAAA,CAAM,iBAAkB,CAAE,UAAW,wBAAyB,IAEtE,CAAC,SAAS,aAAA,CAAc,aAAa,KAAA,CAAM,MAAA,EAAU,EAAS,IAAA,EAAM,OACtE,SAAS,aAAA,CAAc,aAAa,KAAA,CAAQ,EAAS,IAAA,CAAK,IAA1D,CACA,SAAS,aAAA,CAAc,aAAa,iBAAA,CAAkB,sCACtD,SAAS,cAAA,CAAe,iBAAiB,KAAA,CAAM,OAAA,CAAU,eACzD,SAAS,aAAA,CAAc,uBAAuB,KAAA,CAAM,OAAA,CAAU,QAC9D,SAAS,aAAA,CAAc,aAAa,aAAA,CAAc,IAAI,MAAM,WAC5D,UAAU,KAAA,CAAM,iBAAkB,CAAE,UAAW,oBAAqB,GAExE,CAAE,MAAO,EAAG,CACV,aAAa,MAAA,CAAO,GACpB,QAAQ,GAAA,CAAI,kDAAmD,EACjE,CACF,CAEA,eAAe,EAAmB,CAAQ,EACxC,GAAI,CACF,IAAM,EAAW,MAAM,SAAS,GAAA,GAAM,SAAA,CAAU,gBAAgB,aAAA,CAAc,mBAAmB,CAAE,SAAA,CAAS,GAC5G,GAAI,CAAC,EAAS,IAAA,EAAM,QAAU,CAAC,EAAS,IAAA,CAAK,MAAA,CAAO,MAAA,CAAQ,CAC1D,QAAQ,GAAA,CAAI,kCACZ,MACF,CACA,GAAI,EAAS,IAAA,CAAK,MAAA,CAAO,MAAA,CAAS,EAChC,SAAS,aAAA,CAAc,cAAc,KAAA,CAAQ,mBACxC,GAAI,CAAe,CAAC,EAAS,IAAA,CAAK,MAAA,EAAQ,CAAC,EAAE,CAAC,CACnD,SAAS,aAAA,CAAc,cAAc,KAAA,CAAQ,CAAe,CAAC,EAAS,IAAA,CAAK,MAAA,EAAQ,CAAC,EAAE,CAAC,KAClF,CACL,QAAQ,GAAA,CAAI,2BAA4B,EAAS,IAAA,CAAK,MAAA,EAAQ,CAAC,EAAE,EACjE,MACF,CACA,SAAS,aAAA,CAAc,cAAc,iBAAA,CAAkB,wCACvD,SAAS,aAAA,CAAc,wBAAwB,KAAA,CAAM,OAAA,CAAU,QAC/D,SAAS,aAAA,CAAc,cAAc,aAAA,CAAc,IAAI,MAAM,WAC7D,UAAU,KAAA,CAAM,iBAAkB,CAAE,UAAW,qBAAsB,EACvE,CAAE,MAAO,EAAG,CACV,aAAa,MAAA,CAAO,GACpB,QAAQ,GAAA,CAAI,gCAAiC,EAC/C,CACF,CAEA,eAAe,IACb,SAAS,cAAA,CAAe,kBAAkB,gBAAA,CAAiB,QAAS,KAClE,SAAS,aAAA,CAAc,iBAAiB,KAAA,CAAQ,GAChD,SAAS,aAAA,CAAc,2BAA2B,KAAA,CAAM,OAAA,CAAU,OAClE,EAAiB,qBACjB,SAAS,aAAA,CAAc,iBAAiB,iBAAA,CAAkB,GAC5D,GACA,SAAS,cAAA,CAAe,mBAAmB,gBAAA,CAAiB,QAAS,KACnE,SAAS,aAAA,CAAc,iBAAiB,iBAAA,CAAkB,GAC5D,EACF,CAEA,eAAe,IACb,SAAS,cAAA,CAAe,eAAe,gBAAA,CAAiB,QAAS,KAC/D,SAAS,aAAA,CAAc,cAAc,KAAA,CAAQ,GAC7C,SAAS,aAAA,CAAc,wBAAwB,KAAA,CAAM,OAAA,CAAU,OAC/D,SAAS,aAAA,CAAc,cAAc,iBAAA,CAAkB,IACvD,EAAiB,iBACnB,GACA,SAAS,cAAA,CAAe,gBAAgB,gBAAA,CAAiB,QAAS,KAChE,SAAS,aAAA,CAAc,cAAc,iBAAA,CAAkB,IACvD,SAAS,aAAA,CAAc,cAAc,iBAAA,CAAkB,GACzD,EACF,CAgDA,eAAe,IACb,SAAS,cAAA,CAAe,cAAc,gBAAA,CAAiB,QAAS,KAC9D,SAAS,aAAA,CAAc,aAAa,KAAA,CAAQ,GAC5C,SAAS,aAAA,CAAc,uBAAuB,KAAA,CAAM,OAAA,CAAU,OAC9D,EAAiB,kBACjB,SAAS,aAAA,CAAc,aAAa,iBAAA,CAAkB,GACxD,GACA,SAAS,cAAA,CAAe,eAAe,gBAAA,CAAiB,QAAS,KAC/D,SAAS,aAAA,CAAc,aAAa,iBAAA,CAAkB,GACxD,EACF,CAcA,eAAe,IACb,SAAS,cAAA,CAAe,eAAe,gBAAA,CAAiB,QAAS,KAC/D,SAAS,aAAA,CAAc,cAAc,KAAA,CAAQ,GAC7C,SAAS,aAAA,CAAc,wBAAwB,KAAA,CAAM,OAAA,CAAU,OAC/D,EAAiB,kBACjB,SAAS,aAAA,CAAc,cAAc,iBAAA,CAAkB,GACzD,GACA,SAAS,cAAA,CAAe,gBAAgB,gBAAA,CAAiB,QAAS,KAChE,SAAS,aAAA,CAAc,cAAc,iBAAA,CAAkB,GACzD,EACF,CAEA,SAAS,IACP,SAAS,cAAA,CAAe,iBAAiB,KAAA,CAAM,OAAA,CAAU,OACzD,IAAgB,OAAA,CAAQ,AAAA,IACtB,SAAS,cAAA,CAAe,CAAC,EAAE,EAAU,OAAO,CAAC,EAAE,KAAA,CAAM,eAAA,CAAkB,GACvE,AAAA,EAAe,EAAW,gBAC5B,GAEA,cAAc,YAAa,MAC3B,MAAM,IAAA,CAAK,SAAS,gBAAA,CAAiB,qBAAqB,OAAA,CAAQ,AAAA,GAAM,EAAG,KAAA,CAAM,OAAA,CAAU,QAC3F,cAAc,WAAY,MAC1B,cAAc,eAAgB,MAC9B,cAAc,YAAa,MAC3B,cAAc,oBAAqB,MAEnC,cAAc,kBAAmB,MACjC,cAAc,wBAAyB,MACvC,cAAc,wBAAyB,MAEvC,EAAiB,QAAS,IAC1B,EAAiB,UAAW,IAC5B,EAAiB,cAAe,IAChC,cAAc,KAAA,CAAM,OAAA,CAAU,OAC9B,IAAM,EAAe,EAAE,iBACvB,EAAa,GAAA,CAAI,IACjB,EAAa,OAAA,CAAQ,UAErB,yBAAyB;AACzB,SAAS,cAAA,CAAe,OAAO,sBAAA,CAAuB,SAAA,CAAU,MAAA,CAAO,yBACvE,SAAS,cAAA,CAAe,OAAO,OAAA,CAAU,CAAA,EACzC,SAAS,cAAA,CAAe,UAAU,sBAAA,CAAuB,SAAA,CAAU,MAAA,CAAO,yBAC1E,SAAS,cAAA,CAAe,UAAU,OAAA,CAAU,CAAA,EAC5C,SAAS,cAAA,CAAe,SAAS,sBAAA,CAAuB,SAAA,CAAU,GAAA,CAAI,yBACtE,SAAS,cAAA,CAAe,SAAS,OAAA,CAAU,CAAA,EAE3C,sBAAsB;AACtB,IAA0B,OAAA,CAAQ,CAAC,EAAO,KACxC,SAAS,cAAA,CAAe,GAAK,sBAAA,CAAuB,SAAA,CAAU,MAAA,CAAO,yBACrE,SAAS,cAAA,CAAe,GAAK,OAAA,CAAU,CAAA,CACzC,GACqE,CAAA,IAAjE,SAAS,cAAA,CAAe,6BAA6B,OAAA,GACvD,SAAS,cAAA,CAAe,6BAA6B,KAArD,GACA,SAAS,cAAA,CAAe,6BAA6B,sBAAA,CAAuB,SAAA,CAAU,GAAA,CAAI,0BAE5F,eAAe,UAAA,CAAW,aAC1B,aAAa,UAAA,CAAW,UAC1B,CAiBA,SAAS,EAAiB,CAAS,EACjC,IAAM,EAAU,KAAK,KAAA,CAAM,aAAa,OAAA,CAAQ,WAChD,QAAO,GAAS,QAAQ,CAAC,EAAU,CACnC,OAAO,GAAS,QAAQ,CAAC,CAAC,EAAE,EAAU,KAAK,CAAC,CAAC,CAC7C,aAAa,OAAA,CAAQ,UAAW,KAAK,SAAA,CAAU,GACjD,CAEA,eAAe,IAyBb,EAAE,iBAAiB,OAAA,CAAQ,CAAE,kBAAmB,aAAc,YAAa,WAAY,KAxBhE,CACrB,CAAC,GAAM,GAAI,KAAQ,EAAG,EACtB,CAAC,KAAQ,eAAa,SAAY,CAC9B,CAAC,GAAM,WAAS,KAAQ,UAAQ,EAAG,CAAC,GAAM,OAAQ,KAAQ,MAAO,EAAG,CAAC,GAAM,OAAQ,KAAQ,MAAO,EAAG,CAAC,GAAM,UAAW,KAAQ,SAAU,EAAG,CAAC,GAAM,eAAgB,KAAQ,cAAe,EAAG,CAAC,GAAM,UAAW,KAAQ,SAAU,EAAG,CAAC,GAAM,QAAS,KAAQ,OAAQ,EAAG,CAAC,GAAM,aAAc,KAAQ,YAAa,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAAG,CAAC,GAAM,eAAa,KAAQ,cAAY,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAAG,CAAC,GAAM,UAAQ,KAAQ,SAAO,EAAG,CAAC,GAAM,QAAS,KAAQ,OAAQ,EAAG,CAAC,GAAM,QAAS,KAAQ,OAAQ,EAAG,CAAC,GAAM,sBAAiB,KAAQ,qBAAgB,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAAG,CAAC,GAAM,UAAQ,KAAQ,SAAO,EAAG,CAAC,GAAM,0BAAqB,KAAQ,yBAAoB,EAAG,CAAC,GAAM,gBAAc,KAAQ,eAAa,EAC/uB,AAAA,EACH,CAAC,KAAQ,aAAc,SAAY,CAC/B,CAAC,GAAM,OAAQ,KAAQ,MAAO,EAAG,CAAC,GAAM,QAAS,KAAQ,OAAQ,EAAG,CAAC,GAAM,QAAS,KAAQ,OAAQ,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAAG,CAAC,GAAM,eAAgB,KAAQ,cAAe,EAAG,CAAC,GAAM,mBAAiB,KAAQ,kBAAgB,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAAG,CAAC,GAAM,cAAe,KAAQ,aAAc,EAAG,CAAC,GAAM,cAAe,KAAQ,aAAc,EAAG,CAAC,GAAM,cAAe,KAAQ,aAAc,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAC1e,AAAA,EACH,CAAC,KAAQ,WAAY,SAAY,CAC7B,CAAC,GAAM,cAAY,KAAQ,aAAW,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAAG,CAAC,GAAM,MAAO,KAAQ,KAAM,EAAG,CAAC,GAAM,WAAY,KAAQ,UAAW,EAAG,CAAC,GAAM,cAAY,KAAQ,aAAW,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAAG,CAAC,GAAM,UAAW,KAAQ,SAAU,EAAG,CAAC,GAAM,aAAc,KAAQ,YAAa,EAAG,CAAC,GAAM,yBAAoB,KAAQ,wBAAmB,EAAG,CAAC,GAAM,iBAAe,KAAQ,gBAAc,EAAG,CAAC,GAAM,WAAY,KAAQ,UAAW,EAAG,CAAC,GAAM,gBAAc,KAAQ,eAAa,EACzhB,AAAA,EACH,CAAC,KAAQ,iBAAe,SAAY,CAChC,CAAC,GAAM,QAAS,KAAQ,OAAQ,EAAG,CAAC,GAAM,QAAS,KAAQ,OAAQ,EAAG,CAAC,GAAM,OAAQ,KAAQ,MAAO,EAAG,CAAC,GAAM,eAAgB,KAAQ,cAAe,EAAG,CAAC,GAAM,aAAc,KAAQ,YAAa,EAAG,CAAC,GAAM,aAAc,KAAQ,YAAa,EAAG,CAAC,GAAM,WAAY,KAAQ,UAAW,EAAG,CAAC,GAAM,YAAa,KAAQ,WAAY,EAAG,CAAC,GAAM,eAAa,KAAQ,cAAY,EAC/W,AAAA,EACH,CAAC,KAAQ,OAAQ,SAAY,CACzB,CAAC,GAAM,WAAY,KAAQ,UAAW,EAAG,CAAC,GAAM,WAAY,KAAQ,UAAW,EAAG,CAAC,GAAM,UAAW,KAAQ,SAAU,EAAG,CAAC,GAAM,gBAAiB,KAAQ,eAAgB,EAAG,CAAC,GAAM,UAAW,KAAQ,SAAU,EAAG,CAAC,GAAM,aAAc,KAAQ,YAAa,EAAG,CAAC,GAAM,QAAS,KAAQ,OAAQ,EAAG,CAAC,GAAM,YAAU,KAAQ,WAAS,EAAG,CAAC,GAAM,aAAc,KAAQ,YAAa,EAAG,CAAC,GAAM,OAAQ,KAAQ,cAAe,EAC5Z,AAAA,EACH,CAAC,KAAQ,YAAU,SAAY,CAC3B,CAAC,GAAM,mBAAiB,KAAQ,kBAAgB,EAAG,CAAC,GAAM,eAAa,KAAQ,cAAY,EAAG,CAAC,GAAM,iBAAe,KAAQ,gBAAc,EAAG,CAAC,GAAM,cAAY,KAAQ,aAAW,EAAG,CAAC,GAAM,sBAAiB,KAAQ,qBAAgB,EAAG,CAAC,GAAM,cAAY,KAAQ,aAAW,EAAG,CAAC,GAAM,gBAAc,KAAQ,eAAa,EAAG,CAAC,GAAM,WAAS,KAAQ,kBAAgB,EACxW,AAAA,EACH,CAAC,KAAQ,cAAe,SAAY,CAChC,CAAC,GAAM,iBAAe,KAAQ,gBAAc,EAAG,CAAC,GAAM,cAAY,KAAQ,aAAW,EAAG,CAAC,GAAM,gBAAW,KAAQ,eAAU,EAAG,CAAC,GAAM,WAAY,KAAQ,UAAW,EAAG,CAAC,GAAM,UAAW,KAAQ,SAAU,EAAG,CAAC,GAAM,OAAQ,KAAQ,MAAO,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAAG,CAAC,GAAM,OAAQ,KAAQ,MAAO,EAAG,CAAC,GAAM,OAAQ,KAAQ,MAAO,EAAG,CAAC,GAAM,QAAS,KAAQ,OAAQ,EAAG,CAAC,GAAM,WAAS,KAAQ,UAAQ,EAAG,CAAC,GAAM,aAAW,KAAQ,YAAU,EAAG,CAAC,GAAM,UAAW,KAAQ,SAAU,EAAG,CAAC,GAAM,OAAQ,KAAQ,MAAO,EAAG,CAAC,GAAM,WAAS,KAAQ,UAAQ,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAAG,CAAC,GAAM,cAAY,KAAQ,aAAW,EAAG,CAAC,GAAM,QAAS,KAAQ,OAAQ,EAAG,CAAC,GAAM,UAAW,KAAQ,SAAU,EAAG,CAAC,GAAM,SAAU,KAAQ,QAAS,EAC1uB,AAAA,EACJ,AAC2G,GAC5G,EAAE,QAAQ,EAAA,CAAG,QAAS,mDAAoD,WACpE,EAAE,IAAI,EAAE,MAAA,GAAS,IAAA,CAAK,SAAS,KAAA,CAAM,kBACvC,EAAE,IAAI,EAAE,MAAA,GAAS,WAAA,CAAY,mBAE7B,EAAE,mBAAmB,KAAA,GAAQ,WAAA,CAAY,kBACzC,EAAE,IAAI,EAAE,MAAA,GAAS,QAAA,CAAS,kBAE9B,GAEA,IAAI,EAAc,CAAA,EAClB,EAAE,iBAAiB,EAAA,CAAI,iBAAkB,KACvC,UAAU,KAAA,CAAM,QAAS,CAAE,UAAW,mBAAoB,GAC1D,SAAS,aAAA,CAAc,iBAAiB,aAAA,CAAc,IAAI,MAAM,UAClE,GACA,IAAI,EAAqB,CAAA,EACzB,EAAE,iBAAiB,EAAA,CAAG,eAAgB,KAC/B,IACH,EAAqB,CAAA,EACrB,EAAE,+BAA+B,EAAA,CAAG,QAAS,KAC3C,UAAU,KAAA,CAAM,QAAS,CAAE,UAAW,oBAAqB,EAC7D,GAEJ,GAEA,EAAE,iBAAiB,EAAA,CAAG,gBAAiB,KACrC,SAAS,aAAA,CAAc,QAAQ,KAAA,CAAM,QAAA,CAAW,OAChD,SAAS,aAAA,CAAc,QAAQ,KAAA,CAAM,QAAA,CAAW,SAChD,SAAS,aAAA,CAAc,QAAQ,KAAA,CAAM,QAAA,CAAW,QAClD,GACA,EAAE,iBAAiB,EAAA,CAAG,eAAgB,WACpC,UAAU,KAAA,CAAM,iBAAkB,CAAE,UAAW,uBAAwB,GACvE,SAAS,aAAA,CAAc,QAAQ,KAAA,CAAM,QAAA,CAAW,SAChD,SAAS,aAAA,CAAc,QAAQ,KAAA,CAAM,QAAA,CAAW,QAChD,SAAS,aAAA,CAAc,QAAQ,KAAA,CAAM,QAAA,CAAW,QAChD,IAAM,EAAc,SAAS,aAAA,CAAc,0BAS3C,GARA,EAAY,WAAA,CAAc,8CAC1B,EAAE,0BAA0B,EAAA,CAAG,QAAS,AAAC,IACnC,EAAE,MAAA,CAAO,KAAA,CAAM,MAAA,CAAS,EAC1B,EAAE,wCAAwC,IAAA,CAAK,CAAC,EAAK,IAAQ,EAAE,GAAK,QAAA,CAAS,mBAE7E,EAAE,mBAAmB,IAAA,CAAK,CAAC,EAAK,IAAQ,EAAE,GAAK,WAAA,CAAY,kBAE/D,GACI,CAAC,EAAa,CAChB,IAAM,EAAS,SAAS,cAAA,CAAe,uBACjC,EAAY,SAAS,aAAA,CAAc,qBACzC,EAAU,YAAA,CAAa,EAAQ,EAAU,UAAzC,EACA,EAAO,KAAA,CAAM,OAAA,CAAU,QACvB,EAAO,aAAA,CAAc,wBAAwB,OAAA,CAAU,IAAM,EAAE,iBAAiB,OAAA,CAAQ,SACxF,EAAc,CAAA,CAChB,CACA,SAAS,aAAA,CAAc,6BAA6B,gBAAA,CAAiB,SAAU,IAAM,SAAS,aAAA,CAAc,IAA5G,GACF,GAEA,EAAE,iBAAiB,EAAA,CAAG,SAAU,EAAiB,sBAEjD,6EAA6E;AAC7E,EAAE,iBAAiB,EAAA,CAAG,eAAgB,WACpC,EAAE,oBAAoB,GAAA,CAAI,aAAc,SAC1C,GACA,EAAE,iBAAiB,EAAA,CAAG,kBAAmB,WACvC,WAAW,WACT,EAAE,oBAAoB,GAAA,CAAI,aAAc,UAC1C,EAAG,GACL,EACF,CAYO,IAAM,EAAc,MAAO,IAChC,IAAM,EAAe,MAAO,IAC1B,IAAM,EAAM,IAAI,MAIhB,OAHA,EAAI,WAAA,CAAc,YAClB,EAAI,GAAA,CAAM,EACV,MAAM,EAAI,MAAV,GACO,CACT,EACM,EAAoB,AAAC,IACzB,GAAM,CAAC,EAAG,EAAG,EAAG,EAAE,CAAG,CAAC,CAAI,CAAC,EAAE,CAAE,CAAI,CAAC,EAAE,CAAE,CAAI,CAAC,EAAE,CAAE,CAAI,CAAC,EAAE,CAAC,CAEzD,IAAK,IAAI,EAAI,EAAG,EAAI,EAAK,MAAA,CAAQ,GAAK,EACpC,GAAI,CAAI,CAAC,EAAE,GAAK,GAAK,CAAI,CAAC,EAAI,EAAE,GAAK,GAAK,CAAI,CAAC,EAAI,EAAE,GAAK,GAAK,CAAI,CAAC,EAAI,EAAE,GAAK,EAC7E,MAAO,CAAA,EAGX,MAAO,CAAA,CACT,EACA,GAAI,CACF,GAAI,EAAO,KAAA,CAAM,eACf,MAAO,CAAA,EAET,IAAM,EAAM,MAAM,EAAa,GACzB,EAAS,SAAS,aAAA,CAAc,UAChC,EAAM,EAAO,UAAA,CAAW,MAC9B,EAAI,SAAA,CAAU,EAAK,EAAG,EAAG,EAAI,YAAA,CAAc,EAAI,aAA/C,EAEA,IAAM,EAAY,EAAI,YAAA,CAAa,EAAG,EAAG,EAAI,YAAA,CAAc,IAAI,IAA/D,CACM,EAAe,EAAI,YAAA,CAAa,EAAG,EAAI,aAAA,CAAgB,GAAI,EAAI,YAAA,CAAc,IAAI,IAAvF,CACM,EAAa,EAAI,YAAA,CAAa,EAAG,EAAG,GAAI,EAAI,aAAA,EAAe,IAAjE,CACM,EAAc,EAAI,YAAA,CAAa,EAAI,YAAA,CAAe,GAAI,EAAG,GAAI,EAAI,aAAA,EAAe,IAAtF,CAEA,OACI,EAAkB,IAClB,EAAkB,IAClB,EAAkB,IAClB,EAAkB,EAExB,CAAE,MAAM,EAAG,CAET,6EAA6E;AAC7E,OAFA,QAAQ,KAAA,CAAM,GAEP,CAAA,CACT,CACF,EAEA,6BAA6B;AAC7B,IACA,qEAAqE;AACrE,KAAK,OAAA,CAAQ,E,G,qC","sources":["<anon>","sellItem.js","sellItemHelpers.js"],"sourcesContent":["(function () {\nasync function $796bae1b0d1cb952$export$84f874cda6ebf2f2(input, fileName) {\n    if (!sessionStorage.getItem(\"newItemId\")) sessionStorage.setItem(\"newItemId\", await $796bae1b0d1cb952$export$70c624e1c153d1d3());\n    const tempId = sessionStorage.getItem(\"newItemId\");\n    let image = await $796bae1b0d1cb952$var$scaleImageToMaxSize(input);\n    if (!image) throw \"Fel vid bearbetning av vald bild.\";\n    const form = new FormData();\n    form.append(\"itemId\", tempId);\n    form.append(\"fileName\", fileName);\n    form.append(\"file\", image);\n    form.append(\"temporary\", \"true\");\n    form.append(\"generateSmallImage\", \"true\");\n    const response = await fetch(\"https://uploaditemimagebinary-heypmjzjfq-ew.a.run.app\", {\n        method: \"POST\",\n        body: form\n    });\n    return await response.json();\n}\nasync function $796bae1b0d1cb952$var$scaleImageToMaxSize(input) {\n    if (input.size < 9437184) // Don't compress images < 9MB in size\n    return Promise.resolve(input);\n    return new Promise((resolve, reject)=>{\n        const MAX_WIDTH = 1512;\n        const MAX_HEIGHT = 2016;\n        const reader = new FileReader();\n        reader.onload = ()=>{\n            const img = document.createElement(\"img\");\n            img.onload = ()=>{\n                let width = img.width;\n                let height = img.height;\n                if (width > height) {\n                    if (width > MAX_WIDTH) {\n                        height = height * (MAX_WIDTH / width);\n                        width = MAX_WIDTH;\n                    }\n                } else if (height > MAX_HEIGHT) {\n                    width = width * (MAX_HEIGHT / height);\n                    height = MAX_HEIGHT;\n                }\n                const canvas = document.createElement(\"canvas\");\n                canvas.width = width;\n                canvas.height = height;\n                const ctx = canvas.getContext(\"2d\");\n                ctx.imageSmoothingQuality = \"high\";\n                ctx.drawImage(img, 0, 0, width, height);\n                canvas.toBlob(resolve, \"image/jpeg\");\n            };\n            img.src = reader.result;\n            reader.onerror = reject;\n        };\n        reader.readAsDataURL(input);\n    });\n}\nasync function $796bae1b0d1cb952$export$70c624e1c153d1d3() {\n    const endpointUrl = \"https://generateuniqueid-heypmjzjfq-ew.a.run.app\";\n    try {\n        const response = await fetch(endpointUrl, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n        if (!response.ok) {\n            console.error(`Error: ${response.statusText}`);\n            return null;\n        }\n        const data = await response.json();\n        return data.id;\n    } catch (error) {\n        console.error(`Failed to fetch unique ID, generating uuidv4 id: ${error.message}`, error);\n        return uuidv4();\n    }\n}\nasync function $796bae1b0d1cb952$export$ace0eeb8d81a6535(imageUrl, saveState = true) {\n    const enhancedImageUrls = await $796bae1b0d1cb952$var$createEnhancedImage(imageUrl);\n    if (enhancedImageUrls?.url) {\n        $796bae1b0d1cb952$export$103dee3750c6df19(\"enhancedFrontImage\", enhancedImageUrls.url, enhancedImageUrls.urlSmall);\n        $796bae1b0d1cb952$export$3fb7c784498eae74(\"frontImage\", window.innerWidth <= 400 ? enhancedImageUrls.urlSmall : enhancedImageUrls.url);\n    }\n    $796bae1b0d1cb952$export$f4e19468e22ee9d3(\"frontImage\");\n    return enhancedImageUrls;\n}\nasync function $796bae1b0d1cb952$var$createEnhancedImage(imageUrl) {\n    try {\n        const response = await firebase.app().functions(\"europe-west1\").httpsCallable(\"enhanceFrontImage\")({\n            imageUrl: imageUrl\n        });\n        sessionStorage.setItem(\"enhancedFrontImage\", response.data.url);\n        return response.data;\n    } catch (ex) {\n        errorHandler.report(ex);\n        console.error(ex);\n        return \"\";\n    }\n}\nfunction $796bae1b0d1cb952$export$f4e19468e22ee9d3(imageName) {\n    document.getElementById(`loading${$796bae1b0d1cb952$export$d07f57595c356899(imageName)}Icon`).style.display = \"none\";\n    document.getElementById(`delete${$796bae1b0d1cb952$export$d07f57595c356899(imageName)}Icon`).style.display = \"inline-block\";\n    if (imageName === \"frontImage\") document.getElementById(\"enhancedAnimationDiv\").style.display = \"none\";\n}\nfunction $796bae1b0d1cb952$export$103dee3750c6df19(imageName, imageUrl, imageUrlSmall) {\n    let newItem = JSON.parse(localStorage.getItem(\"newItem\") || JSON.stringify({}));\n    const images = newItem.images || {};\n    images[imageName] = imageUrl;\n    images[`${imageName}Small`] = imageUrlSmall;\n    newItem.images = images;\n    localStorage.setItem(\"newItem\", JSON.stringify(newItem));\n}\nfunction $796bae1b0d1cb952$export$3fb7c784498eae74(imageName, url) {\n    document.getElementById(`${imageName}Preview`).style.backgroundImage = `url('${url}')`;\n    $796bae1b0d1cb952$export$f4e19468e22ee9d3(imageName);\n}\nfunction $796bae1b0d1cb952$export$d07f57595c356899(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1);\n}\nasync function $796bae1b0d1cb952$export$16814c2c31118a6e(input, imageName) {\n    try {\n        $796bae1b0d1cb952$var$hideImageError(imageName);\n        let src = URL.createObjectURL(input);\n        document.getElementById(`${imageName}PreviewUploading`).style.backgroundImage = `url('${src}')`;\n        document.getElementById(`${imageName}Preview`).style.backgroundImage = `url('${src}')`;\n        $796bae1b0d1cb952$var$showLoadingIcon(imageName);\n        $796bae1b0d1cb952$export$b8d427576f438d88(imageName, \"success-state\");\n        const { url: imageUrl, urlSmall: imageUrlSmall } = await $796bae1b0d1cb952$export$84f874cda6ebf2f2(input, imageName);\n        $796bae1b0d1cb952$export$103dee3750c6df19(imageName, imageUrl, imageUrlSmall);\n        return imageUrl;\n    } catch (ex) {\n        console.error(\"Failed to upload image\", ex);\n        errorHandler.report(ex);\n        document.getElementById(`${imageName}PreviewUploading`).style.backgroundImage = \"\";\n        document.getElementById(`${imageName}Preview`).style.backgroundImage = \"\";\n        document.getElementById(`loading${$796bae1b0d1cb952$export$d07f57595c356899(imageName)}Icon`).style.display = \"none\";\n        $796bae1b0d1cb952$export$b8d427576f438d88(imageName, \"default-state\");\n        if (input.size > 10485760) $796bae1b0d1cb952$var$showImageError(imageName, \"Error: Bilden \\xe4r f\\xf6r stor. Max 10 MB.\");\n        else $796bae1b0d1cb952$var$showImageError(imageName, \"Error: N\\xe5got gick fel vid uppladdning, f\\xf6rs\\xf6k igen eller kontakt oss om felet kvarst\\xe5r.\");\n        document.getElementById(imageName).value = \"\";\n    }\n}\nfunction $796bae1b0d1cb952$var$showImageError(imageName, error) {\n    const parentNode = document.getElementById(imageName).parentNode.parentNode;\n    parentNode.querySelector(\".w-file-upload-error\").style.display = \"block\";\n    parentNode.querySelector(\".w-file-upload-error-msg\").innerText = error;\n}\nfunction $796bae1b0d1cb952$var$hideImageError(imageName) {\n    const parentNode = document.getElementById(imageName).parentNode.parentNode;\n    parentNode.querySelector(\".w-file-upload-error\").style.display = \"none\";\n}\nfunction $796bae1b0d1cb952$export$b8d427576f438d88(imageName, state) {\n    const siblings = document.getElementById(imageName).parentNode.parentNode.childNodes;\n    for(let i = 0; i < siblings.length; i++)if (siblings[i].className.includes(state)) siblings[i].style.display = \"block\";\n    else // Hide other states of file input field \"empty-state\" and \"error-state\"\n    siblings[i].style.display = \"none\";\n}\nfunction $796bae1b0d1cb952$var$showLoadingIcon(imageName) {\n    if (imageName === \"frontImage\") {\n        document.getElementById(`delete${$796bae1b0d1cb952$export$d07f57595c356899(imageName)}Icon`).style.display = \"none\";\n        document.getElementById(\"enhancedAnimationDiv\").style.display = \"block\";\n        triggerEnhancingAnimation.click();\n        return;\n    }\n    document.getElementById(`loading${$796bae1b0d1cb952$export$d07f57595c356899(imageName)}Icon`).style.display = \"inline-block\";\n    document.getElementById(`delete${$796bae1b0d1cb952$export$d07f57595c356899(imageName)}Icon`).style.display = \"none\";\n}\n\n\nfunction $c023972b25f99719$var$defectsChoicesInSwedish() {\n    return new Map().set(\"hole\", \"H\\xe5l\").set(\"stain\", \"Fl\\xe4ck\").set(\"lostFit\", \"Tappad passform\").set(\"nopprig\", \"Nopprig\").set(\"threadUp\", \"Tr\\xe5dsl\\xe4pp\").set(\"colorChange\", \"F\\xe4rg\\xe4ndring\").set(\"otherDefect\", \"Annat\");\n}\nfunction $c023972b25f99719$var$imageElements() {\n    return [\n        \"frontImage\",\n        \"brandTagImage\",\n        \"defectImage\",\n        \"materialTagImage\",\n        \"extraImage\"\n    ];\n}\nvar $c023972b25f99719$var$userItemsCount;\nfunction $c023972b25f99719$var$imageUploadHandlers() {\n    let frontImageUpload = document.getElementById(\"frontImage\");\n    let brandTagImageUpload = document.getElementById(\"brandTagImage\");\n    let productImageUpload = document.getElementById(\"productImage\");\n    let defectImageUpload = document.getElementById(\"defectImage\");\n    let materialTagImageUpload = document.getElementById(\"materialTagImage\");\n    let extraImageUpload = document.getElementById(\"extraImage\");\n    // display image when file has been selected\n    $(\"#frontImage\").off(\"change\");\n    frontImageUpload.addEventListener(\"change\", $c023972b25f99719$var$frontImageChangeHandler, {\n        capture: true\n    });\n    $(\"#brandTagImage\").off(\"change\");\n    brandTagImageUpload.addEventListener(\"change\", $c023972b25f99719$var$brandTagImageChangeHandler, {\n        capture: true\n    });\n    $(\"#productImage\").off(\"change\");\n    productImageUpload.addEventListener(\"change\", $c023972b25f99719$var$productImageChangeHandler, {\n        capture: true\n    });\n    $(\"#defectImage\").off(\"change\");\n    defectImageUpload.addEventListener(\"change\", $c023972b25f99719$var$defectImageChangeHandler, {\n        capture: true\n    });\n    $(\"#materialTag\").off(\"change\");\n    materialTagImageUpload.addEventListener(\"change\", $c023972b25f99719$var$materialTagImageChangeHandler, {\n        capture: true\n    });\n    $(\"#extraImage\").off(\"change\");\n    extraImageUpload.addEventListener(\"change\", $c023972b25f99719$var$extraImageChangeHandler, {\n        capture: true\n    });\n}\nasync function $c023972b25f99719$var$sellItemMainAuthenticated() {\n    console.log(\"sellItemMainAuthenticated \" + new Date());\n    // Visa alla \"viktiga\" fält om man är inloggad\n    toggleMoreInfoFields.click();\n    // Create item from sessionStorage\n    if (sessionStorage.getItem(\"itemToBeCreatedAfterSignIn\")) {\n        // ... if we are redirected here from the sign-in page\n        if (document.referrer.includes(\"/sign-in\")) {\n            document.getElementById(\"loadingDiv\").style.display = \"flex\";\n            document.getElementById(\"creatingItemText\").style.display = \"block\";\n            await $c023972b25f99719$var$createItemAfterSignIn();\n            const shippingMethod = sessionStorage.getItem(\"shippingMethod\");\n            if (shippingMethod) await firebase.app().functions(\"europe-west1\").httpsCallable(\"updateFirebaseUser\")({\n                preferences: {\n                    shippingMethod: shippingMethod\n                }\n            });\n            const userPhoneSet = user.current?.phoneNumber?.length;\n            return location.href = userPhoneSet ? \"/item-confirmation\" : \"/user-contact\";\n        } else // otherwise make sure to remove any previously saved item as a precaution\n        sessionStorage.removeItem(\"itemToBeCreatedAfterSignIn\");\n    }\n    // Get user's item count to be able to send 'User Activated' event\n    const items = await getItems(authUser.current.uid);\n    $c023972b25f99719$var$userItemsCount = items.size;\n}\nasync function $c023972b25f99719$var$sellItemMain() {\n    localStorage.removeItem(\"latestItemCreated\");\n    sessionStorage.removeItem(\"itemValuation\");\n    // Initial state\n    $c023972b25f99719$var$imageUploadHandlers();\n    setupModelSearchEventListeners();\n    $c023972b25f99719$var$initializeSelectColor();\n    $c023972b25f99719$var$initializeInputEventListeners();\n    autocomplete(document.getElementById(\"itemBrand\"), brands);\n    // Hide/Show warning about difficulty to sell certain brands\n    let brand = document.getElementById(\"itemBrand\");\n    let hardToSellDiv1 = document.getElementById(\"hardToSellDiv\");\n    let words1 = [\n        \"H&M\",\n        \"HM\",\n        \"Zara\",\n        \"ASOS\",\n        \"Nelly\",\n        \"Gina Tricot\",\n        \"BikBok\",\n        \"Bik Bok\",\n        \"Lindex\",\n        \"Kappahl\",\n        \"Cubus\",\n        \"NA-KD\",\n        \"NAKD\",\n        \"Mango\",\n        \"Ellos\",\n        \"Primark\",\n        \"Shein\",\n        \"Vila\",\n        \"Forever 21\",\n        \"Pull & Bear\",\n        \"Bershka\",\n        \"Stradivarius\",\n        \"Ok\\xe4nt\",\n        \"Unknown\",\n        \"Vet ej\",\n        \"...\",\n        \"Vet inte\",\n        \"Ok\\xe4nd\",\n        \"-\",\n        \"Se bild\"\n    ];\n    brand.oninput = function() {\n        shareSoldDiv.style.display = \"none\";\n        let value = this.value;\n        $c023972b25f99719$var$checkBrand(value);\n    };\n    // Hide/Show extra fields for defects\n    itemCondition.onchange = function() {\n        let input = this.value;\n        if (input == \"Anv\\xe4nd, tecken p\\xe5 slitage\") {\n            defectInfoDiv.style.display = \"block\";\n            itemCondition.style.color = \"#333\";\n        } else if (input == \"\") {\n            defectInfoDiv.style.display = \"none\";\n            itemCondition.style.color = \"#929292\";\n        } else {\n            defectInfoDiv.style.display = \"none\";\n            itemCondition.style.color = \"#333\";\n        }\n    };\n    personalId.addEventListener(\"input\", ()=>{\n        const error = isValidSwedishSsn(personalId.value) ? \"\" : \"Ogiltigt personnummer\";\n        personalId.setCustomValidity(error);\n    });\n    await $c023972b25f99719$var$initializeCategorySelect();\n    await $c023972b25f99719$var$initializeColorConfirm();\n    await $c023972b25f99719$var$initializeBrandConfirm();\n    await $c023972b25f99719$var$initializeMaterialConfirm();\n    await $c023972b25f99719$var$initializeSizeConfirm();\n    $c023972b25f99719$var$initializeSuggestButtonsSaveState();\n    $c023972b25f99719$var$initializeClearFormButton();\n    $c023972b25f99719$var$initializeDeleteImageListeners();\n    document.getElementById(\"clearItemForm\").addEventListener(\"click\", $c023972b25f99719$var$clearFormFields);\n    if (params.id) {\n        // Fill form if the user comes from a prefill link (re-sell item)\n        sessionStorage.removeItem(\"newItemId\");\n        localStorage.removeItem(\"newItem\");\n        auth.onAuthStateChanged(function(user1) {\n            if (!user1) document.getElementById(\"maiIntro\").style.display = \"block\";\n        });\n        document.getElementById(\"resellIntro\").style.display = \"block\";\n        await $c023972b25f99719$var$fillForm(params.id);\n        document.getElementById(\"triggerShowSellItemContent\").click();\n    } else if (sessionStorage.getItem(\"itemToBeCreatedAfterSignIn\") && document.referrer.includes(\"/sign-in\")) ;\n    else if (localStorage.getItem(\"newItem\") && !$c023972b25f99719$var$isDefaultFormState(JSON.parse(localStorage.getItem(\"newItem\")))) {\n        // Saved state from a previous visit to /sell-item - restore the data\n        const newItem = JSON.parse(localStorage.getItem(\"newItem\"));\n        document.getElementById(\"frontImage\").required = true;\n        document.getElementById(\"brandTagImage\").required = true;\n        await $c023972b25f99719$var$fillForm(null, newItem, true);\n        document.getElementById(\"clearItemForm\").style.display = \"block\";\n        document.getElementById(\"triggerShowSellItemContent\").click();\n    } else {\n        document.getElementById(\"triggerShowSellItemContent\").click();\n        document.getElementById(\"frontImage\").required = true;\n        document.getElementById(\"brandTagImage\").required = true;\n    }\n    $c023972b25f99719$var$initializeSaveStateListeners();\n    $c023972b25f99719$var$initializeRestoreOnNavigation();\n}\nasync function $c023972b25f99719$var$addItem(event) {\n    const id = sessionStorage.getItem(\"newItemId\") || await (0, $796bae1b0d1cb952$export$70c624e1c153d1d3)();\n    try {\n        document.getElementById(\"addItemFormDiv\").style.display = \"none\";\n        document.getElementById(\"loadingDiv\").style.display = \"flex\";\n        document.getElementById(\"clearItemForm\").style.display = \"none\";\n        const item = await $c023972b25f99719$var$addItemInner(id);\n        const nextStep = await $c023972b25f99719$var$getAndSaveMlValuation(id, item.preferences.userValuationApproval);\n        // Track with segment 'User Activated'\n        if ($c023972b25f99719$var$userItemsCount === 0) analytics.track(\"User Activated\");\n        location.href = nextStep;\n    } catch (e) {\n        errorHandler.report(e);\n        console.error(\"addItem failed\", e);\n    }\n}\nfunction $c023972b25f99719$var$needsHumanCheck({ humanCheckNeeded: humanCheckNeeded, newMinMaxLog: newMinMaxLog }) {\n    return humanCheckNeeded || newMinMaxLog.match(/accept price is above max/i);\n}\nasync function $c023972b25f99719$var$saveItemValuation(itemId, mlValuationData, userValuationApproval) {\n    const { minPrice: minPrice, maxPrice: maxPrice, decline: decline, humanCheckNeeded: humanCheckNeeded, humanCheckExplanation: humanCheckExplanation, willNotSell: willNotSell, soldPrice: soldPrice, version: version, newMinPriceEstimate: newMinPriceEstimate, newMaxPriceEstimate: newMaxPriceEstimate, newMinMaxLog: newMinMaxLog, adjustmentAllowed: adjustmentAllowed, newBrand: newBrand, newBrandCategory: newBrandCategory } = mlValuationData || {};\n    if (!minPrice && !decline) return;\n    const valuationData = {\n        mlValuation: {\n            decline: decline,\n            humanCheckNeeded: humanCheckNeeded,\n            minPriceEstimate: minPrice,\n            maxPriceEstimate: maxPrice,\n            humanCheckExplanation: humanCheckExplanation,\n            willNotSellPrediction: willNotSell,\n            soldPriceEstimate: soldPrice,\n            modelVersion: version?.toString(),\n            newMinPriceEstimate: newMinPriceEstimate,\n            newMaxPriceEstimate: newMaxPriceEstimate,\n            newMinMaxLog: newMinMaxLog,\n            adjustmentAllowed: adjustmentAllowed,\n            newBrand: newBrand,\n            newBrandCategory: newBrandCategory\n        },\n        ...decline || $c023972b25f99719$var$needsHumanCheck(mlValuationData) ? {} : {\n            valuationStatus: \"Completed\",\n            valuationDate: new Date().toISOString(),\n            ...userValuationApproval ? {} : {\n                minPriceEstimate: minPrice,\n                maxPriceEstimate: maxPrice\n            },\n            infoRequests: {\n                price: {\n                    status: userValuationApproval ? \"Active\" : \"Resolved\",\n                    response: userValuationApproval ? \"\" : \"Accepted\",\n                    description: \"Vi b\\xf6rjar med startpriset, och justerar successivt ner till l\\xe4gsta priset under s\\xe4ljperioden p\\xe5 30 dagar. V\\xe4rderingen utg\\xe5r fr\\xe5n vad liknande s\\xe5lts f\\xf6r.\",\n                    minPrice: newMinPriceEstimate || minPrice,\n                    maxPrice: newMaxPriceEstimate || maxPrice\n                }\n            }\n        }\n    };\n    if (sessionStorage.getItem(\"itemToBeCreatedAfterSignIn\")) {\n        const item = JSON.parse(sessionStorage.getItem(\"itemToBeCreatedAfterSignIn\"));\n        sessionStorage.setItem(\"itemToBeCreatedAfterSignIn\", JSON.stringify({\n            id: item.id,\n            item: {\n                ...item.item,\n                ...valuationData\n            }\n        }));\n    } else {\n        await firebase.app().functions(\"europe-west1\").httpsCallable(\"saveItemValuationFields\")({\n            itemId: itemId,\n            ...valuationData\n        });\n        const latestItemCreated = JSON.parse(localStorage.getItem(\"latestItemCreated\"));\n        localStorage.setItem(\"latestItemCreated\", JSON.stringify({\n            ...latestItemCreated,\n            ...valuationData\n        }));\n    }\n}\nasync function $c023972b25f99719$var$getAndSaveMlValuation(itemId, userValuationApproval) {\n    const item = JSON.parse(sessionStorage.getItem(\"itemToBeCreatedAfterSignIn\") || \"{}\").item;\n    if (!itemId && !item) {\n        console.error(\"No item and no itemId, unexpected!!\");\n        return \"/item-confirmation\";\n    }\n    try {\n        const res = await firebase.app().functions(\"europe-west1\").httpsCallable(\"itemMlValuation\")({\n            itemId: itemId,\n            item: item\n        });\n        const { minPrice: minPrice, maxPrice: maxPrice, decline: decline } = res.data || {};\n        await $c023972b25f99719$var$saveItemValuation(itemId, res.data, userValuationApproval);\n        return $c023972b25f99719$var$nextStepAfterMlValuation(minPrice && maxPrice, decline, $c023972b25f99719$var$needsHumanCheck(res.data), userValuationApproval);\n    } catch (e) {\n        console.error(\"Failed to get ml valuation\", e);\n    }\n    return $c023972b25f99719$var$nextStepAfterMlValuation();\n}\nfunction $c023972b25f99719$var$nextStepAfterMlValuation(mlValuationPresent, decline, valuationNeedsChecking, userValuationApproval) {\n    if (!mlValuationPresent || valuationNeedsChecking || !userValuationApproval) {\n        if (sessionStorage.getItem(\"itemToBeCreatedAfterSignIn\")) return \"/sign-in\";\n        const userPhoneSet = user.current?.phoneNumber?.length;\n        return userPhoneSet ? \"/item-confirmation\" : \"/user-contact\";\n    }\n    return \"/item-valuation\";\n}\nfunction $c023972b25f99719$var$defaultFormState() {\n    return {\n        acceptPrice: null,\n        age: null,\n        brand: null,\n        category: null,\n        color: null,\n        condition: null,\n        defectDescription: null,\n        defects: [],\n        images: {},\n        material: null,\n        model: null,\n        originalPrice: null,\n        userValuationApproval: true,\n        sex: \"Woman\",\n        size: null,\n        userComment: null\n    };\n}\nfunction $c023972b25f99719$var$collect() {\n    let sex = \"\";\n    const now = new Date();\n    let status = \"New\";\n    let shippingStatus = \"Not sent\";\n    const size = itemSize.value;\n    const material = itemMaterial.value ? itemMaterial.value.trim() : \"\";\n    const brand = itemBrand.value ? itemBrand.value.trim() : \"\";\n    const model = itemModel.value ? itemModel.value.trim() : \"\";\n    const originalPrice = Number(itemOriginalPrice.value);\n    const age = itemAge.value;\n    const condition = itemCondition.value;\n    const defectDescription = itemDefectDescription.value ? itemDefectDescription.value.trim() : \"\";\n    const userComment = itemUserComment.value ? itemUserComment.value.trim() : \"\";\n    const acceptPrice = Number(itemLowestAcceptPrice.value);\n    const userValuationApproval = itemUserValuationApproval.checked;\n    // Get defects list\n    let defectElements = new Map().set(\"hole\", hole.checked).set(\"stain\", stain.checked).set(\"lostFit\", lostFit.checked).set(\"nopprig\", nopprig.checked).set(\"threadUp\", threadUp.checked).set(\"colorChange\", colorChange.checked).set(\"otherDefect\", otherDefect.checked);\n    let defects = [];\n    if (condition === \"Anv\\xe4nd, tecken p\\xe5 slitage\") defectElements.forEach((value, key)=>{\n        if (value) {\n            let string = $c023972b25f99719$var$defectsChoicesInSwedish().get(key);\n            defects.push(string);\n        }\n    });\n    // Get radio buttons\n    var sexRadioButtons = document.getElementsByName(\"Sex\");\n    for(var x = 0; x < sexRadioButtons.length; x++)if (sexRadioButtons[x].checked) sex = sexRadioButtons[x].id;\n    const modelBoxFilled = document.getElementById(\"findModelBoxFilled\");\n    let modelVariantFields = {};\n    if (modelBoxFilled.style.display === \"flex\") {\n        // There is a current model selected grab the cover image and id from it\n        const modelData = JSON.parse(modelBoxFilled.getAttribute(\"data-model\"));\n        modelVariantFields = {\n            modelCoverImageUrl: modelData[\"coverImage\"],\n            atModelVariantId: modelData[\"atVariantId\"]\n        };\n    }\n    const images = JSON.parse(localStorage.getItem(\"newItem\") || \"{}\").images;\n    return {\n        user: authUser.current?.uid || null,\n        createdAt: now.toISOString(),\n        status: status,\n        shippingStatus: shippingStatus,\n        sex: sex,\n        size: size,\n        material: material,\n        color: itemColor.value,\n        category: itemCategory.value,\n        brand: brand,\n        model: model,\n        originalPrice: originalPrice,\n        age: age,\n        condition: condition,\n        defects: defects,\n        defectDescription: defectDescription,\n        userComment: userComment,\n        acceptPrice: acceptPrice,\n        preferences: {\n            userValuationApproval: userValuationApproval\n        },\n        ...modelVariantFields,\n        images: images\n    };\n}\nasync function $c023972b25f99719$var$getShippingMethod() {\n    // If first time: User chooses shipping method preference in sell item form\n    let shippingMethod = \"Service point\";\n    if (!user.current?.preferences?.shippingMethod) {\n        if (authUser.current) await firebase.app().functions(\"europe-west1\").httpsCallable(\"updateFirebaseUser\")({\n            preferences: {\n                shippingMethod: shippingMethod\n            }\n        });\n        else sessionStorage.setItem(\"shippingMethod\", shippingMethod);\n    } else shippingMethod = user.current?.preferences?.shippingMethod;\n    return shippingMethod;\n}\nasync function $c023972b25f99719$var$addItemInner(id) {\n    const { modelCoverImageUrl: modelCoverImageUrl, images: images, ...pageData } = $c023972b25f99719$var$collect();\n    const shippingMethod = await $c023972b25f99719$var$getShippingMethod();\n    if (modelCoverImageUrl) {\n        images[\"coverImage\"] = modelCoverImageUrl;\n        pageData[\"coverImageUpdatedAt\"] = new Date().toISOString();\n    }\n    const createdFromItem = params.id ? {\n        createdFromItem: params.id\n    } : {};\n    const item = {\n        ...pageData,\n        shippingMethod: shippingMethod,\n        images: images,\n        ...createdFromItem,\n        version: \"2\"\n    };\n    if (!authUser.current) sessionStorage.setItem(\"itemToBeCreatedAfterSignIn\", JSON.stringify({\n        id: id,\n        item: item\n    }));\n    else {\n        const createItemResponse = await firebase.app().functions(\"europe-west1\").httpsCallable(\"createItem\")({\n            id: id,\n            item: item\n        });\n        localStorage.removeItem(\"newItem\");\n        sessionStorage.removeItem(\"newItemId\");\n        localStorage.setItem(\"latestItemCreated\", JSON.stringify(createItemResponse.data));\n    }\n    return item;\n}\nfunction $c023972b25f99719$var$initializeInputEventListeners() {\n    itemBrand.addEventListener(\"input\", $c023972b25f99719$var$fieldLabelToggle(\"itemBrandLabel\"));\n    itemBrand.addEventListener(\"input\", $c023972b25f99719$var$clearConfirmButtonValidity);\n    itemModel.addEventListener(\"input\", $c023972b25f99719$var$fieldLabelToggle(\"itemModelLabel\"));\n    itemSize.addEventListener(\"input\", $c023972b25f99719$var$fieldLabelToggle(\"itemSizeLabel\"));\n    itemSize.addEventListener(\"input\", $c023972b25f99719$var$clearConfirmButtonValidity);\n    itemMaterial.addEventListener(\"input\", $c023972b25f99719$var$fieldLabelToggle(\"itemMaterialLabel\"));\n    itemMaterial.addEventListener(\"input\", $c023972b25f99719$var$clearConfirmButtonValidity);\n    itemOriginalPrice.addEventListener(\"input\", $c023972b25f99719$var$fieldLabelToggle(\"itemOriginalPriceLabel\"));\n    itemAge.addEventListener(\"input\", $c023972b25f99719$var$fieldLabelToggle(\"itemAgeLabel\"));\n    itemCondition.addEventListener(\"input\", $c023972b25f99719$var$fieldLabelToggle(\"itemConditionLabel\"));\n    itemColor.addEventListener(\"change\", $c023972b25f99719$var$fieldLabelToggle(\"itemColorLabel\"));\n    itemColor.addEventListener(\"input\", $c023972b25f99719$var$clearConfirmButtonValidity);\n    itemUserComment.addEventListener(\"input\", $c023972b25f99719$var$fieldLabelToggle(\"userCommentLabel\"));\n    document.getElementById(\"addItemButton\").addEventListener(\"click\", ()=>{\n        document.getElementById(\"wf-form-Add-Item\").reportValidity();\n        const invalidElements = document.getElementById(\"wf-form-Add-Item\").querySelectorAll(\":invalid\");\n        const element = invalidElements?.[0];\n        if (element && element.getBoundingClientRect().height <= 1) element.style.cssText = \"width:100% !important;height:100% !important;\";\n        setTimeout(()=>{\n            if (invalidElements.length > 0) {\n                if (!$c023972b25f99719$var$isElementInView(element)) {\n                    const y = element.getBoundingClientRect().top + window.scrollY - 40;\n                    window.scrollTo({\n                        top: y,\n                        behavior: \"smooth\"\n                    });\n                }\n                document.getElementById(\"wf-form-Add-Item\").reportValidity();\n            }\n        }, 300);\n    });\n    addItemForm.addEventListener(\"submit\", $c023972b25f99719$var$addItem);\n    userAddressForm.addEventListener(\"submit\", addUserDetails);\n}\nfunction $c023972b25f99719$var$isElementInView(el) {\n    if (typeof jQuery === \"function\" && el instanceof jQuery) el = el[0];\n    const rect = el.getBoundingClientRect();\n    return rect.top >= 0 && rect.left >= 0 && rect.bottom <= (window.innerHeight / 2 || document.documentElement.clientHeight) && rect.right <= (window.innerWidth || document.documentElement.clientWidth);\n}\nasync function $c023972b25f99719$var$createItemAfterSignIn() {\n    const itemFromStorage = JSON.parse(sessionStorage.getItem(\"itemToBeCreatedAfterSignIn\"));\n    sessionStorage.removeItem(\"itemToBeCreatedAfterSignIn\");\n    sessionStorage.removeItem(\"newItemId\");\n    await firebase.app().functions(\"europe-west1\").httpsCallable(\"createItem\")(itemFromStorage);\n    localStorage.removeItem(\"newItem\");\n    itemFromStorage.item.id = itemFromStorage.id;\n    localStorage.setItem(\"latestItemCreated\", JSON.stringify(itemFromStorage.item));\n}\nfunction $c023972b25f99719$var$rememberUnsavedChanges() {\n    if (localStorage.getItem(\"latestItemCreated\")) return;\n    const { user: user1, createdAt: createdAt, status: status, shippingStatus: shippingStatus, modelVariantFields: modelVariantFields, ...itemToSave } = $c023972b25f99719$var$collect();\n    // Replace '' with null values\n    const item = Object.keys(itemToSave).reduce((acc, key)=>{\n        acc[key] = itemToSave[key] === \"\" ? null : itemToSave[key];\n        return acc;\n    }, {});\n    item.defects = item.defects ? item.defects : [];\n    item.userValuationApproval = item.preferences.userValuationApproval;\n    delete item.preferences;\n    item.acceptPrice = item.acceptPrice && item.acceptPrice > 0 ? item.acceptPrice : null;\n    item.originalPrice = item.originalPrice && item.originalPrice > 0 ? item.originalPrice : null;\n    [\n        \"itemBrand\",\n        \"itemSize\",\n        \"itemMaterial\",\n        \"itemColor\"\n    ].forEach((inputName)=>{\n        const suggestButtons = document.getElementById(inputName).parentNode.querySelector(\".suggest-buttons\") || document.getElementById(inputName).parentNode.parentNode.querySelector(\".suggest-buttons\");\n        if (suggestButtons?.style?.display === \"block\") item[`${inputName}Confirm`] = true;\n    });\n    if (!$c023972b25f99719$var$isDefaultFormState(item)) localStorage.setItem(\"newItem\", JSON.stringify(item));\n    else localStorage.removeItem(\"newItem\");\n}\nfunction $c023972b25f99719$var$isDefaultFormState(itemState) {\n    const defaultState = $c023972b25f99719$var$defaultFormState();\n    for(const field in defaultState){\n        if (!(field in itemState)) continue;\n        if (defaultState[field] instanceof Object) {\n            if (JSON.stringify(defaultState[field]) !== JSON.stringify(itemState[field])) return false;\n            continue;\n        }\n        if (itemState[field] !== defaultState[field]) return false;\n    }\n    return true;\n}\nfunction $c023972b25f99719$var$fieldLabelToggle(labelId) {\n    return (event)=>{\n        document.getElementById(labelId).style.display = event.target.value.length > 0 ? \"inline-block\" : \"none\";\n    };\n}\nfunction $c023972b25f99719$var$showSuggestButtons(fieldName, restoreSavedState, showConfirmation) {\n    if (restoreSavedState && showConfirmation) {\n        const suggestButtons = document.getElementById(fieldName).parentNode.querySelector(\".suggest-buttons\") || document.getElementById(fieldName).parentNode.parentNode.querySelector(\".suggest-buttons\");\n        suggestButtons.style.display = \"block\";\n        document.getElementById(fieldName).setCustomValidity(\"Bekr\\xe4fta eller \\xe4ndra v\\xe4rdet\");\n    }\n}\nasync function $c023972b25f99719$var$fillForm(itemId, savedItem = null, restoreSavedState = false) {\n    try {\n        let item = {\n            data: savedItem\n        };\n        if (!savedItem) item = await firebase.app().functions(\"europe-west1\").httpsCallable(\"getItem\")({\n            itemId: itemId\n        });\n        const data = item.data;\n        const images = data.images || {};\n        let originalPrice = data.originalPrice;\n        if (originalPrice <= 0) originalPrice = null;\n        // Populate images\n        for(const imageName in images){\n            let urlSmall = images[`${imageName}Small`] || images[`${imageName}Medium`] || images[imageName] || images[`${imageName}Large`];\n            let urlLarge = images[imageName] || images[`${imageName}Large`] || images[`${imageName}Medium`] || images[`${imageName}Small`];\n            if ($c023972b25f99719$var$imageElements().includes(imageName)) {\n                (0, $796bae1b0d1cb952$export$103dee3750c6df19)(imageName, urlLarge, urlSmall);\n                if (imageName === \"frontImage\" && images.enhancedFrontImage) {\n                    urlSmall = images[\"enhancedFrontImageSmall\"] || images[\"enhancedFrontImageMedium\"] || images[\"enhancedFrontImage\"] || images[\"enhancedFrontImageLarge\"];\n                    urlLarge = images[\"enhancedFrontImage\"] || images[\"enhancedFrontImageLarge\"] || images[\"enhancedFrontImageMedium\"] || images[\"enhancedFrontImageSmall\"];\n                    (0, $796bae1b0d1cb952$export$103dee3750c6df19)(\"enhancedFrontImage\", urlLarge, urlSmall);\n                }\n                (0, $796bae1b0d1cb952$export$3fb7c784498eae74)(imageName, urlSmall);\n                (0, $796bae1b0d1cb952$export$b8d427576f438d88)(imageName, \"success-state\");\n                document.getElementById(imageName).required = false;\n            }\n        }\n        // Show cover image preview if it is a model image, if it is a noBg image we skip it\n        sessionStorage.removeItem(\"coverImagePreviewUrl\");\n        const coverImageLarge = images.coverImageLarge || images.coverImage || null;\n        const coverImageSmall = images.coverImage || images.coverImageLarge || null;\n        if (coverImageLarge && !await $c023972b25f99719$export$5649c3d7079ff20f(coverImageSmall)) {\n            document.getElementById(\"coverImageContainer\").style.backgroundImage = `url('${coverImageSmall}')`;\n            document.getElementById(\"coverImagePreview\").style.display = \"block\";\n            (0, $796bae1b0d1cb952$export$103dee3750c6df19)(\"modelImage\", coverImageLarge, coverImageSmall);\n        }\n        // Populate text input fields\n        itemBrand.value = data.brand || \"\";\n        $c023972b25f99719$var$showSuggestButtons(\"itemBrand\", restoreSavedState, data.itemBrandConfirm);\n        // Don't use the setFieldValue for the brand since that triggers a dropdown to open\n        document.getElementById(\"itemBrandLabel\").style.display = data.brand ? \"inline-block\" : \"none\";\n        setFieldValue(\"itemSize\", data.size);\n        $c023972b25f99719$var$showSuggestButtons(\"itemSize\", restoreSavedState, data.itemSizeConfirm);\n        setFieldValue(\"itemMaterial\", data.material);\n        $c023972b25f99719$var$showSuggestButtons(\"itemMaterial\", restoreSavedState, data.itemMaterialConfirm);\n        setFieldValue(\"itemModel\", data.model);\n        setFieldValue(\"itemOriginalPrice\", originalPrice);\n        if (restoreSavedState) {\n            setFieldValue(\"itemUserComment\", data.userComment);\n            setFieldValue(\"itemDefectDescription\", data.defectDescription);\n            setFieldValue(\"itemLowestAcceptPrice\", data.acceptPrice <= 0 ? null : data.acceptPrice);\n        }\n        // Populate select fields\n        $c023972b25f99719$var$selectFieldValue(itemAge, data.age);\n        $c023972b25f99719$var$selectFieldValue(itemColor, data.color);\n        $c023972b25f99719$var$showSuggestButtons(\"itemColor\", restoreSavedState, data.itemColorConfirm);\n        $c023972b25f99719$var$selectFieldValue(itemCondition, data.condition);\n        if (itemCondition.selectedIndex >= 0 && itemCondition.options[itemCondition.selectedIndex].text === \"Anv\\xe4nd, tecken p\\xe5 slitage\") defectInfoDiv.style.display = \"block\";\n        const itemCategory1 = $(\"#itemCategory\");\n        itemCategory1.val(data.category);\n        itemCategory1.trigger(\"change\");\n        // Populate radio-buttons\n        if (data.sex) {\n            document.getElementById(\"Woman\").previousElementSibling.classList.remove(\"w--redirected-checked\"); // Unselect radio button 'Woman'\n            document.getElementById(\"Woman\").checked = false;\n            document.getElementById(data.sex).previousElementSibling.classList.add(\"w--redirected-checked\"); // Populate the right one\n            document.getElementById(data.sex).checked = true;\n        } else {\n            document.getElementById(\"Woman\").previousElementSibling.classList.add(\"w--redirected-checked\"); // Unselect radio button 'Woman'\n            document.getElementById(\"Woman\").checked = true;\n        }\n        // Populate checkboxes\n        $c023972b25f99719$var$defectsChoicesInSwedish().forEach((value, key)=>{\n            if (data.defects && data.defects.includes(value)) {\n                document.getElementById(key).previousElementSibling.classList.add(\"w--redirected-checked\");\n                document.getElementById(key).checked = true;\n            }\n        });\n        if (restoreSavedState) {\n            if (\"userValuationApproval\" in data && !data.userValuationApproval) {\n                document.getElementById(\"itemUserValuationApproval\").click();\n                document.getElementById(\"itemUserValuationApproval\").previousElementSibling.classList.remove(\"w--redirected-checked\");\n            }\n        }\n    } catch (error) {\n        console.error(\"Error getting item document:\", error);\n        errorHandler.report(error);\n    }\n    document.getElementById(\"loadingDiv\").style.display = \"none\";\n}\nfunction $c023972b25f99719$var$selectFieldValue(field, value) {\n    const selectIndex = Array.from(field.options).map((elm)=>elm.attributes.value.value).indexOf(value);\n    if (selectIndex > 0) {\n        field.selectedIndex = selectIndex;\n        field.style.color = \"#333\";\n    } else {\n        field.selectedIndex = 0;\n        field.style.color = \"#929292\";\n    }\n    field.dispatchEvent(new Event(\"input\"));\n    field.dispatchEvent(new Event(\"change\"));\n}\nfunction $c023972b25f99719$var$checkBrand(value) {\n    if (words.some((words1)=>value.toLowerCase().includes(words1.toLowerCase()))) {\n        hardToSellText.innerHTML = `Vi säljer i regel inte ${value}-plagg på grund av för lågt andrahandsvärde. Undantag kan finnas.`;\n        hardToSellDiv.style.display = \"block\";\n        return true;\n    } else hardToSellDiv.style.display = \"none\";\n}\nasync function $c023972b25f99719$var$checkAndDisplayShareSold(value) {\n    const response = await firebase.app().functions(\"europe-west1\").httpsCallable(\"fetchBrandShareSoldInfo\")({\n        cleanedBrandName: value\n    });\n    if (response.data && response.data.cleanedBrand) {\n        console.log(\"data.shareSold\", response.data.shareSold, \"data.cleanedBrand\", response.data.cleanedBrand);\n        if (response.data.shareSold >= \"65%\") {\n            shareSoldText.innerHTML = `Det är hög efterfrågan på ${response.data.cleanedBrand}`;\n            shareSoldDiv.style.display = \"block\";\n            return;\n        }\n    } else {\n        shareSoldText.innerHTML = \"\";\n        shareSoldDiv.style.display = \"none\";\n    }\n}\nfunction $c023972b25f99719$var$initializeSelectColor() {\n    const itemColor1 = document.getElementById(\"itemColor\");\n    itemColor1.onchange = function() {\n        let input = this.value;\n        if (input !== \"\") itemColor1.style.color = \"#333\";\n        else itemColor1.style.color = \"#929292\";\n    };\n    // Change font color of dropdown itemAge when user selects a value\n    const itemAge1 = document.getElementById(\"itemAge\");\n    itemAge1.onchange = function() {\n        let input = this.value;\n        if (input !== \"\") itemAge1.style.color = \"#333\";\n        else itemAge1.style.color = \"#929292\";\n    };\n}\nconst $c023972b25f99719$var$apiColorMapping = {\n    \"black\": \"Black\",\n    \"white\": \"White\",\n    \"gray\": \"Grey\",\n    \"blue\": \"Blue\",\n    \"dark_blue\": \"Navy\",\n    \"multicolor/colorful\": \"Multicolour\",\n    \"red\": \"Red\",\n    \"pink\": \"Pink\",\n    \"brown\": \"Brown\",\n    \"beige\": \"Beige\",\n    \"light_blue\": \"Blue\",\n    \"green\": \"Green\",\n    \"silver\": \"Silver\",\n    \"purple\": \"Purple\",\n    \"maroon\": \"Burgundy\",\n    \"gold\": \"Gold\",\n    \"orange\": \"Orange\",\n    \"yellow\": \"Yellow\",\n    \"teal\": \"Turquoise\",\n    \"olive\": \"Green\",\n    \"cyan\": \"Turquoise\",\n    \"magenta\": \"Pink\",\n    \"mustard\": \"Yellow\"\n};\nasync function $c023972b25f99719$var$frontImageChangeHandler(event) {\n    let input = this.files[0];\n    if (input) {\n        event.stopPropagation();\n        const imageUrl = await (0, $796bae1b0d1cb952$export$16814c2c31118a6e)(input, \"frontImage\");\n        if (!imageUrl || Object.keys(imageUrl).length === 0) return;\n        const promises = [];\n        promises.push($c023972b25f99719$var$detectAndFillColor(imageUrl), $c023972b25f99719$var$detectAndFillBrandAndMaterialAndSize(imageUrl), (0, $796bae1b0d1cb952$export$ace0eeb8d81a6535)(imageUrl));\n        await Promise.all(promises);\n        $c023972b25f99719$var$rememberUnsavedChanges();\n    }\n}\nasync function $c023972b25f99719$var$brandTagImageChangeHandler(event) {\n    let input = this.files[0];\n    if (input) {\n        event.stopPropagation();\n        const imageUrl = await (0, $796bae1b0d1cb952$export$16814c2c31118a6e)(input, \"brandTagImage\");\n        (0, $796bae1b0d1cb952$export$f4e19468e22ee9d3)(\"brandTagImage\");\n        await $c023972b25f99719$var$detectAndFillBrandAndMaterialAndSize(imageUrl);\n        $c023972b25f99719$var$rememberUnsavedChanges();\n    }\n}\nasync function $c023972b25f99719$var$productImageChangeHandler(event) {\n    let input = this.files[0];\n    if (input) {\n        event.stopPropagation();\n        const imageUrl = await (0, $796bae1b0d1cb952$export$16814c2c31118a6e)(input, \"productImage\");\n        (0, $796bae1b0d1cb952$export$f4e19468e22ee9d3)(\"productImage\");\n        await $c023972b25f99719$var$detectAndFillBrandAndMaterialAndSize(imageUrl);\n        $c023972b25f99719$var$rememberUnsavedChanges();\n    }\n}\nasync function $c023972b25f99719$var$defectImageChangeHandler(event) {\n    let input = this.files[0];\n    if (input) {\n        event.stopPropagation();\n        const imageUrl = await (0, $796bae1b0d1cb952$export$16814c2c31118a6e)(input, \"defectImage\");\n        (0, $796bae1b0d1cb952$export$f4e19468e22ee9d3)(\"defectImage\");\n        await $c023972b25f99719$var$detectAndFillBrandAndMaterialAndSize(imageUrl);\n        $c023972b25f99719$var$rememberUnsavedChanges();\n    }\n}\nasync function $c023972b25f99719$var$materialTagImageChangeHandler(event) {\n    let input = this.files[0];\n    if (input) {\n        event.stopPropagation();\n        const imageUrl = await (0, $796bae1b0d1cb952$export$16814c2c31118a6e)(input, \"materialTagImage\");\n        (0, $796bae1b0d1cb952$export$f4e19468e22ee9d3)(\"materialTagImage\");\n        await $c023972b25f99719$var$detectAndFillBrandAndMaterialAndSize(imageUrl);\n        $c023972b25f99719$var$rememberUnsavedChanges();\n    }\n}\nasync function $c023972b25f99719$var$extraImageChangeHandler(event) {\n    let input = this.files[0];\n    if (input) {\n        event.stopPropagation();\n        const imageUrl = await (0, $796bae1b0d1cb952$export$16814c2c31118a6e)(input, \"extraImage\");\n        (0, $796bae1b0d1cb952$export$f4e19468e22ee9d3)(\"extraImage\");\n        await $c023972b25f99719$var$detectAndFillBrandAndMaterialAndSize(imageUrl);\n        $c023972b25f99719$var$rememberUnsavedChanges();\n    }\n}\nfunction $c023972b25f99719$var$clearConfirmButtonValidity(event) {\n    event.currentTarget.setCustomValidity(\"\");\n    const suggestButtons = event.currentTarget.parentNode.querySelector(\".suggest-buttons\") || event.currentTarget.parentNode.parentNode.querySelector(\".suggest-buttons\");\n    suggestButtons.style.display = \"none\";\n}\nasync function $c023972b25f99719$var$detectAndFillBrandAndMaterialAndSize(imageUrl) {\n    try {\n        if (document.querySelector(\"#itemBrand\").value.length && document.querySelector(\"#itemMaterial\").value.length && document.querySelector(\"#itemSize\").value.length) // Don't do anything if both brand and material already filled in\n        return;\n        const response = await firebase.app().functions(\"europe-west1\").httpsCallable(\"detectItemBrandAndMaterialAndSize\")({\n            imageUrl: imageUrl\n        });\n        if (!document.querySelector(\"#itemBrand\").value.length && response.data?.brand) {\n            document.querySelector(\"#itemBrand\").value = response.data.brand;\n            document.querySelector(\"#itemBrand\").setCustomValidity(\"Bekr\\xe4fta eller \\xe4ndra m\\xe4rket\");\n            document.getElementById(\"itemBrandLabel\").style.display = \"inline-block\";\n            document.querySelector(\"#brandSuggestButtons\").style.display = \"block\";\n            document.querySelector(\"#itemBrand\").dispatchEvent(new Event(\"change\"));\n            analytics.track(\"Element Viewed\", {\n                elementID: \"brandSuggestButtons\"\n            });\n        }\n        if (!document.querySelector(\"#itemMaterial\").value.length && response.data?.materials) {\n            document.querySelector(\"#itemMaterial\").value = response.data.materials;\n            document.querySelector(\"#itemMaterial\").setCustomValidity(\"Bekr\\xe4fta eller \\xe4ndra materialet\");\n            document.getElementById(\"itemMaterialLabel\").style.display = \"inline-block\";\n            document.querySelector(\"#materialSuggestButtons\").style.display = \"block\";\n            document.querySelector(\"#itemMaterial\").dispatchEvent(new Event(\"change\"));\n            analytics.track(\"Element Viewed\", {\n                elementID: \"materialSuggestButtons\"\n            });\n        }\n        if (!document.querySelector(\"#itemSize\").value.length && response.data?.size) {\n            document.querySelector(\"#itemSize\").value = response.data.size;\n            document.querySelector(\"#itemSize\").setCustomValidity(\"Bekr\\xe4fta eller \\xe4ndra storlek\");\n            document.getElementById(\"itemSizeLabel\").style.display = \"inline-block\";\n            document.querySelector(\"#sizeSuggestButtons\").style.display = \"block\";\n            document.querySelector(\"#itemSize\").dispatchEvent(new Event(\"change\"));\n            analytics.track(\"Element Viewed\", {\n                elementID: \"sizeSuggestButtons\"\n            });\n        }\n    } catch (e) {\n        errorHandler.report(e);\n        console.log(\"Error calling detectItemBrandAndMaterialAndSize\", e);\n    }\n}\nasync function $c023972b25f99719$var$detectAndFillColor(imageUrl) {\n    try {\n        const response = await firebase.app().functions(\"europe-west1\").httpsCallable(\"detectItemColor\")({\n            imageUrl: imageUrl\n        });\n        if (!response.data?.colors || !response.data.colors.length) {\n            console.log(\"Unable to detect product color\");\n            return;\n        }\n        if (response.data.colors.length > 2) document.querySelector(\"#itemColor\").value = \"Multicolour\";\n        else if ($c023972b25f99719$var$apiColorMapping[response.data.colors?.[0]]) document.querySelector(\"#itemColor\").value = $c023972b25f99719$var$apiColorMapping[response.data.colors?.[0]];\n        else {\n            console.log(\"Unable to set color from\", response.data.colors?.[0]);\n            return;\n        }\n        document.querySelector(\"#itemColor\").setCustomValidity(\"Bekr\\xe4fta eller \\xe4ndra f\\xe4rgen\");\n        document.querySelector(\"#colorSuggestButtons\").style.display = \"block\";\n        document.querySelector(\"#itemColor\").dispatchEvent(new Event(\"change\"));\n        analytics.track(\"Element Viewed\", {\n            elementID: \"colorSuggestButtons\"\n        });\n    } catch (e) {\n        errorHandler.report(e);\n        console.log(\"Error calling detectItemColor\", e);\n    }\n}\nasync function $c023972b25f99719$var$initializeMaterialConfirm() {\n    document.getElementById(\"rejectMaterial\").addEventListener(\"click\", ()=>{\n        document.querySelector(\"#itemMaterial\").value = \"\";\n        document.querySelector(\"#materialSuggestButtons\").style.display = \"none\";\n        $c023972b25f99719$var$fieldLabelToggle(\"itemMaterialLabel\");\n        document.querySelector(\"#itemMaterial\").setCustomValidity(\"\");\n    });\n    document.getElementById(\"confirmMaterial\").addEventListener(\"click\", ()=>{\n        document.querySelector(\"#itemMaterial\").setCustomValidity(\"\");\n    });\n}\nasync function $c023972b25f99719$var$initializeBrandConfirm() {\n    document.getElementById(\"rejectBrand\").addEventListener(\"click\", ()=>{\n        document.querySelector(\"#itemBrand\").value = \"\";\n        document.querySelector(\"#brandSuggestButtons\").style.display = \"none\";\n        document.querySelector(\"#itemBrand\").setCustomValidity(\"\");\n        $c023972b25f99719$var$fieldLabelToggle(\"itemBrandLabel\");\n    });\n    document.getElementById(\"confirmBrand\").addEventListener(\"click\", ()=>{\n        document.querySelector(\"#itemBrand\").setCustomValidity(\"\");\n        document.querySelector(\"#itemBrand\").setCustomValidity(\"\");\n    });\n}\nfunction $c023972b25f99719$var$initializeClearFormButton() {\n    function showButtonIfFormChanged(event) {\n        let field = event.target;\n        if (field instanceof Element) {\n            const defaultValue = $c023972b25f99719$var$defaultFormState()[field.name];\n            if (defaultValue !== field.value && field.value !== \"\") document.getElementById(\"clearItemForm\").style.display = \"block\";\n        }\n    }\n    document.getElementById(\"wf-form-Add-Item\").addEventListener(\"input\", showButtonIfFormChanged);\n    document.querySelector(\"#wf-form-Add-Item select\").addEventListener(\"change\", showButtonIfFormChanged);\n}\nfunction $c023972b25f99719$var$initializeSaveStateListeners() {\n    // We delay the rememberUnsavedChanges call to allow any confirm/reject animations to finish\n    document.getElementById(\"wf-form-Add-Item\").querySelectorAll(\"input\").forEach((elm)=>{\n        elm.addEventListener(\"input\", $c023972b25f99719$var$rememberUnsavedChanges);\n    });\n    document.getElementById(\"wf-form-Add-Item\").querySelectorAll('input[type=\"radio\"]').forEach((elm)=>{\n        elm.addEventListener(\"change\", $c023972b25f99719$var$rememberUnsavedChanges);\n    });\n    document.getElementById(\"wf-form-Add-Item\").querySelectorAll('input[type=\"checkbox\"]').forEach((elm)=>{\n        elm.addEventListener(\"change\", $c023972b25f99719$var$rememberUnsavedChanges);\n    });\n    // We delay the rememberUnsavedChanges call to allow any confirm/reject animations to finish\n    document.getElementById(\"wf-form-Add-Item\").querySelectorAll(\"select\").forEach((elm)=>{\n        elm.addEventListener(\"change\", $c023972b25f99719$var$rememberUnsavedChanges);\n    });\n    document.getElementById(\"wf-form-Add-Item\").querySelectorAll(\"textarea\").forEach((elm)=>{\n        elm.addEventListener(\"input\", $c023972b25f99719$var$rememberUnsavedChanges);\n    });\n}\nfunction $c023972b25f99719$var$initializeRestoreOnNavigation() {\n    window.addEventListener(\"pageshow\", (event)=>{\n        if (event.persisted && localStorage.getItem(\"newItem\")) // Use setTimeout to make sure the document is loaded before we call fillForm()\n        setTimeout(async ()=>{\n            await $c023972b25f99719$var$fillForm(null, JSON.parse(localStorage.getItem(\"newItem\")), true);\n        }, 10);\n    });\n}\nasync function $c023972b25f99719$var$initializeSizeConfirm() {\n    document.getElementById(\"rejectSize\").addEventListener(\"click\", ()=>{\n        document.querySelector(\"#itemSize\").value = \"\";\n        document.querySelector(\"#sizeSuggestButtons\").style.display = \"none\";\n        $c023972b25f99719$var$fieldLabelToggle(\"itemBrandLabel\");\n        document.querySelector(\"#itemSize\").setCustomValidity(\"\");\n    });\n    document.getElementById(\"confirmSize\").addEventListener(\"click\", ()=>{\n        document.querySelector(\"#itemSize\").setCustomValidity(\"\");\n    });\n}\nfunction $c023972b25f99719$var$initializeSuggestButtonsSaveState() {\n    const observer = new MutationObserver((mutationsList, observer)=>{\n        const mutatedElement = mutationsList.find((elm)=>elm.attributeName === \"style\");\n        if (mutatedElement && mutatedElement.target.style.display === \"none\") $c023972b25f99719$var$rememberUnsavedChanges();\n    });\n    Array.from(document.querySelectorAll(\".suggest-buttons\")).forEach((elm)=>observer.observe(elm, {\n            attributes: true\n        }));\n}\nasync function $c023972b25f99719$var$initializeColorConfirm() {\n    document.getElementById(\"rejectColor\").addEventListener(\"click\", ()=>{\n        document.querySelector(\"#itemColor\").value = \"\";\n        document.querySelector(\"#colorSuggestButtons\").style.display = \"none\";\n        $c023972b25f99719$var$fieldLabelToggle(\"itemColorLabel\");\n        document.querySelector(\"#itemColor\").setCustomValidity(\"\");\n    });\n    document.getElementById(\"confirmColor\").addEventListener(\"click\", ()=>{\n        document.querySelector(\"#itemColor\").setCustomValidity(\"\");\n    });\n}\nfunction $c023972b25f99719$var$clearFormFields() {\n    document.getElementById(\"clearItemForm\").style.display = \"none\";\n    $c023972b25f99719$var$imageElements().forEach((imageName)=>{\n        document.getElementById(`${imageName}Preview`).style.backgroundImage = \"\";\n        (0, $796bae1b0d1cb952$export$b8d427576f438d88)(imageName, \"default-state\");\n    });\n    setFieldValue(\"itemBrand\", null);\n    Array.from(document.querySelectorAll(\".suggest-buttons\")).forEach((el)=>el.style.display = \"none\");\n    setFieldValue(\"itemSize\", null);\n    setFieldValue(\"itemMaterial\", null);\n    setFieldValue(\"itemModel\", null);\n    setFieldValue(\"itemOriginalPrice\", null);\n    setFieldValue(\"itemUserComment\", null);\n    setFieldValue(\"itemDefectDescription\", null);\n    setFieldValue(\"itemLowestAcceptPrice\", null);\n    $c023972b25f99719$var$selectFieldValue(itemAge, \"\");\n    $c023972b25f99719$var$selectFieldValue(itemColor, \"\");\n    $c023972b25f99719$var$selectFieldValue(itemCondition, \"\");\n    defectInfoDiv.style.display = \"none\";\n    const itemCategory1 = $(\"#itemCategory\");\n    itemCategory1.val(\"\");\n    itemCategory1.trigger(\"change\");\n    // Populate radio-buttons\n    document.getElementById(\"Man\").previousElementSibling.classList.remove(\"w--redirected-checked\");\n    document.getElementById(\"Man\").checked = false;\n    document.getElementById(\"Unisex\").previousElementSibling.classList.remove(\"w--redirected-checked\");\n    document.getElementById(\"Unisex\").checked = false;\n    document.getElementById(\"Woman\").previousElementSibling.classList.add(\"w--redirected-checked\"); // select radio button 'Woman'\n    document.getElementById(\"Woman\").checked = true;\n    // Populate checkboxes\n    $c023972b25f99719$var$defectsChoicesInSwedish().forEach((value, key)=>{\n        document.getElementById(key).previousElementSibling.classList.remove(\"w--redirected-checked\");\n        document.getElementById(key).checked = false;\n    });\n    if (document.getElementById(\"itemUserValuationApproval\").checked === false) {\n        document.getElementById(\"itemUserValuationApproval\").click();\n        document.getElementById(\"itemUserValuationApproval\").previousElementSibling.classList.add(\"w--redirected-checked\");\n    }\n    sessionStorage.removeItem(\"newItemId\");\n    localStorage.removeItem(\"newItem\");\n}\nfunction $c023972b25f99719$var$initializeDeleteImageListeners() {\n    $c023972b25f99719$var$imageElements().forEach((imageName)=>{\n        document.getElementById(`delete${(0, $796bae1b0d1cb952$export$d07f57595c356899)(imageName)}Icon`).addEventListener(\"click\", ()=>{\n            $c023972b25f99719$var$removeSavedImage(imageName);\n        });\n    });\n    document.getElementById(\"deleteFrontImageIcon\").addEventListener(\"click\", ()=>{\n        document.getElementById(\"frontImage\").required = true;\n        $c023972b25f99719$var$removeSavedImage(\"enhancedFrontImage\");\n    });\n    document.getElementById(\"deleteBrandTagImageIcon\").addEventListener(\"click\", ()=>{\n        document.getElementById(\"brandTagImage\").required = true;\n    });\n}\nfunction $c023972b25f99719$var$removeSavedImage(imageName) {\n    const newItem = JSON.parse(localStorage.getItem(\"newItem\"));\n    delete newItem?.images?.[imageName];\n    delete newItem?.images?.[`${imageName}Small`];\n    localStorage.setItem(\"newItem\", JSON.stringify(newItem));\n}\nasync function $c023972b25f99719$var$initializeCategorySelect() {\n    const itemCategories = [\n        {\n            \"id\": \"\",\n            \"text\": \"\"\n        },\n        {\n            \"text\": \"\\xd6verdelar\",\n            \"children\": [\n                {\n                    \"id\": \"Tr\\xf6ja\",\n                    \"text\": \"Tr\\xf6ja\"\n                },\n                {\n                    \"id\": \"Blus\",\n                    \"text\": \"Blus\"\n                },\n                {\n                    \"id\": \"Topp\",\n                    \"text\": \"Topp\"\n                },\n                {\n                    \"id\": \"Skjorta\",\n                    \"text\": \"Skjorta\"\n                },\n                {\n                    \"id\": \"Linneskjorta\",\n                    \"text\": \"Linneskjorta\"\n                },\n                {\n                    \"id\": \"T-shirt\",\n                    \"text\": \"T-shirt\"\n                },\n                {\n                    \"id\": \"Kavaj\",\n                    \"text\": \"Kavaj\"\n                },\n                {\n                    \"id\": \"Sweatshirt\",\n                    \"text\": \"Sweatshirt\"\n                },\n                {\n                    \"id\": \"Hoodie\",\n                    \"text\": \"Hoodie\"\n                },\n                {\n                    \"id\": \"Polotr\\xf6ja\",\n                    \"text\": \"Polotr\\xf6ja\"\n                },\n                {\n                    \"id\": \"Tunika\",\n                    \"text\": \"Tunika\"\n                },\n                {\n                    \"id\": \"V\\xe4st\",\n                    \"text\": \"V\\xe4st\"\n                },\n                {\n                    \"id\": \"Kofta\",\n                    \"text\": \"Kofta\"\n                },\n                {\n                    \"id\": \"Linne\",\n                    \"text\": \"Linne\"\n                },\n                {\n                    \"id\": \"Tr\\xe4ningstr\\xf6ja\",\n                    \"text\": \"Tr\\xe4ningstr\\xf6ja\"\n                },\n                {\n                    \"id\": \"Poncho\",\n                    \"text\": \"Poncho\"\n                },\n                {\n                    \"id\": \"Pik\\xe9\",\n                    \"text\": \"Pik\\xe9\"\n                },\n                {\n                    \"id\": \"L\\xe5ng\\xe4rmad T-shirt\",\n                    \"text\": \"L\\xe5ng\\xe4rmad T-shirt\"\n                },\n                {\n                    \"id\": \"Kostymv\\xe4st\",\n                    \"text\": \"Kostymv\\xe4st\"\n                }\n            ]\n        },\n        {\n            \"text\": \"Underdelar\",\n            \"children\": [\n                {\n                    \"id\": \"Kjol\",\n                    \"text\": \"Kjol\"\n                },\n                {\n                    \"id\": \"Byxor\",\n                    \"text\": \"Byxor\"\n                },\n                {\n                    \"id\": \"Jeans\",\n                    \"text\": \"Jeans\"\n                },\n                {\n                    \"id\": \"Chinos\",\n                    \"text\": \"Chinos\"\n                },\n                {\n                    \"id\": \"Fritidsbyxor\",\n                    \"text\": \"Fritidsbyxor\"\n                },\n                {\n                    \"id\": \"Tr\\xe4ningsbyxor\",\n                    \"text\": \"Tr\\xe4ningsbyxor\"\n                },\n                {\n                    \"id\": \"Tights\",\n                    \"text\": \"Tights\"\n                },\n                {\n                    \"id\": \"Strumpbyxor\",\n                    \"text\": \"Strumpbyxor\"\n                },\n                {\n                    \"id\": \"Mjukisbyxor\",\n                    \"text\": \"Mjukisbyxor\"\n                },\n                {\n                    \"id\": \"Kostymbyxor\",\n                    \"text\": \"Kostymbyxor\"\n                },\n                {\n                    \"id\": \"Shorts\",\n                    \"text\": \"Shorts\"\n                },\n                {\n                    \"id\": \"Sarong\",\n                    \"text\": \"Sarong\"\n                }\n            ]\n        },\n        {\n            \"text\": \"Helkropp\",\n            \"children\": [\n                {\n                    \"id\": \"Kl\\xe4nning\",\n                    \"text\": \"Kl\\xe4nning\"\n                },\n                {\n                    \"id\": \"Kaftan\",\n                    \"text\": \"Kaftan\"\n                },\n                {\n                    \"id\": \"Kostym\",\n                    \"text\": \"Kostym\"\n                },\n                {\n                    \"id\": \"Set\",\n                    \"text\": \"Set\"\n                },\n                {\n                    \"id\": \"Jumpsuit\",\n                    \"text\": \"Jumpsuit\"\n                },\n                {\n                    \"id\": \"Baddr\\xe4kt\",\n                    \"text\": \"Baddr\\xe4kt\"\n                },\n                {\n                    \"id\": \"Bikini\",\n                    \"text\": \"Bikini\"\n                },\n                {\n                    \"id\": \"Pyjamas\",\n                    \"text\": \"Pyjamas\"\n                },\n                {\n                    \"id\": \"Morgonrock\",\n                    \"text\": \"Morgonrock\"\n                },\n                {\n                    \"id\": \"Br\\xf6llopskl\\xe4nning\",\n                    \"text\": \"Br\\xf6llopskl\\xe4nning\"\n                },\n                {\n                    \"id\": \"Balkl\\xe4nning\",\n                    \"text\": \"Balkl\\xe4nning\"\n                },\n                {\n                    \"id\": \"Bodysuit\",\n                    \"text\": \"Bodysuit\"\n                },\n                {\n                    \"id\": \"Underst\\xe4ll\",\n                    \"text\": \"Underst\\xe4ll\"\n                }\n            ]\n        },\n        {\n            \"text\": \"Ytterkl\\xe4der\",\n            \"children\": [\n                {\n                    \"id\": \"Jacka\",\n                    \"text\": \"Jacka\"\n                },\n                {\n                    \"id\": \"Kappa\",\n                    \"text\": \"Kappa\"\n                },\n                {\n                    \"id\": \"Rock\",\n                    \"text\": \"Rock\"\n                },\n                {\n                    \"id\": \"Fritidsjacka\",\n                    \"text\": \"Fritidsjacka\"\n                },\n                {\n                    \"id\": \"Trenchcoat\",\n                    \"text\": \"Trenchcoat\"\n                },\n                {\n                    \"id\": \"Skinnjacka\",\n                    \"text\": \"Skinnjacka\"\n                },\n                {\n                    \"id\": \"Dunjacka\",\n                    \"text\": \"Dunjacka\"\n                },\n                {\n                    \"id\": \"Regnjacka\",\n                    \"text\": \"Regnjacka\"\n                },\n                {\n                    \"id\": \"P\\xe4lsjacka\",\n                    \"text\": \"P\\xe4lsjacka\"\n                }\n            ]\n        },\n        {\n            \"text\": \"Skor\",\n            \"children\": [\n                {\n                    \"id\": \"Sneakers\",\n                    \"text\": \"Sneakers\"\n                },\n                {\n                    \"id\": \"Sandaler\",\n                    \"text\": \"Sandaler\"\n                },\n                {\n                    \"id\": \"Klackar\",\n                    \"text\": \"Klackar\"\n                },\n                {\n                    \"id\": \"Ballerinaskor\",\n                    \"text\": \"Ballerinaskor\"\n                },\n                {\n                    \"id\": \"Loafers\",\n                    \"text\": \"Loafers\"\n                },\n                {\n                    \"id\": \"Flip-flops\",\n                    \"text\": \"Flip-flops\"\n                },\n                {\n                    \"id\": \"Boots\",\n                    \"text\": \"Boots\"\n                },\n                {\n                    \"id\": \"K\\xe4ngor\",\n                    \"text\": \"K\\xe4ngor\"\n                },\n                {\n                    \"id\": \"Vinterskor\",\n                    \"text\": \"Vinterskor\"\n                },\n                {\n                    \"id\": \"Skor\",\n                    \"text\": \"Annat (Skor)\"\n                }\n            ]\n        },\n        {\n            \"text\": \"V\\xe4skor\",\n            \"children\": [\n                {\n                    \"id\": \"Axelremsv\\xe4ska\",\n                    \"text\": \"Axelremsv\\xe4ska\"\n                },\n                {\n                    \"id\": \"Handv\\xe4ska\",\n                    \"text\": \"Handv\\xe4ska\"\n                },\n                {\n                    \"id\": \"Kuvertv\\xe4ska\",\n                    \"text\": \"Kuvertv\\xe4ska\"\n                },\n                {\n                    \"id\": \"Ryggs\\xe4ck\",\n                    \"text\": \"Ryggs\\xe4ck\"\n                },\n                {\n                    \"id\": \"Tr\\xe4ningsv\\xe4ska\",\n                    \"text\": \"Tr\\xe4ningsv\\xe4ska\"\n                },\n                {\n                    \"id\": \"Resv\\xe4ska\",\n                    \"text\": \"Resv\\xe4ska\"\n                },\n                {\n                    \"id\": \"Datorv\\xe4ska\",\n                    \"text\": \"Datorv\\xe4ska\"\n                },\n                {\n                    \"id\": \"V\\xe4ska\",\n                    \"text\": \"Annat (V\\xe4ska)\"\n                }\n            ]\n        },\n        {\n            \"text\": \"Accessoarer\",\n            \"children\": [\n                {\n                    \"id\": \"Solglas\\xf6gon\",\n                    \"text\": \"Solglas\\xf6gon\"\n                },\n                {\n                    \"id\": \"Glas\\xf6gon\",\n                    \"text\": \"Glas\\xf6gon\"\n                },\n                {\n                    \"id\": \"\\xd6rh\\xe4nge\",\n                    \"text\": \"\\xd6rh\\xe4nge\"\n                },\n                {\n                    \"id\": \"Halsband\",\n                    \"text\": \"Halsband\"\n                },\n                {\n                    \"id\": \"Armband\",\n                    \"text\": \"Armband\"\n                },\n                {\n                    \"id\": \"Ring\",\n                    \"text\": \"Ring\"\n                },\n                {\n                    \"id\": \"Brosch\",\n                    \"text\": \"Brosch\"\n                },\n                {\n                    \"id\": \"Keps\",\n                    \"text\": \"Keps\"\n                },\n                {\n                    \"id\": \"Sjal\",\n                    \"text\": \"Sjal\"\n                },\n                {\n                    \"id\": \"Krage\",\n                    \"text\": \"Krage\"\n                },\n                {\n                    \"id\": \"B\\xe4lte\",\n                    \"text\": \"B\\xe4lte\"\n                },\n                {\n                    \"id\": \"Pl\\xe5nbok\",\n                    \"text\": \"Pl\\xe5nbok\"\n                },\n                {\n                    \"id\": \"Halsduk\",\n                    \"text\": \"Halsduk\"\n                },\n                {\n                    \"id\": \"Hatt\",\n                    \"text\": \"Hatt\"\n                },\n                {\n                    \"id\": \"M\\xf6ssa\",\n                    \"text\": \"M\\xf6ssa\"\n                },\n                {\n                    \"id\": \"Vantar\",\n                    \"text\": \"Vantar\"\n                },\n                {\n                    \"id\": \"Necess\\xe4r\",\n                    \"text\": \"Necess\\xe4r\"\n                },\n                {\n                    \"id\": \"Slips\",\n                    \"text\": \"Slips\"\n                },\n                {\n                    \"id\": \"Handduk\",\n                    \"text\": \"Handduk\"\n                },\n                {\n                    \"id\": \"Klocka\",\n                    \"text\": \"Klocka\"\n                }\n            ]\n        }\n    ];\n    $(\"#itemCategory\").select2({\n        selectionCssClass: \"form-field\",\n        placeholder: \"Kategori\",\n        data: itemCategories\n    });\n    $(\"body\").on(\"click\", \".select2-container--open .select2-results__group\", function() {\n        if ($(this).parent().attr(\"class\").match(/expanded-group/)) $(this).parent().removeClass(\"expanded-group\");\n        else {\n            $(\".expanded-group\").first().removeClass(\"expanded-group\");\n            $(this).parent().addClass(\"expanded-group\");\n        }\n    });\n    let headerAdded = false;\n    $(\"#itemCategory\").on(\"select2:select\", ()=>{\n        analytics.track(\"Click\", {\n            elementID: \"itemCategoryValue\"\n        });\n        document.querySelector(\"#itemCategory\").dispatchEvent(new Event(\"change\"));\n    });\n    let searchClickTracked = false;\n    $(\"#itemCategory\").on(\"select2:open\", ()=>{\n        if (!searchClickTracked) {\n            searchClickTracked = true;\n            $(\"input.select2-search__field\").on(\"click\", ()=>{\n                analytics.track(\"Click\", {\n                    elementID: \"itemCategorySearch\"\n                });\n            });\n        }\n    });\n    $(\"#itemCategory\").on(\"select2:close\", ()=>{\n        document.querySelector(\"body\").style.overflow = \"auto\";\n        document.querySelector(\"body\").style.position = \"static\";\n        document.querySelector(\"html\").style.overflow = \"static\";\n    });\n    $(\"#itemCategory\").on(\"select2:open\", function() {\n        analytics.track(\"Element Viewed\", {\n            elementID: \"itemCategoryContainer\"\n        });\n        document.querySelector(\"body\").style.overflow = \"hidden\";\n        document.querySelector(\"body\").style.position = \"fixed\";\n        document.querySelector(\"html\").style.overflow = \"fixed\";\n        const searchField = document.querySelector(\".select2-search__field\");\n        searchField.placeholder = \"S\\xf6k... (t.ex. Kl\\xe4nning/Sneakers/Blus)\";\n        $(\".select2-search__field\").on(\"input\", (e)=>{\n            if (e.target.value.length > 0) $(\".select2-results__option[role=group]\").each((idx, elm)=>$(elm).addClass(\"expanded-group\"));\n            else $(\".expanded-group\").each((idx, elm)=>$(elm).removeClass(\"expanded-group\"));\n        });\n        if (!headerAdded) {\n            const header = document.getElementById(\"categoryPopUpHeader\");\n            const container = document.querySelector(\".select2-dropdown\");\n            container.insertBefore(header, container.firstChild);\n            header.style.display = \"block\";\n            header.querySelector(\"#categorySelectClose\").onclick = ()=>$(\"#itemCategory\").select2(\"close\");\n            headerAdded = true;\n        }\n        document.querySelector(\".select2-results__options\").addEventListener(\"scroll\", ()=>document.activeElement.blur());\n    });\n    $(\"#itemCategory\").on(\"change\", $c023972b25f99719$var$fieldLabelToggle(\"itemCategoryLabel\"));\n    // From https://github.com/select2/select2/issues/3015#issuecomment-570171720\n    $(\"#itemCategory\").on(\"select2:open\", function() {\n        $(\".select2-results\").css(\"visibility\", \"hidden\");\n    });\n    $(\"#itemCategory\").on(\"select2:opening\", function() {\n        setTimeout(function() {\n            $(\".select2-results\").css(\"visibility\", \"visible\");\n        }, 50);\n    });\n}\nconst $c023972b25f99719$var$BLACK_LIST = [\n    \"se\",\n    \"bild\",\n    \"vet\",\n    \"ej\",\n    \"fl\\xe4tad\",\n    \"klack\",\n    \"\\xf6verdel\",\n    \"grovt\",\n    \"h\\xe4lrem\",\n    \"vind\",\n    \"och\",\n    \"vattent\\xe5lig\",\n    \"utsida\",\n    \"tillverkad\",\n    \"av\",\n    \"woolrichs\",\n    \"signatur\",\n    \"blandning\",\n    \"avslutad\",\n    \"med\",\n    \"en\",\n    \"speciell\",\n    \"teflonbel\\xe4ggning\",\n    \"f\\xf6r\",\n    \"extra\",\n    \"skydd\",\n    \"ankdun\",\n    \"vadderingen\",\n    \"avtagbar\",\n    \"tv\\xe4ttbj\\xf6rnsp\\xe4ls\",\n    \"p\\xe5\",\n    \"luvan\"\n];\nconst $c023972b25f99719$var$blackListSet = new Set($c023972b25f99719$var$BLACK_LIST);\nconst $c023972b25f99719$var$blackListed = (s)=>$c023972b25f99719$var$blackListSet.has(s?.toLowerCase());\nconst $c023972b25f99719$var$partsMatch = (s0, s1)=>{\n    return !$c023972b25f99719$var$blackListed(s0) && !$c023972b25f99719$var$blackListed(s1) && (s0.indexOf(s1) > -1 || s1.indexOf(s0) > -1);\n};\nconst $c023972b25f99719$export$5649c3d7079ff20f = async (source)=>{\n    const getImageMeta = async (url)=>{\n        const img = new Image();\n        img.crossOrigin = \"Anonymous\";\n        img.src = url;\n        await img.decode();\n        return img;\n    };\n    const checkUniformColor = (data)=>{\n        const [r, g, b, a] = [\n            data[0],\n            data[1],\n            data[2],\n            data[3]\n        ];\n        let nonConformingCount = 0;\n        for(let i = 4; i < data.length; i += 4){\n            if (data[i] !== r || data[i + 1] !== g || data[i + 2] !== b || data[i + 3] !== a) return false;\n        }\n        return true;\n    };\n    try {\n        if (source.match(/nobg|no-bg/i)) return true;\n        const img = await getImageMeta(source);\n        const canvas = document.createElement(\"canvas\");\n        const ctx = canvas.getContext(\"2d\");\n        ctx.drawImage(img, 0, 0, img.naturalWidth, img.naturalHeight);\n        const topBorder = ctx.getImageData(0, 0, img.naturalWidth, 10).data;\n        const bottomBorder = ctx.getImageData(0, img.naturalHeight - 10, img.naturalWidth, 10).data;\n        const leftBorder = ctx.getImageData(0, 0, 10, img.naturalHeight).data;\n        const rightBorder = ctx.getImageData(img.naturalWidth - 10, 0, 10, img.naturalHeight).data;\n        return checkUniformColor(topBorder) && checkUniformColor(bottomBorder) && checkUniformColor(leftBorder) && checkUniformColor(rightBorder);\n    } catch (e) {\n        console.error(e);\n        // If we cannot load the image, play it safe and assume it is the no-bg image\n        return true;\n    }\n};\n// Call sellItemMain directly\n$c023972b25f99719$var$sellItemMain();\n// and call sellItemMainAuthenticated after/when a user has logged in\nuser.whenSet($c023972b25f99719$var$sellItemMainAuthenticated);\n\n})();\n//# sourceMappingURL=sellItem.js.map\n","import {\n  capitalizeFirstLetter,\n  enhanceFrontImage,\n  rememberNewItemImageField,\n  requestUniqueId,\n  showDeleteImageIcon, showImagePreview, showImageState, uploadImageAndShowPreview,\n  uploadTempImage\n} from \"./sellItemHelpers\";\n\nfunction defectsChoicesInSwedish() {\n  return new Map().set(\"hole\", \"Hål\").set(\"stain\", \"Fläck\").set(\"lostFit\", \"Tappad passform\").set(\"nopprig\", \"Nopprig\").set(\"threadUp\", \"Trådsläpp\").set(\"colorChange\", \"Färgändring\").set(\"otherDefect\", \"Annat\");\n}\nfunction imageElements() {\n  return [\"frontImage\", \"brandTagImage\", \"defectImage\", \"materialTagImage\", \"extraImage\"];\n}\n\nvar userItemsCount;\n\nfunction imageUploadHandlers() {\n  let frontImageUpload = document.getElementById(\"frontImage\");\n  let brandTagImageUpload = document.getElementById(\"brandTagImage\");\n  let productImageUpload = document.getElementById(\"productImage\");\n  let defectImageUpload = document.getElementById(\"defectImage\");\n  let materialTagImageUpload = document.getElementById(\"materialTagImage\");\n  let extraImageUpload = document.getElementById(\"extraImage\");\n\n  // display image when file has been selected\n  $('#frontImage').off('change');\n  frontImageUpload.addEventListener('change', frontImageChangeHandler, {capture: true});\n  $('#brandTagImage').off('change');\n  brandTagImageUpload.addEventListener('change', brandTagImageChangeHandler, {capture: true});\n  $('#productImage').off('change');\n  productImageUpload.addEventListener('change', productImageChangeHandler, {capture: true});\n  $('#defectImage').off('change');\n  defectImageUpload.addEventListener('change', defectImageChangeHandler, {capture: true});\n  $('#materialTag').off('change');\n  materialTagImageUpload.addEventListener('change', materialTagImageChangeHandler, {capture: true});\n  $('#extraImage').off('change');\n  extraImageUpload.addEventListener('change', extraImageChangeHandler, {capture: true});\n}\n\nasync function sellItemMainAuthenticated() {\n  console.log(\"sellItemMainAuthenticated \" + new Date());\n\n  // Visa alla \"viktiga\" fält om man är inloggad\n  toggleMoreInfoFields.click();\n\n  // Create item from sessionStorage\n  if (sessionStorage.getItem('itemToBeCreatedAfterSignIn')) {\n    // ... if we are redirected here from the sign-in page\n    if (document.referrer.includes('/sign-in')) {\n      document.getElementById('loadingDiv').style.display = 'flex';\n      document.getElementById('creatingItemText').style.display = 'block';\n      await createItemAfterSignIn();\n      const shippingMethod = sessionStorage.getItem('shippingMethod');\n      if (shippingMethod) {\n        await firebase.app().functions(\"europe-west1\").httpsCallable('updateFirebaseUser')({ preferences: { shippingMethod } });\n      }\n      const userPhoneSet = user.current?.phoneNumber?.length;\n      return location.href = userPhoneSet ? '/item-confirmation' : '/user-contact';\n    } else {\n      // otherwise make sure to remove any previously saved item as a precaution\n      sessionStorage.removeItem('itemToBeCreatedAfterSignIn');\n    }\n  }\n\n  // Get user's item count to be able to send 'User Activated' event\n  const items = await getItems(authUser.current.uid);\n  userItemsCount = items.size;\n}\n\nasync function sellItemMain() {\n  localStorage.removeItem('latestItemCreated');\n  sessionStorage.removeItem('itemValuation');\n\n  // Initial state\n  imageUploadHandlers();\n  setupModelSearchEventListeners();\n  initializeSelectColor();\n  initializeInputEventListeners();\n  autocomplete(document.getElementById(\"itemBrand\"), brands);\n\n  // Hide/Show warning about difficulty to sell certain brands\n  let brand = document.getElementById(\"itemBrand\");\n  let hardToSellDiv = document.getElementById(\"hardToSellDiv\");\n  let words = [\"H&M\", \"HM\", \"Zara\", \"ASOS\", \"Nelly\", \"Gina Tricot\", \"BikBok\", \"Bik Bok\", \"Lindex\", \"Kappahl\", \"Cubus\", \"NA-KD\", \"NAKD\", \"Mango\", \"Ellos\", \"Primark\", \"Shein\", \"Vila\", \"Forever 21\", \"Pull & Bear\", \"Bershka\", \"Stradivarius\", \"Okänt\", \"Unknown\", \"Vet ej\", \"...\", \"Vet inte\", \"Okänd\", \"-\", \"Se bild\"];\n\n  brand.oninput = function () {\n    shareSoldDiv.style.display = 'none';\n    let value = this.value;\n    if (!checkBrand(value)) {\n      //checkAndDisplayShareSold(value);\n      //displayFindModelDiv(value);\n    }\n  };\n\n  // Hide/Show extra fields for defects\n  itemCondition.onchange = function () {\n    let input = this.value;\n    if (input == \"Använd, tecken på slitage\") {\n      defectInfoDiv.style.display = 'block';\n      itemCondition.style.color = \"#333\";\n    } else if (input == \"\") {\n      defectInfoDiv.style.display = 'none';\n      itemCondition.style.color = \"#929292\";\n    } else {\n      defectInfoDiv.style.display = 'none';\n      itemCondition.style.color = \"#333\";\n    }\n  };\n\n  personalId.addEventListener(\"input\", () => {\n    const error = isValidSwedishSsn(personalId.value) ? '' : 'Ogiltigt personnummer';\n    personalId.setCustomValidity(error);\n  })\n\n  await initializeCategorySelect();\n  await initializeColorConfirm();\n  await initializeBrandConfirm();\n  await initializeMaterialConfirm();\n  await initializeSizeConfirm();\n  initializeSuggestButtonsSaveState();\n  initializeClearFormButton();\n\n  initializeDeleteImageListeners();\n  document.getElementById('clearItemForm').addEventListener('click', clearFormFields);\n\n  if (params.id) {\n    // Fill form if the user comes from a prefill link (re-sell item)\n    sessionStorage.removeItem('newItemId');\n    localStorage.removeItem('newItem');\n    auth.onAuthStateChanged(function (user) {\n      if (!user) { document.getElementById('maiIntro').style.display = 'block'; }\n    });\n    document.getElementById('resellIntro').style.display = 'block';\n    await fillForm(params.id);\n    document.getElementById(\"triggerShowSellItemContent\").click();\n  } else if (sessionStorage.getItem('itemToBeCreatedAfterSignIn') && document.referrer.includes('/sign-in')) {\n    // A new item will be created in sellItemMainAuthenticated\n  } else if (localStorage.getItem('newItem') && !isDefaultFormState(JSON.parse(localStorage.getItem('newItem')))) {\n    // Saved state from a previous visit to /sell-item - restore the data\n    const newItem = JSON.parse(localStorage.getItem('newItem'));\n    document.getElementById(\"frontImage\").required = true;\n    document.getElementById(\"brandTagImage\").required = true;\n    await fillForm(null, newItem, true);\n    document.getElementById('clearItemForm').style.display = 'block';\n    document.getElementById(\"triggerShowSellItemContent\").click();\n  } else {\n    document.getElementById(\"triggerShowSellItemContent\").click();\n    document.getElementById(\"frontImage\").required = true;\n    document.getElementById(\"brandTagImage\").required = true;\n  }\n  initializeSaveStateListeners();\n  initializeRestoreOnNavigation();\n}\n\nasync function addItem(event) {\n  const id = sessionStorage.getItem('newItemId') || await requestUniqueId();\n  try {\n    document.getElementById('addItemFormDiv').style.display = 'none';\n    document.getElementById('loadingDiv').style.display = 'flex';\n    document.getElementById('clearItemForm').style.display = 'none';\n    const item = await addItemInner(id);\n    const nextStep = await getAndSaveMlValuation(id, item.preferences.userValuationApproval);\n    // Track with segment 'User Activated'\n    if (userItemsCount === 0) {\n      analytics.track('User Activated');\n    }\n    location.href = nextStep;\n  } catch (e) {\n    errorHandler.report(e);\n    console.error('addItem failed', e);\n  }\n}\n\nfunction needsHumanCheck({ humanCheckNeeded, newMinMaxLog }) {\n  return humanCheckNeeded || newMinMaxLog.match(/accept price is above max/i)\n}\n\nasync function saveItemValuation(itemId, mlValuationData, userValuationApproval) {\n  const { minPrice, maxPrice, decline, humanCheckNeeded, humanCheckExplanation, willNotSell, soldPrice, version,\n    newMinPriceEstimate, newMaxPriceEstimate, newMinMaxLog, adjustmentAllowed, newBrand, newBrandCategory } = mlValuationData || {};\n  if (!minPrice && !decline) {\n    return;\n  }\n  const valuationData = {\n    mlValuation: {\n      decline, humanCheckNeeded, minPriceEstimate: minPrice, maxPriceEstimate: maxPrice,\n      humanCheckExplanation: humanCheckExplanation,\n      willNotSellPrediction: willNotSell,\n      soldPriceEstimate: soldPrice,\n      modelVersion: version?.toString(),\n      newMinPriceEstimate, newMaxPriceEstimate, newMinMaxLog, adjustmentAllowed, newBrand, newBrandCategory\n    },\n    ...(decline || needsHumanCheck(mlValuationData) ? {} : {\n      valuationStatus: 'Completed',\n      valuationDate: new Date().toISOString(),\n      ...(userValuationApproval ? {} : { minPriceEstimate: minPrice, maxPriceEstimate: maxPrice }),\n      infoRequests: {\n        price: {\n          status: userValuationApproval ? 'Active' : 'Resolved',\n          response: userValuationApproval ? '' : 'Accepted',\n          description: 'Vi börjar med startpriset, och justerar successivt ner till lägsta priset under säljperioden på 30 dagar. Värderingen utgår från vad liknande sålts för.',\n          minPrice: newMinPriceEstimate || minPrice,\n          maxPrice: newMaxPriceEstimate || maxPrice,\n        }\n      }\n    })\n  }\n  if (sessionStorage.getItem('itemToBeCreatedAfterSignIn')) {\n    const item = JSON.parse(sessionStorage.getItem('itemToBeCreatedAfterSignIn'));\n    sessionStorage.setItem('itemToBeCreatedAfterSignIn', JSON.stringify({\n      id: item.id,\n      item: { ...item.item, ...valuationData }\n    }));\n  } else {\n    await firebase.app().functions(\"europe-west1\").httpsCallable('saveItemValuationFields')({ itemId, ...valuationData });\n    const latestItemCreated = JSON.parse(localStorage.getItem('latestItemCreated'));\n    localStorage.setItem('latestItemCreated', JSON.stringify({ ...latestItemCreated, ...valuationData }));\n  }\n}\n\nasync function getAndSaveMlValuation(itemId, userValuationApproval) {\n  const item = JSON.parse(sessionStorage.getItem('itemToBeCreatedAfterSignIn') || '{}').item;\n  if (!itemId && !item) {\n    console.error('No item and no itemId, unexpected!!');\n    return '/item-confirmation';\n  }\n  try {\n    const res = await firebase.app().functions(\"europe-west1\").httpsCallable('itemMlValuation')({itemId, item});\n    const { minPrice, maxPrice, decline } = res.data || {};\n    await saveItemValuation(itemId, res.data, userValuationApproval);\n    return nextStepAfterMlValuation(minPrice && maxPrice, decline, needsHumanCheck(res.data), userValuationApproval);\n  } catch (e) {\n    console.error('Failed to get ml valuation', e);\n  }\n  return nextStepAfterMlValuation();\n}\n\nfunction nextStepAfterMlValuation(mlValuationPresent, decline, valuationNeedsChecking, userValuationApproval) {\n  if (!mlValuationPresent || valuationNeedsChecking || !userValuationApproval) {\n    if (sessionStorage.getItem('itemToBeCreatedAfterSignIn')) {\n      return '/sign-in';\n    }\n    const userPhoneSet = user.current?.phoneNumber?.length;\n    return userPhoneSet ? '/item-confirmation' : '/user-contact';\n  }\n  return '/item-valuation';\n}\n\nfunction defaultFormState() {\n  return {\n    acceptPrice: null,\n    age: null,\n    brand: null,\n    category: null,\n    color: null,\n    condition: null,\n    defectDescription: null,\n    defects: [],\n    images: {},\n    material: null,\n    model: null,\n    originalPrice: null,\n    userValuationApproval: true,\n    sex: \"Woman\",\n    size: null,\n    userComment: null,\n  }\n}\n\nfunction collect() {\n  let sex = \"\";\n  const now = new Date();\n  let status = \"New\";\n  let shippingStatus = \"Not sent\";\n  const size = itemSize.value;\n  const material = itemMaterial.value ? itemMaterial.value.trim() : \"\";\n  const brand = itemBrand.value ? itemBrand.value.trim() : \"\";\n  const model = itemModel.value ? itemModel.value.trim() : \"\";\n  const originalPrice = Number(itemOriginalPrice.value);\n  const age = itemAge.value;\n  const condition = itemCondition.value;\n  const defectDescription = itemDefectDescription.value ? itemDefectDescription.value.trim() : \"\";\n  const userComment = itemUserComment.value ? itemUserComment.value.trim() : \"\";\n  const acceptPrice = Number(itemLowestAcceptPrice.value);\n  const userValuationApproval = itemUserValuationApproval.checked;\n\n  // Get defects list\n  let defectElements = new Map().set(\"hole\", hole.checked).set(\"stain\", stain.checked).set(\"lostFit\", lostFit.checked).set(\"nopprig\", nopprig.checked).set(\"threadUp\", threadUp.checked).set(\"colorChange\", colorChange.checked).set(\"otherDefect\", otherDefect.checked);\n  let defects = [];\n  if (condition === 'Använd, tecken på slitage') {\n    defectElements.forEach((value, key) => {\n      if (value) {\n        let string = defectsChoicesInSwedish().get(key);\n        defects.push(string);\n      }\n    });\n  }\n\n\n  // Get radio buttons\n  var sexRadioButtons = document.getElementsByName(\"Sex\");\n  for (var x = 0; x < sexRadioButtons.length; x++) {\n    if (sexRadioButtons[x].checked) {\n      sex = sexRadioButtons[x].id;\n    }\n  }\n\n  const modelBoxFilled = document.getElementById('findModelBoxFilled');\n  let modelVariantFields = {};\n  if (modelBoxFilled.style.display === 'flex') {\n    // There is a current model selected grab the cover image and id from it\n    const modelData = JSON.parse(modelBoxFilled.getAttribute('data-model'));\n    modelVariantFields = {\n      modelCoverImageUrl: modelData['coverImage'],\n      atModelVariantId: modelData['atVariantId'],\n    }\n  }\n\n  const images = JSON.parse(localStorage.getItem('newItem') || '{}').images\n\n  return {\n    user: authUser.current?.uid || null,\n    createdAt: now.toISOString(),\n    status,\n    shippingStatus,\n    sex,\n    size,\n    material,\n    color: itemColor.value,\n    category: itemCategory.value,\n    brand,\n    model,\n    originalPrice,\n    age,\n    condition,\n    defects,\n    defectDescription,\n    userComment,\n    acceptPrice,\n    preferences: { userValuationApproval },\n    ...modelVariantFields,\n    images,\n  };\n}\n\nasync function getShippingMethod() {\n  // If first time: User chooses shipping method preference in sell item form\n  let shippingMethod = 'Service point';\n  if (!user.current?.preferences?.shippingMethod) {\n    if (authUser.current) {\n      await firebase.app().functions(\"europe-west1\").httpsCallable('updateFirebaseUser')({ preferences: { shippingMethod } });\n    } else {\n      sessionStorage.setItem('shippingMethod', shippingMethod);\n    }\n  } else {\n    shippingMethod = user.current?.preferences?.shippingMethod;\n  }\n  return shippingMethod;\n}\n\nasync function addItemInner(id) {\n  const { modelCoverImageUrl, images, ...pageData } = collect();\n  const shippingMethod = await getShippingMethod();\n  if (modelCoverImageUrl) {\n    images['coverImage'] = modelCoverImageUrl;\n    pageData['coverImageUpdatedAt'] = new Date().toISOString();\n  }\n  const createdFromItem = params.id ? { createdFromItem: params.id } : {};\n  const item = { ...pageData, shippingMethod, images, ...createdFromItem, version: \"2\" };\n\n  if (!authUser.current) {\n    sessionStorage.setItem('itemToBeCreatedAfterSignIn', JSON.stringify({ id, item }));\n  } else {\n    const createItemResponse = await firebase.app().functions(\"europe-west1\").httpsCallable('createItem')({ id, item });\n    localStorage.removeItem('newItem');\n    sessionStorage.removeItem('newItemId');\n    localStorage.setItem('latestItemCreated', JSON.stringify(createItemResponse.data));\n  }\n  return item;\n}\n\nfunction initializeInputEventListeners() {\n  itemBrand.addEventListener('input', fieldLabelToggle('itemBrandLabel'));\n  itemBrand.addEventListener('input', clearConfirmButtonValidity);\n  itemModel.addEventListener('input', fieldLabelToggle('itemModelLabel'));\n  itemSize.addEventListener('input', fieldLabelToggle('itemSizeLabel'));\n  itemSize.addEventListener('input', clearConfirmButtonValidity);\n  itemMaterial.addEventListener('input', fieldLabelToggle('itemMaterialLabel'));\n  itemMaterial.addEventListener('input', clearConfirmButtonValidity);\n  itemOriginalPrice.addEventListener('input', fieldLabelToggle('itemOriginalPriceLabel'));\n  itemAge.addEventListener('input', fieldLabelToggle('itemAgeLabel'));\n  itemCondition.addEventListener('input', fieldLabelToggle('itemConditionLabel'));\n  itemColor.addEventListener('change', fieldLabelToggle('itemColorLabel'));\n  itemColor.addEventListener('input', clearConfirmButtonValidity);\n  itemUserComment.addEventListener('input', fieldLabelToggle('userCommentLabel'));\n\n  document.getElementById('addItemButton').addEventListener('click', () => {\n    document.getElementById('wf-form-Add-Item').reportValidity();\n    const invalidElements = document.getElementById('wf-form-Add-Item').querySelectorAll(':invalid');\n    const element = invalidElements?.[0];\n    if (element && element.getBoundingClientRect().height <= 1) {\n      element.style.cssText = 'width:100% !important;height:100% !important;'\n    }\n    setTimeout(() => {\n      if (invalidElements.length > 0) {\n        if (!isElementInView(element)) {\n          const y = element.getBoundingClientRect().top + window.scrollY - 40;\n          window.scrollTo({ top: y, behavior: 'smooth'});\n        }\n        document.getElementById('wf-form-Add-Item').reportValidity();\n      }\n    }, 300);\n  });\n  addItemForm.addEventListener(\"submit\", addItem);\n  userAddressForm.addEventListener(\"submit\", addUserDetails);\n\n}\n\nfunction isElementInView (el) {\n  if (typeof jQuery === \"function\" && el instanceof jQuery) {\n    el = el[0];\n  }\n  const rect = el.getBoundingClientRect();\n  return (\n      rect.top >= 0 &&\n      rect.left >= 0 &&\n      rect.bottom <= (window.innerHeight/2 || document.documentElement.clientHeight) &&\n      rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n  );\n}\n\nasync function createItemAfterSignIn() {\n  const itemFromStorage = JSON.parse(sessionStorage.getItem('itemToBeCreatedAfterSignIn'));\n  sessionStorage.removeItem('itemToBeCreatedAfterSignIn');\n  sessionStorage.removeItem('newItemId');\n  await firebase.app().functions(\"europe-west1\").httpsCallable('createItem')(itemFromStorage);\n  localStorage.removeItem('newItem');\n  itemFromStorage.item.id = itemFromStorage.id;\n  localStorage.setItem('latestItemCreated', JSON.stringify(itemFromStorage.item));\n}\n\nfunction rememberUnsavedChanges() {\n  if (localStorage.getItem('latestItemCreated')) {\n    return;\n  }\n  const {\n    user, createdAt, status, shippingStatus, modelVariantFields, ...itemToSave\n  } = collect();\n  // Replace '' with null values\n  const item = Object.keys(itemToSave).reduce((acc, key) => {\n    acc[key] = itemToSave[key] === '' ? null : itemToSave[key];\n    return acc;\n  }, {});\n  item.defects = item.defects ? item.defects : [];\n  item.userValuationApproval = item.preferences.userValuationApproval;\n  delete item.preferences;\n  item.acceptPrice = item.acceptPrice && item.acceptPrice > 0 ? item.acceptPrice : null;\n  item.originalPrice = item.originalPrice && item.originalPrice > 0 ? item.originalPrice : null;\n  [ 'itemBrand', 'itemSize', 'itemMaterial', 'itemColor' ].forEach(inputName => {\n    const suggestButtons = document.getElementById(inputName).parentNode.querySelector('.suggest-buttons') ||\n      document.getElementById(inputName).parentNode.parentNode.querySelector('.suggest-buttons');\n    if (suggestButtons?.style?.display === 'block') {\n      item[`${inputName}Confirm`] = true;\n    }\n  })\n  if (!isDefaultFormState(item)) {\n    localStorage.setItem('newItem', JSON.stringify(item));\n  } else {\n    localStorage.removeItem('newItem');\n  }\n}\n\nfunction isDefaultFormState(itemState) {\n  const defaultState = defaultFormState();\n  for (const field in defaultState) {\n    if (!(field in itemState)) {\n      continue;\n    }\n    if (defaultState[field] instanceof Object) {\n      if (JSON.stringify(defaultState[field]) !== JSON.stringify(itemState[field])) {\n        return false\n      }\n      continue;\n    }\n    if (itemState[field] !== defaultState[field]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction fieldLabelToggle(labelId) {\n  return (event) => {\n    document.getElementById(labelId).style.display = event.target.value.length > 0 ? 'inline-block' : 'none'\n  }\n}\n\nfunction showSuggestButtons(fieldName, restoreSavedState, showConfirmation) {\n  if (restoreSavedState && showConfirmation) {\n    const suggestButtons = document.getElementById(fieldName).parentNode.querySelector('.suggest-buttons') ||\n      document.getElementById(fieldName).parentNode.parentNode.querySelector('.suggest-buttons');\n    suggestButtons.style.display = 'block';\n    document.getElementById(fieldName).setCustomValidity('Bekräfta eller ändra värdet');\n  }\n}\n\nasync function fillForm(itemId, savedItem = null, restoreSavedState = false) {\n  try {\n    let item = { data: savedItem };\n    if (!savedItem) {\n      item = await firebase.app().functions(\"europe-west1\").httpsCallable('getItem')({ itemId });\n    }\n    const data = item.data;\n    const images = data.images || {};\n    let originalPrice = data.originalPrice;\n    if (originalPrice <= 0) {\n      originalPrice = null;\n    }\n\n    // Populate images\n    for (const imageName in images) {\n      let urlSmall = images[`${imageName}Small`] || images[`${imageName}Medium`] || images[imageName] || images[`${imageName}Large`];\n      let urlLarge = images[imageName] || images[`${imageName}Large`] || images[`${imageName}Medium`] || images[`${imageName}Small`];\n      if (imageElements().includes(imageName)) {\n        rememberNewItemImageField(imageName, urlLarge, urlSmall);\n        if (imageName === 'frontImage' && images.enhancedFrontImage) {\n          urlSmall = images['enhancedFrontImageSmall'] || images['enhancedFrontImageMedium'] || images['enhancedFrontImage'] || images['enhancedFrontImageLarge'];\n          urlLarge = images['enhancedFrontImage'] || images['enhancedFrontImageLarge'] || images['enhancedFrontImageMedium'] || images['enhancedFrontImageSmall'];\n          rememberNewItemImageField('enhancedFrontImage', urlLarge, urlSmall);\n        }\n        showImagePreview(imageName, urlSmall);\n        showImageState(imageName, 'success-state');\n        document.getElementById(imageName).required = false;\n      }\n    }\n\n    // Show cover image preview if it is a model image, if it is a noBg image we skip it\n    sessionStorage.removeItem('coverImagePreviewUrl');\n    const coverImageLarge = images.coverImageLarge || images.coverImage || null;\n    const coverImageSmall = images.coverImage || images.coverImageLarge || null;\n    if (coverImageLarge && !(await isNoBgImage(coverImageSmall))) {\n      document.getElementById('coverImageContainer').style.backgroundImage = `url('${coverImageSmall}')`;\n      document.getElementById('coverImagePreview').style.display = 'block';\n      rememberNewItemImageField('modelImage', coverImageLarge, coverImageSmall);\n    }\n\n    // Populate text input fields\n    itemBrand.value = data.brand || '';\n    showSuggestButtons('itemBrand', restoreSavedState, data.itemBrandConfirm);\n    // Don't use the setFieldValue for the brand since that triggers a dropdown to open\n    document.getElementById('itemBrandLabel').style.display = data.brand ? 'inline-block' : 'none';\n    setFieldValue('itemSize', data.size);\n    showSuggestButtons('itemSize', restoreSavedState, data.itemSizeConfirm);\n    setFieldValue('itemMaterial', data.material);\n    showSuggestButtons('itemMaterial', restoreSavedState, data.itemMaterialConfirm);\n    setFieldValue('itemModel', data.model);\n    setFieldValue('itemOriginalPrice', originalPrice);\n\n    if (restoreSavedState) {\n      setFieldValue('itemUserComment', data.userComment);\n      setFieldValue('itemDefectDescription', data.defectDescription);\n      setFieldValue('itemLowestAcceptPrice', data.acceptPrice <= 0 ? null : data.acceptPrice);\n    }\n\n    // Populate select fields\n    selectFieldValue(itemAge, data.age);\n    selectFieldValue(itemColor, data.color);\n    showSuggestButtons('itemColor', restoreSavedState, data.itemColorConfirm);\n    selectFieldValue(itemCondition, data.condition);\n    if (itemCondition.selectedIndex >= 0 && itemCondition.options[itemCondition.selectedIndex].text === \"Använd, tecken på slitage\") {\n      defectInfoDiv.style.display = 'block';\n    }\n    const itemCategory = $('#itemCategory');\n    itemCategory.val(data.category);\n    itemCategory.trigger('change');\n\n    // Populate radio-buttons\n    if (data.sex) {\n      document.getElementById('Woman').previousElementSibling.classList.remove(\"w--redirected-checked\"); // Unselect radio button 'Woman'\n      document.getElementById('Woman').checked = false;\n      document.getElementById(data.sex).previousElementSibling.classList.add(\"w--redirected-checked\"); // Populate the right one\n      document.getElementById(data.sex).checked = true;\n    } else {\n      document.getElementById('Woman').previousElementSibling.classList.add(\"w--redirected-checked\"); // Unselect radio button 'Woman'\n      document.getElementById('Woman').checked = true;\n    }\n\n    // Populate checkboxes\n    defectsChoicesInSwedish().forEach((value, key) => {\n      if (data.defects && data.defects.includes(value)) {\n        document.getElementById(key).previousElementSibling.classList.add(\"w--redirected-checked\");\n        document.getElementById(key).checked = true;\n      }\n    });\n    if (restoreSavedState) {\n      if ('userValuationApproval' in data && !data.userValuationApproval) {\n        document.getElementById('itemUserValuationApproval').click();\n        document.getElementById('itemUserValuationApproval').previousElementSibling.classList.remove(\"w--redirected-checked\");\n      }\n    }\n  } catch (error) {\n    console.error(\"Error getting item document:\", error);\n    errorHandler.report(error);\n  }\n  document.getElementById('loadingDiv').style.display = 'none';\n}\n\nfunction selectFieldValue(field, value) {\n  const selectIndex = Array.from(field.options)\n    .map(elm => elm.attributes.value.value)\n    .indexOf(value);\n  if (selectIndex > 0) {\n    field.selectedIndex = selectIndex;\n    field.style.color = \"#333\";\n  } else {\n    field.selectedIndex = 0;\n    field.style.color = '#929292';\n  }\n  field.dispatchEvent(new Event('input'));\n  field.dispatchEvent(new Event('change'));\n}\n\nfunction checkBrand(value) {\n  if (words.some(words => value.toLowerCase().includes(words.toLowerCase()))) {\n    hardToSellText.innerHTML = `Vi säljer i regel inte ${value}-plagg på grund av för lågt andrahandsvärde. Undantag kan finnas.`;\n    hardToSellDiv.style.display = 'block';\n    return true;\n  } else {\n    hardToSellDiv.style.display = 'none';\n  }\n}\n\nasync function checkAndDisplayShareSold(value) {\n  const response = await firebase.app().functions(\"europe-west1\").httpsCallable(\n    'fetchBrandShareSoldInfo',\n  )({ cleanedBrandName: value });\n\n  if (response.data && response.data.cleanedBrand) {\n    console.log('data.shareSold', response.data.shareSold, 'data.cleanedBrand', response.data.cleanedBrand);\n    if (response.data.shareSold >= '65%') {\n      shareSoldText.innerHTML = `Det är hög efterfrågan på ${response.data.cleanedBrand}`;\n      shareSoldDiv.style.display = 'block';\n      return;\n    }\n  } else {\n    shareSoldText.innerHTML = '';\n    shareSoldDiv.style.display = 'none';\n  }\n}\n\nfunction initializeSelectColor() {\n  const itemColor = document.getElementById(\"itemColor\");\n  itemColor.onchange = function () {\n    let input = this.value;\n    if (input !== \"\") {\n      itemColor.style.color = \"#333\";\n    } else {\n      itemColor.style.color = \"#929292\";\n    }\n  };\n  // Change font color of dropdown itemAge when user selects a value\n  const itemAge = document.getElementById(\"itemAge\");\n  itemAge.onchange = function () {\n    let input = this.value;\n    if (input !== \"\") {\n      itemAge.style.color = \"#333\";\n    } else {\n      itemAge.style.color = \"#929292\";\n    }\n  };\n}\n\nconst apiColorMapping = {\n  \"black\": \"Black\",\n  \"white\": \"White\",\n  \"gray\": \"Grey\",\n  \"blue\": \"Blue\",\n  \"dark_blue\": \"Navy\",\n  \"multicolor/colorful\": 'Multicolour',\n  \"red\": \"Red\",\n  \"pink\": \"Pink\",\n  \"brown\": \"Brown\",\n  \"beige\": \"Beige\",\n  \"light_blue\": \"Blue\",\n  \"green\": \"Green\",\n  \"silver\": \"Silver\",\n  \"purple\": \"Purple\",\n  \"maroon\": \"Burgundy\",\n  \"gold\": \"Gold\",\n  \"orange\": \"Orange\",\n  \"yellow\": \"Yellow\",\n  \"teal\": \"Turquoise\",\n  \"olive\": \"Green\",\n  \"cyan\": \"Turquoise\",\n  \"magenta\": \"Pink\",\n  \"mustard\": \"Yellow\"\n};\n\nasync function frontImageChangeHandler(event) {\n  let input = this.files[0];\n  if (input) {\n    event.stopPropagation();\n    const imageUrl = await uploadImageAndShowPreview(input, 'frontImage');\n    if (!imageUrl || Object.keys(imageUrl).length === 0) {\n      return;\n    }\n    const promises = [];\n    promises.push(detectAndFillColor(imageUrl), detectAndFillBrandAndMaterialAndSize(imageUrl), enhanceFrontImage(imageUrl));\n    await Promise.all(promises);\n    rememberUnsavedChanges();\n  }\n}\n\nasync function brandTagImageChangeHandler(event) {\n  let input = this.files[0];\n  if (input) {\n    event.stopPropagation();\n    const imageUrl = await uploadImageAndShowPreview(input, 'brandTagImage');\n    showDeleteImageIcon('brandTagImage')\n    await detectAndFillBrandAndMaterialAndSize(imageUrl);\n    rememberUnsavedChanges();\n  }\n}\n\nasync function productImageChangeHandler(event) {\n  let input = this.files[0];\n  if (input) {\n    event.stopPropagation();\n    const imageUrl = await uploadImageAndShowPreview(input, 'productImage');\n    showDeleteImageIcon('productImage')\n    await detectAndFillBrandAndMaterialAndSize(imageUrl);\n    rememberUnsavedChanges();\n  }\n}\n\nasync function defectImageChangeHandler(event) {\n  let input = this.files[0];\n  if (input) {\n    event.stopPropagation();\n    const imageUrl = await uploadImageAndShowPreview(input, 'defectImage');\n    showDeleteImageIcon('defectImage')\n    await detectAndFillBrandAndMaterialAndSize(imageUrl);\n    rememberUnsavedChanges();\n  }\n}\n\nasync function materialTagImageChangeHandler(event) {\n  let input = this.files[0];\n  if (input) {\n    event.stopPropagation();\n    const imageUrl = await uploadImageAndShowPreview(input, 'materialTagImage');\n    showDeleteImageIcon('materialTagImage')\n    await detectAndFillBrandAndMaterialAndSize(imageUrl);\n    rememberUnsavedChanges();\n  }\n}\n\nasync function extraImageChangeHandler(event) {\n  let input = this.files[0];\n  if (input) {\n    event.stopPropagation();\n    const imageUrl = await uploadImageAndShowPreview(input, 'extraImage');\n    showDeleteImageIcon('extraImage')\n    await detectAndFillBrandAndMaterialAndSize(imageUrl);\n    rememberUnsavedChanges();\n  }\n}\n\nfunction clearConfirmButtonValidity(event) {\n  event.currentTarget.setCustomValidity('');\n  const suggestButtons = event.currentTarget.parentNode.querySelector('.suggest-buttons') ||\n      event.currentTarget.parentNode.parentNode.querySelector('.suggest-buttons');\n  suggestButtons.style.display = 'none';\n}\n\nasync function detectAndFillBrandAndMaterialAndSize(imageUrl) {\n  try {\n    if (document.querySelector('#itemBrand').value.length && document.querySelector('#itemMaterial').value.length\n      && document.querySelector('#itemSize').value.length) {\n      // Don't do anything if both brand and material already filled in\n      return;\n    }\n    const response = await firebase.app().functions(\"europe-west1\").httpsCallable('detectItemBrandAndMaterialAndSize')({ imageUrl });\n    if (!document.querySelector('#itemBrand').value.length && response.data?.brand) {\n      document.querySelector('#itemBrand').value = response.data.brand;\n      document.querySelector('#itemBrand').setCustomValidity('Bekräfta eller ändra märket');\n      document.getElementById('itemBrandLabel').style.display = 'inline-block';\n      document.querySelector('#brandSuggestButtons').style.display = 'block';\n      document.querySelector('#itemBrand').dispatchEvent(new Event('change'));\n      analytics.track(\"Element Viewed\", { elementID: \"brandSuggestButtons\" });\n    }\n    if (!document.querySelector('#itemMaterial').value.length && response.data?.materials) {\n      document.querySelector('#itemMaterial').value = response.data.materials;\n      document.querySelector('#itemMaterial').setCustomValidity('Bekräfta eller ändra materialet');\n      document.getElementById('itemMaterialLabel').style.display = 'inline-block';\n      document.querySelector('#materialSuggestButtons').style.display = 'block';\n      document.querySelector('#itemMaterial').dispatchEvent(new Event('change'));\n      analytics.track(\"Element Viewed\", { elementID: \"materialSuggestButtons\" });\n    }\n    if (!document.querySelector('#itemSize').value.length && response.data?.size) {\n      document.querySelector('#itemSize').value = response.data.size;\n      document.querySelector('#itemSize').setCustomValidity('Bekräfta eller ändra storlek');\n      document.getElementById('itemSizeLabel').style.display = 'inline-block';\n      document.querySelector('#sizeSuggestButtons').style.display = 'block';\n      document.querySelector('#itemSize').dispatchEvent(new Event('change'));\n      analytics.track(\"Element Viewed\", { elementID: \"sizeSuggestButtons\" });\n    }\n  } catch (e) {\n    errorHandler.report(e);\n    console.log('Error calling detectItemBrandAndMaterialAndSize', e);\n  }\n}\n\nasync function detectAndFillColor(imageUrl) {\n  try {\n    const response = await firebase.app().functions(\"europe-west1\").httpsCallable('detectItemColor')({ imageUrl });\n    if (!response.data?.colors || !response.data.colors.length) {\n      console.log(\"Unable to detect product color\");\n      return;\n    }\n    if (response.data.colors.length > 2) {\n      document.querySelector('#itemColor').value = 'Multicolour';\n    } else if (apiColorMapping[response.data.colors?.[0]]) {\n      document.querySelector('#itemColor').value = apiColorMapping[response.data.colors?.[0]];\n    } else {\n      console.log(\"Unable to set color from\", response.data.colors?.[0]);\n      return;\n    }\n    document.querySelector('#itemColor').setCustomValidity('Bekräfta eller ändra färgen');\n    document.querySelector('#colorSuggestButtons').style.display = 'block';\n    document.querySelector('#itemColor').dispatchEvent(new Event('change'));\n    analytics.track(\"Element Viewed\", { elementID: \"colorSuggestButtons\" });\n  } catch (e) {\n    errorHandler.report(e);\n    console.log('Error calling detectItemColor', e);\n  }\n}\n\nasync function initializeMaterialConfirm() {\n  document.getElementById('rejectMaterial').addEventListener('click', () => {\n    document.querySelector('#itemMaterial').value = '';\n    document.querySelector('#materialSuggestButtons').style.display = 'none';\n    fieldLabelToggle('itemMaterialLabel');\n    document.querySelector('#itemMaterial').setCustomValidity('')\n  });\n  document.getElementById('confirmMaterial').addEventListener('click', () => {\n    document.querySelector('#itemMaterial').setCustomValidity('');\n  })\n}\n\nasync function initializeBrandConfirm() {\n  document.getElementById('rejectBrand').addEventListener('click', () => {\n    document.querySelector('#itemBrand').value = '';\n    document.querySelector('#brandSuggestButtons').style.display = 'none';\n    document.querySelector('#itemBrand').setCustomValidity('');\n    fieldLabelToggle('itemBrandLabel');\n  });\n  document.getElementById('confirmBrand').addEventListener('click', () => {\n    document.querySelector('#itemBrand').setCustomValidity('');\n    document.querySelector('#itemBrand').setCustomValidity('');\n  })\n}\n\nfunction initializeClearFormButton() {\n  function showButtonIfFormChanged(event) {\n    let field = event.target;\n    if (field instanceof Element) {\n      const defaultValue = defaultFormState()[field.name];\n      if (defaultValue !== field.value && field.value !== '') {\n        document.getElementById('clearItemForm').style.display = 'block';\n      }\n    }\n  }\n  document.getElementById('wf-form-Add-Item').addEventListener('input', showButtonIfFormChanged);\n  document.querySelector('#wf-form-Add-Item select').addEventListener('change', showButtonIfFormChanged);\n}\n\nfunction initializeSaveStateListeners() {\n  // We delay the rememberUnsavedChanges call to allow any confirm/reject animations to finish\n  document.getElementById('wf-form-Add-Item').querySelectorAll('input').forEach(elm => {\n    elm.addEventListener('input', rememberUnsavedChanges);\n  });\n  document.getElementById('wf-form-Add-Item').querySelectorAll('input[type=\"radio\"]').forEach(elm => {\n    elm.addEventListener('change', rememberUnsavedChanges);\n  });\n  document.getElementById('wf-form-Add-Item').querySelectorAll('input[type=\"checkbox\"]').forEach(elm => {\n    elm.addEventListener('change', rememberUnsavedChanges);\n  });\n  // We delay the rememberUnsavedChanges call to allow any confirm/reject animations to finish\n  document.getElementById('wf-form-Add-Item').querySelectorAll('select').forEach(elm => {\n    elm.addEventListener('change', rememberUnsavedChanges);\n  });\n  document.getElementById('wf-form-Add-Item').querySelectorAll('textarea').forEach(elm => {\n    elm.addEventListener('input', rememberUnsavedChanges);\n  });\n}\n\nfunction initializeRestoreOnNavigation() {\n  window.addEventListener('pageshow', (event) => {\n    if (event.persisted && localStorage.getItem('newItem')) {\n      // Use setTimeout to make sure the document is loaded before we call fillForm()\n      setTimeout(async () => {\n          await fillForm(null, JSON.parse(localStorage.getItem('newItem')), true);\n        },\n        10);\n    }\n  });\n}\n\nasync function initializeSizeConfirm() {\n  document.getElementById('rejectSize').addEventListener('click', () => {\n    document.querySelector('#itemSize').value = '';\n    document.querySelector('#sizeSuggestButtons').style.display = 'none';\n    fieldLabelToggle('itemBrandLabel');\n    document.querySelector('#itemSize').setCustomValidity('');\n  });\n  document.getElementById('confirmSize').addEventListener('click', () => {\n    document.querySelector('#itemSize').setCustomValidity('');\n  })\n}\n\nfunction initializeSuggestButtonsSaveState() {\n  const observer = new MutationObserver((mutationsList, observer) => {\n    const mutatedElement = mutationsList.find(elm => elm.attributeName === 'style');\n    if (mutatedElement && mutatedElement.target.style.display === 'none') {\n      rememberUnsavedChanges();\n    }\n  });\n  Array.from(document.querySelectorAll('.suggest-buttons')).forEach(elm =>\n    observer.observe(elm, { attributes: true})\n  )\n}\n\nasync function initializeColorConfirm() {\n  document.getElementById('rejectColor').addEventListener('click', () => {\n    document.querySelector('#itemColor').value = '';\n    document.querySelector('#colorSuggestButtons').style.display = 'none';\n    fieldLabelToggle('itemColorLabel');\n    document.querySelector('#itemColor').setCustomValidity('');\n  });\n  document.getElementById('confirmColor').addEventListener('click', () => {\n    document.querySelector('#itemColor').setCustomValidity('');\n  })\n}\n\nfunction clearFormFields() {\n  document.getElementById('clearItemForm').style.display = 'none';\n  imageElements().forEach(imageName => {\n    document.getElementById(`${imageName}Preview`).style.backgroundImage = '';\n    showImageState(imageName, 'default-state');\n  });\n\n  setFieldValue('itemBrand', null);\n  Array.from(document.querySelectorAll('.suggest-buttons')).forEach(el => el.style.display = 'none');\n  setFieldValue('itemSize', null);\n  setFieldValue('itemMaterial', null);\n  setFieldValue('itemModel', null);\n  setFieldValue('itemOriginalPrice', null);\n\n  setFieldValue('itemUserComment', null);\n  setFieldValue('itemDefectDescription', null);\n  setFieldValue('itemLowestAcceptPrice', null);\n\n  selectFieldValue(itemAge, '');\n  selectFieldValue(itemColor, '');\n  selectFieldValue(itemCondition, '');\n  defectInfoDiv.style.display = 'none';\n  const itemCategory = $('#itemCategory');\n  itemCategory.val('');\n  itemCategory.trigger('change');\n\n  // Populate radio-buttons\n  document.getElementById('Man').previousElementSibling.classList.remove(\"w--redirected-checked\");\n  document.getElementById('Man').checked = false;\n  document.getElementById('Unisex').previousElementSibling.classList.remove(\"w--redirected-checked\");\n  document.getElementById('Unisex').checked = false;\n  document.getElementById('Woman').previousElementSibling.classList.add(\"w--redirected-checked\"); // select radio button 'Woman'\n  document.getElementById('Woman').checked = true;\n\n  // Populate checkboxes\n  defectsChoicesInSwedish().forEach((value, key) => {\n    document.getElementById(key).previousElementSibling.classList.remove(\"w--redirected-checked\");\n    document.getElementById(key).checked = false;\n  });\n  if (document.getElementById('itemUserValuationApproval').checked === false) {\n    document.getElementById('itemUserValuationApproval').click();\n    document.getElementById('itemUserValuationApproval').previousElementSibling.classList.add(\"w--redirected-checked\");\n  }\n  sessionStorage.removeItem('newItemId');\n  localStorage.removeItem('newItem');\n}\n\nfunction initializeDeleteImageListeners() {\n  imageElements().forEach(imageName => {\n    document.getElementById(`delete${capitalizeFirstLetter(imageName)}Icon`).addEventListener('click', () => {\n      removeSavedImage(imageName);\n    });\n  })\n  document.getElementById(\"deleteFrontImageIcon\").addEventListener('click', () => {\n    document.getElementById(\"frontImage\").required = true;\n    removeSavedImage('enhancedFrontImage');\n  });\n  document.getElementById(\"deleteBrandTagImageIcon\").addEventListener('click', () => {\n    document.getElementById(\"brandTagImage\").required = true;\n  });\n}\n\nfunction removeSavedImage(imageName) {\n  const newItem = JSON.parse(localStorage.getItem('newItem'));\n  delete newItem?.images?.[imageName];\n  delete newItem?.images?.[`${imageName}Small`];\n  localStorage.setItem('newItem', JSON.stringify(newItem));\n}\n\nasync function initializeCategorySelect() {\n  const itemCategories = [\n    {\"id\": \"\", \"text\": \"\",},\n    {\"text\": \"Överdelar\", \"children\": [\n        {\"id\": \"Tröja\", \"text\": \"Tröja\",}, {\"id\": \"Blus\", \"text\": \"Blus\",}, {\"id\": \"Topp\", \"text\": \"Topp\",}, {\"id\": \"Skjorta\", \"text\": \"Skjorta\",}, {\"id\": \"Linneskjorta\", \"text\": \"Linneskjorta\",}, {\"id\": \"T-shirt\", \"text\": \"T-shirt\",}, {\"id\": \"Kavaj\", \"text\": \"Kavaj\",}, {\"id\": \"Sweatshirt\", \"text\": \"Sweatshirt\",}, {\"id\": \"Hoodie\", \"text\": \"Hoodie\",}, {\"id\": \"Polotröja\", \"text\": \"Polotröja\",}, {\"id\": \"Tunika\", \"text\": \"Tunika\",}, {\"id\": \"Väst\", \"text\": \"Väst\",}, {\"id\": \"Kofta\", \"text\": \"Kofta\",}, {\"id\": \"Linne\", \"text\": \"Linne\",}, {\"id\": \"Träningströja\", \"text\": \"Träningströja\",}, {\"id\": \"Poncho\", \"text\": \"Poncho\",}, {\"id\": \"Piké\", \"text\": \"Piké\",}, {\"id\": \"Långärmad T-shirt\", \"text\": \"Långärmad T-shirt\",}, {\"id\": \"Kostymväst\", \"text\": \"Kostymväst\",}\n      ]},\n    {\"text\": \"Underdelar\", \"children\": [\n        {\"id\": \"Kjol\", \"text\": \"Kjol\",}, {\"id\": \"Byxor\", \"text\": \"Byxor\",}, {\"id\": \"Jeans\", \"text\": \"Jeans\",}, {\"id\": \"Chinos\", \"text\": \"Chinos\",}, {\"id\": \"Fritidsbyxor\", \"text\": \"Fritidsbyxor\",}, {\"id\": \"Träningsbyxor\", \"text\": \"Träningsbyxor\",}, {\"id\": \"Tights\", \"text\": \"Tights\",}, {\"id\": \"Strumpbyxor\", \"text\": \"Strumpbyxor\",}, {\"id\": \"Mjukisbyxor\", \"text\": \"Mjukisbyxor\",}, {\"id\": \"Kostymbyxor\", \"text\": \"Kostymbyxor\",}, {\"id\": \"Shorts\", \"text\": \"Shorts\",}, {\"id\": \"Sarong\", \"text\": \"Sarong\",}\n      ]},\n    {\"text\": \"Helkropp\", \"children\": [\n        {\"id\": \"Klänning\", \"text\": \"Klänning\",}, {\"id\": \"Kaftan\", \"text\": \"Kaftan\",}, {\"id\": \"Kostym\", \"text\": \"Kostym\",}, {\"id\": \"Set\", \"text\": \"Set\",}, {\"id\": \"Jumpsuit\", \"text\": \"Jumpsuit\",}, {\"id\": \"Baddräkt\", \"text\": \"Baddräkt\",}, {\"id\": \"Bikini\", \"text\": \"Bikini\",}, {\"id\": \"Pyjamas\", \"text\": \"Pyjamas\",}, {\"id\": \"Morgonrock\", \"text\": \"Morgonrock\",}, {\"id\": \"Bröllopsklänning\", \"text\": \"Bröllopsklänning\",}, {\"id\": \"Balklänning\", \"text\": \"Balklänning\",}, {\"id\": \"Bodysuit\", \"text\": \"Bodysuit\",}, {\"id\": \"Underställ\", \"text\": \"Underställ\",}\n      ]},\n    {\"text\": \"Ytterkläder\", \"children\": [\n        {\"id\": \"Jacka\", \"text\": \"Jacka\",}, {\"id\": \"Kappa\", \"text\": \"Kappa\",}, {\"id\": \"Rock\", \"text\": \"Rock\",}, {\"id\": \"Fritidsjacka\", \"text\": \"Fritidsjacka\",}, {\"id\": \"Trenchcoat\", \"text\": \"Trenchcoat\",}, {\"id\": \"Skinnjacka\", \"text\": \"Skinnjacka\",}, {\"id\": \"Dunjacka\", \"text\": \"Dunjacka\",}, {\"id\": \"Regnjacka\", \"text\": \"Regnjacka\",}, {\"id\": \"Pälsjacka\", \"text\": \"Pälsjacka\",}\n      ]},\n    {\"text\": \"Skor\", \"children\": [\n        {\"id\": \"Sneakers\", \"text\": \"Sneakers\",}, {\"id\": \"Sandaler\", \"text\": \"Sandaler\",}, {\"id\": \"Klackar\", \"text\": \"Klackar\",}, {\"id\": \"Ballerinaskor\", \"text\": \"Ballerinaskor\",}, {\"id\": \"Loafers\", \"text\": \"Loafers\",}, {\"id\": \"Flip-flops\", \"text\": \"Flip-flops\",}, {\"id\": \"Boots\", \"text\": \"Boots\",}, {\"id\": \"Kängor\", \"text\": \"Kängor\",}, {\"id\": \"Vinterskor\", \"text\": \"Vinterskor\",}, {\"id\": \"Skor\", \"text\": \"Annat (Skor)\",}\n      ]},\n    {\"text\": \"Väskor\", \"children\": [\n        {\"id\": \"Axelremsväska\", \"text\": \"Axelremsväska\",}, {\"id\": \"Handväska\", \"text\": \"Handväska\",}, {\"id\": \"Kuvertväska\", \"text\": \"Kuvertväska\",}, {\"id\": \"Ryggsäck\", \"text\": \"Ryggsäck\",}, {\"id\": \"Träningsväska\", \"text\": \"Träningsväska\",}, {\"id\": \"Resväska\", \"text\": \"Resväska\",}, {\"id\": \"Datorväska\", \"text\": \"Datorväska\",}, {\"id\": \"Väska\", \"text\": \"Annat (Väska)\",}\n      ]},\n    {\"text\": \"Accessoarer\", \"children\": [\n        {\"id\": \"Solglasögon\", \"text\": \"Solglasögon\",}, {\"id\": \"Glasögon\", \"text\": \"Glasögon\",}, {\"id\": \"Örhänge\", \"text\": \"Örhänge\",}, {\"id\": \"Halsband\", \"text\": \"Halsband\",}, {\"id\": \"Armband\", \"text\": \"Armband\",}, {\"id\": \"Ring\", \"text\": \"Ring\",}, {\"id\": \"Brosch\", \"text\": \"Brosch\",}, {\"id\": \"Keps\", \"text\": \"Keps\",}, {\"id\": \"Sjal\", \"text\": \"Sjal\",}, {\"id\": \"Krage\", \"text\": \"Krage\",}, {\"id\": \"Bälte\", \"text\": \"Bälte\",}, {\"id\": \"Plånbok\", \"text\": \"Plånbok\",}, {\"id\": \"Halsduk\", \"text\": \"Halsduk\",}, {\"id\": \"Hatt\", \"text\": \"Hatt\",}, {\"id\": \"Mössa\", \"text\": \"Mössa\",}, {\"id\": \"Vantar\", \"text\": \"Vantar\",}, {\"id\": \"Necessär\", \"text\": \"Necessär\",}, {\"id\": \"Slips\", \"text\": \"Slips\",}, {\"id\": \"Handduk\", \"text\": \"Handduk\",}, {\"id\": \"Klocka\", \"text\": \"Klocka\",}\n      ]}\n  ];\n  $('#itemCategory').select2({ selectionCssClass: 'form-field', placeholder: 'Kategori', data: itemCategories });\n  $(\"body\").on('click', '.select2-container--open .select2-results__group', function () {\n    if ($(this).parent().attr('class').match(/expanded-group/)) {\n      $(this).parent().removeClass('expanded-group');\n    } else {\n      $('.expanded-group').first().removeClass('expanded-group');\n      $(this).parent().addClass('expanded-group');\n    }\n  });\n\n  let headerAdded = false;\n  $('#itemCategory').on( 'select2:select', () => {\n    analytics.track('Click', { elementID: 'itemCategoryValue' });\n    document.querySelector('#itemCategory').dispatchEvent(new Event('change'));\n  });\n  let searchClickTracked = false;\n  $('#itemCategory').on('select2:open', () => {\n    if (!searchClickTracked) {\n      searchClickTracked = true;\n      $('input.select2-search__field').on('click', () => {\n        analytics.track('Click', { elementID: 'itemCategorySearch' });\n      });\n    }\n  });\n\n  $('#itemCategory').on('select2:close', () => {\n    document.querySelector('body').style.overflow = 'auto'\n    document.querySelector('body').style.position = 'static';\n    document.querySelector('html').style.overflow = 'static';\n  });\n  $('#itemCategory').on('select2:open', function () {\n    analytics.track(\"Element Viewed\", { elementID: \"itemCategoryContainer\" });\n    document.querySelector('body').style.overflow = 'hidden';\n    document.querySelector('body').style.position = 'fixed';\n    document.querySelector('html').style.overflow = 'fixed';\n    const searchField = document.querySelector('.select2-search__field');\n    searchField.placeholder = 'Sök... (t.ex. Klänning/Sneakers/Blus)';\n    $('.select2-search__field').on('input', (e) => {\n      if (e.target.value.length > 0) {\n        $('.select2-results__option[role=group]').each((idx, elm) => $(elm).addClass('expanded-group'));\n      } else {\n        $('.expanded-group').each((idx, elm) => $(elm).removeClass('expanded-group'));\n      }\n    });\n    if (!headerAdded) {\n      const header = document.getElementById('categoryPopUpHeader');\n      const container = document.querySelector('.select2-dropdown');\n      container.insertBefore(header, container.firstChild);\n      header.style.display = 'block';\n      header.querySelector('#categorySelectClose').onclick = () => $('#itemCategory').select2('close');\n      headerAdded = true;\n    }\n    document.querySelector('.select2-results__options').addEventListener('scroll', () => document.activeElement.blur());\n  });\n\n  $('#itemCategory').on('change', fieldLabelToggle('itemCategoryLabel'));\n\n  // From https://github.com/select2/select2/issues/3015#issuecomment-570171720\n  $(\"#itemCategory\").on(\"select2:open\", function () {\n    $(\".select2-results\").css(\"visibility\", \"hidden\");\n  });\n  $(\"#itemCategory\").on('select2:opening', function () {\n    setTimeout(function () {\n      $(\".select2-results\").css(\"visibility\", \"visible\");\n    }, 50);\n  });\n}\n\nconst BLACK_LIST = ['se', 'bild', 'vet', 'ej', 'flätad', 'klack', 'överdel', 'grovt', 'hälrem', 'vind', 'och', 'vattentålig', 'utsida', 'tillverkad', 'av', 'woolrichs', 'signatur', 'blandning', 'avslutad', 'med', 'en', 'speciell', 'teflonbeläggning', 'för', 'extra', 'skydd', 'ankdun', 'vadderingen', 'avtagbar', 'tvättbjörnspäls', 'på', 'luvan'];\n\nconst blackListSet = new Set(BLACK_LIST);\n\nconst blackListed = (s) => blackListSet.has(s?.toLowerCase());\n\nconst partsMatch = (s0, s1) => {\n  return !blackListed(s0) && !blackListed(s1) && (s0.indexOf(s1) > -1 || s1.indexOf(s0) > -1);\n};\n\nexport const isNoBgImage = async (source) => {\n  const getImageMeta = async (url) => {\n    const img = new Image();\n    img.crossOrigin = \"Anonymous\";\n    img.src = url;\n    await img.decode();\n    return img\n  };\n  const checkUniformColor = (data) => {\n    const [r, g, b, a] = [data[0], data[1], data[2], data[3]];\n    let nonConformingCount = 0;\n    for (let i = 4; i < data.length; i += 4) {\n      if (data[i] !== r || data[i + 1] !== g || data[i + 2] !== b || data[i + 3] !== a) {\n        return false;\n      }\n    }\n    return true;\n  };\n  try {\n    if (source.match(/nobg|no-bg/i)) {\n      return true;\n    }\n    const img = await getImageMeta(source);\n    const canvas = document.createElement(\"canvas\");\n    const ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(img, 0, 0, img.naturalWidth, img.naturalHeight);\n\n    const topBorder = ctx.getImageData(0, 0, img.naturalWidth, 10).data;\n    const bottomBorder = ctx.getImageData(0, img.naturalHeight - 10, img.naturalWidth, 10).data;\n    const leftBorder = ctx.getImageData(0, 0, 10, img.naturalHeight).data;\n    const rightBorder = ctx.getImageData(img.naturalWidth - 10, 0, 10, img.naturalHeight).data;\n\n    return (\n        checkUniformColor(topBorder) &&\n        checkUniformColor(bottomBorder) &&\n        checkUniformColor(leftBorder) &&\n        checkUniformColor(rightBorder)\n    );\n  } catch(e) {\n    console.error(e);\n    // If we cannot load the image, play it safe and assume it is the no-bg image\n    return true;\n  }\n};\n\n// Call sellItemMain directly\nsellItemMain();\n// and call sellItemMainAuthenticated after/when a user has logged in\nuser.whenSet(sellItemMainAuthenticated);\n","export async function uploadTempImage(input, fileName) {\n    if (!sessionStorage.getItem('newItemId')) {\n        sessionStorage.setItem('newItemId', await  requestUniqueId());\n    }\n    const tempId = sessionStorage.getItem('newItemId');\n    let image = await scaleImageToMaxSize(input);\n    if (!image) {\n        throw 'Fel vid bearbetning av vald bild.';\n    }\n    const form = new FormData();\n    form.append('itemId', tempId);\n    form.append('fileName', fileName);\n    form.append('file', image);\n    form.append('temporary', 'true');\n    form.append('generateSmallImage', 'true');\n    const response = await fetch('https://uploaditemimagebinary-heypmjzjfq-ew.a.run.app', {\n        method: 'POST',\n        body: form\n    });\n    return await response.json();\n}\n\nasync function scaleImageToMaxSize(input) {\n    if (input.size < 9 * 1024 * 1024) {\n        // Don't compress images < 9MB in size\n        return Promise.resolve(input);\n    }\n    return new Promise((resolve, reject) => {\n        const MAX_WIDTH = 1512;\n        const MAX_HEIGHT = 2016;\n        const reader = new FileReader();\n        reader.onload = () => {\n            const img = document.createElement(\"img\");\n            img.onload = () => {\n                let width = img.width;\n                let height = img.height;\n                if (width > height) {\n                    if (width > MAX_WIDTH) {\n                        height = height * (MAX_WIDTH / width);\n                        width = MAX_WIDTH;\n                    }\n                } else {\n                    if (height > MAX_HEIGHT) {\n                        width = width * (MAX_HEIGHT / height);\n                        height = MAX_HEIGHT;\n                    }\n                }\n                const canvas = document.createElement(\"canvas\");\n                canvas.width = width;\n                canvas.height = height;\n                const ctx = canvas.getContext(\"2d\");\n                ctx.imageSmoothingQuality = \"high\";\n                ctx.drawImage(img, 0, 0, width, height);\n                canvas.toBlob(resolve, 'image/jpeg')\n            }\n            img.src = reader.result;\n            reader.onerror = reject;\n        }\n        reader.readAsDataURL(input);\n    });\n}\n\nexport async function requestUniqueId() {\n    const endpointUrl = 'https://generateuniqueid-heypmjzjfq-ew.a.run.app';\n    try {\n        const response = await fetch(endpointUrl, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n        });\n        if (!response.ok) {\n            console.error(`Error: ${response.statusText}`);\n            return null;\n        }\n        const data = await response.json();\n        return data.id;\n    } catch (error) {\n        console.error(`Failed to fetch unique ID, generating uuidv4 id: ${error.message}`, error);\n        return uuidv4();\n    }\n}\n\nexport async function enhanceFrontImage(imageUrl, saveState = true) {\n    const enhancedImageUrls = await createEnhancedImage(imageUrl);\n    if (enhancedImageUrls?.url) {\n        rememberNewItemImageField('enhancedFrontImage', enhancedImageUrls.url, enhancedImageUrls.urlSmall);\n        showImagePreview('frontImage', window.innerWidth <= 400 ? enhancedImageUrls.urlSmall : enhancedImageUrls.url);\n    }\n    showDeleteImageIcon('frontImage');\n    return enhancedImageUrls;\n}\n\nasync function createEnhancedImage(imageUrl) {\n    try {\n        const response = await firebase.app().functions(\"europe-west1\").httpsCallable('enhanceFrontImage')({ imageUrl });\n        sessionStorage.setItem('enhancedFrontImage', response.data.url)\n        return response.data;\n    } catch (ex) {\n        errorHandler.report(ex);\n        console.error(ex);\n        return '';\n    }\n}\n\nexport function showDeleteImageIcon(imageName) {\n    document.getElementById(`loading${capitalizeFirstLetter(imageName)}Icon`).style.display = 'none';\n    document.getElementById(`delete${capitalizeFirstLetter(imageName)}Icon`).style.display = 'inline-block';\n    if (imageName === 'frontImage'){\n        document.getElementById('enhancedAnimationDiv').style.display = 'none';\n    }\n}\n\nexport function rememberNewItemImageField(imageName, imageUrl, imageUrlSmall) {\n    let newItem = JSON.parse(localStorage.getItem('newItem') || JSON.stringify({}));\n    const images = newItem.images || {};\n    images[imageName] = imageUrl;\n    images[`${imageName}Small`] = imageUrlSmall;\n    newItem.images = images;\n    localStorage.setItem('newItem', JSON.stringify(newItem));\n}\n\nexport function showImagePreview(imageName, url) {\n    document.getElementById(`${imageName}Preview`).style.backgroundImage = `url('${url}')`;\n    showDeleteImageIcon(imageName);\n}\n\nexport function capitalizeFirstLetter(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1);\n}\n\nexport async function uploadImageAndShowPreview(input, imageName) {\n    try {\n        hideImageError(imageName);\n        let src = URL.createObjectURL(input);\n        document.getElementById(`${imageName}PreviewUploading`).style.backgroundImage = `url('${src}')`;\n        document.getElementById(`${imageName}Preview`).style.backgroundImage = `url('${src}')`;\n        showLoadingIcon(imageName)\n        showImageState(imageName, 'success-state');\n        const { url: imageUrl, urlSmall: imageUrlSmall } = await uploadTempImage(input, imageName);\n        rememberNewItemImageField(imageName, imageUrl, imageUrlSmall);\n        return imageUrl;\n    } catch (ex) {\n        console.error('Failed to upload image', ex);\n        errorHandler.report(ex);\n        document.getElementById(`${imageName}PreviewUploading`).style.backgroundImage = '';\n        document.getElementById(`${imageName}Preview`).style.backgroundImage = '';\n        document.getElementById(`loading${capitalizeFirstLetter(imageName)}Icon`).style.display = 'none';\n        showImageState(imageName, 'default-state');\n        if (input.size > 10 * 1024 * 1024) {\n            showImageError(imageName, 'Error: Bilden är för stor. Max 10 MB.');\n        } else {\n            showImageError(imageName, 'Error: Något gick fel vid uppladdning, försök igen eller kontakt oss om felet kvarstår.');\n        }\n        document.getElementById(imageName).value = '';\n    }\n}\n\nfunction showImageError(imageName, error) {\n    const parentNode = document.getElementById(imageName).parentNode.parentNode;\n    parentNode.querySelector('.w-file-upload-error').style.display = 'block';\n    parentNode.querySelector('.w-file-upload-error-msg').innerText = error;\n}\n\nfunction hideImageError(imageName) {\n    const parentNode = document.getElementById(imageName).parentNode.parentNode;\n    parentNode.querySelector('.w-file-upload-error').style.display = 'none';\n}\n\nexport function showImageState(imageName, state) {\n    const siblings = document.getElementById(imageName).parentNode.parentNode.childNodes;\n    for (let i = 0; i < siblings.length; i++) {\n        if (siblings[i].className.includes(state)) {\n            siblings[i].style.display = 'block';\n        } else {\n            // Hide other states of file input field \"empty-state\" and \"error-state\"\n            siblings[i].style.display = 'none';\n        }\n    }\n}\n\nfunction showLoadingIcon(imageName) {\n    if (imageName === 'frontImage'){\n        document.getElementById(`delete${capitalizeFirstLetter(imageName)}Icon`).style.display = 'none';\n        document.getElementById('enhancedAnimationDiv').style.display = 'block';\n        triggerEnhancingAnimation.click();\n        return\n    }\n    document.getElementById(`loading${capitalizeFirstLetter(imageName)}Icon`).style.display = 'inline-block';\n    document.getElementById(`delete${capitalizeFirstLetter(imageName)}Icon`).style.display = 'none';\n}\n"],"names":["$c023972b25f99719$var$userItemsCount","$796bae1b0d1cb952$export$84f874cda6ebf2f2","input","fileName","sessionStorage","getItem","setItem","$796bae1b0d1cb952$export$70c624e1c153d1d3","tempId","image","$796bae1b0d1cb952$var$scaleImageToMaxSize","form","FormData","append","response","fetch","method","body","json","size","Promise","resolve","reject","reader","FileReader","onload","img","document","createElement","width","height","MAX_WIDTH","MAX_HEIGHT","canvas","ctx","getContext","imageSmoothingQuality","drawImage","toBlob","src","result","onerror","readAsDataURL","headers","ok","console","error","statusText","data","id","message","uuidv4","$796bae1b0d1cb952$export$ace0eeb8d81a6535","imageUrl","saveState","enhancedImageUrls","$796bae1b0d1cb952$var$createEnhancedImage","url","$796bae1b0d1cb952$export$103dee3750c6df19","urlSmall","$796bae1b0d1cb952$export$3fb7c784498eae74","window","innerWidth","$796bae1b0d1cb952$export$f4e19468e22ee9d3","firebase","app","functions","httpsCallable","ex","errorHandler","report","imageName","getElementById","$796bae1b0d1cb952$export$d07f57595c356899","style","display","imageUrlSmall","newItem","JSON","parse","localStorage","stringify","images","backgroundImage","string","charAt","toUpperCase","slice","$796bae1b0d1cb952$export$16814c2c31118a6e","$796bae1b0d1cb952$var$hideImageError","parentNode","querySelector","URL","createObjectURL","$796bae1b0d1cb952$var$showLoadingIcon","triggerEnhancingAnimation","click","$796bae1b0d1cb952$export$b8d427576f438d88","$796bae1b0d1cb952$var$showImageError","value","innerText","state","siblings","childNodes","i","length","className","includes","$c023972b25f99719$var$defectsChoicesInSwedish","Map","set","$c023972b25f99719$var$imageElements","$c023972b25f99719$var$sellItemMainAuthenticated","log","Date","toggleMoreInfoFields","referrer","$c023972b25f99719$var$createItemAfterSignIn","shippingMethod","preferences","userPhoneSet","user","current","phoneNumber","location","href","removeItem","items","getItems","authUser","uid","$c023972b25f99719$var$sellItemMain","frontImageUpload","brandTagImageUpload","productImageUpload","defectImageUpload","materialTagImageUpload","extraImageUpload","$","off","addEventListener","$c023972b25f99719$var$frontImageChangeHandler","capture","$c023972b25f99719$var$brandTagImageChangeHandler","$c023972b25f99719$var$productImageChangeHandler","$c023972b25f99719$var$defectImageChangeHandler","$c023972b25f99719$var$materialTagImageChangeHandler","$c023972b25f99719$var$extraImageChangeHandler","setupModelSearchEventListeners","$c023972b25f99719$var$initializeSelectColor","itemColor1","onchange","color","itemAge1","itemBrand","$c023972b25f99719$var$fieldLabelToggle","$c023972b25f99719$var$clearConfirmButtonValidity","itemModel","itemSize","itemMaterial","itemOriginalPrice","itemAge","itemCondition","itemColor","itemUserComment","reportValidity","invalidElements","querySelectorAll","element","getBoundingClientRect","cssText","setTimeout","$c023972b25f99719$var$isElementInView","el","jQuery","rect","top","left","bottom","innerHeight","documentElement","clientHeight","right","clientWidth","y","scrollY","scrollTo","behavior","addItemForm","$c023972b25f99719$var$addItem","userAddressForm","addUserDetails","autocomplete","brands","brand","oninput","shareSoldDiv","$c023972b25f99719$var$checkBrand","words","some","words1","toLowerCase","hardToSellText","innerHTML","hardToSellDiv","defectInfoDiv","personalId","isValidSwedishSsn","setCustomValidity","$c023972b25f99719$var$initializeCategorySelect","$c023972b25f99719$var$initializeColorConfirm","$c023972b25f99719$var$initializeBrandConfirm","$c023972b25f99719$var$initializeMaterialConfirm","$c023972b25f99719$var$initializeSizeConfirm","$c023972b25f99719$var$initializeSuggestButtonsSaveState","observer","MutationObserver","mutationsList","mutatedElement","find","elm","attributeName","target","$c023972b25f99719$var$rememberUnsavedChanges","Array","from","forEach","observe","attributes","$c023972b25f99719$var$initializeClearFormButton","showButtonIfFormChanged","event","field","Element","defaultValue","$c023972b25f99719$var$defaultFormState","name","$c023972b25f99719$var$removeSavedImage","required","$c023972b25f99719$var$clearFormFields","params","auth","onAuthStateChanged","user1","$c023972b25f99719$var$fillForm","$c023972b25f99719$var$isDefaultFormState","persisted","item","$c023972b25f99719$var$addItemInner","nextStep","$c023972b25f99719$var$getAndSaveMlValuation","userValuationApproval","analytics","track","e","$c023972b25f99719$var$needsHumanCheck","humanCheckNeeded","newMinMaxLog","match","$c023972b25f99719$var$saveItemValuation","itemId","mlValuationData","minPrice","maxPrice","decline","humanCheckExplanation","willNotSell","soldPrice","version","newMinPriceEstimate","newMaxPriceEstimate","adjustmentAllowed","newBrand","newBrandCategory","valuationData","mlValuation","minPriceEstimate","maxPriceEstimate","willNotSellPrediction","soldPriceEstimate","modelVersion","toString","valuationStatus","valuationDate","toISOString","infoRequests","price","status","description","latestItemCreated","res","$c023972b25f99719$var$nextStepAfterMlValuation","mlValuationPresent","valuationNeedsChecking","acceptPrice","age","category","condition","defectDescription","defects","material","model","originalPrice","sex","userComment","$c023972b25f99719$var$collect","now","trim","Number","itemDefectDescription","itemLowestAcceptPrice","itemUserValuationApproval","checked","defectElements","hole","stain","lostFit","nopprig","threadUp","colorChange","otherDefect","key","get","push","sexRadioButtons","getElementsByName","x","modelBoxFilled","modelVariantFields","modelData","getAttribute","modelCoverImageUrl","atModelVariantId","createdAt","shippingStatus","itemCategory","$c023972b25f99719$var$getShippingMethod","pageData","createdFromItem","createItemResponse","itemFromStorage","itemToSave","Object","keys","reduce","acc","inputName","suggestButtons","itemState","defaultState","labelId","$c023972b25f99719$var$showSuggestButtons","fieldName","restoreSavedState","showConfirmation","savedItem","urlLarge","enhancedFrontImage","coverImageLarge","coverImage","coverImageSmall","$c023972b25f99719$export$5649c3d7079ff20f","itemBrandConfirm","setFieldValue","itemSizeConfirm","itemMaterialConfirm","$c023972b25f99719$var$selectFieldValue","itemColorConfirm","selectedIndex","options","text","itemCategory1","val","trigger","previousElementSibling","classList","remove","add","selectIndex","map","indexOf","dispatchEvent","Event","$c023972b25f99719$var$apiColorMapping","files","stopPropagation","promises","$c023972b25f99719$var$detectAndFillColor","$c023972b25f99719$var$detectAndFillBrandAndMaterialAndSize","all","currentTarget","elementID","materials","colors","select2","selectionCssClass","placeholder","on","parent","attr","removeClass","first","addClass","headerAdded","searchClickTracked","overflow","position","searchField","each","idx","header","container","insertBefore","firstChild","onclick","activeElement","blur","css","source","getImageMeta","Image","crossOrigin","decode","checkUniformColor","r","g","b","a","naturalWidth","naturalHeight","topBorder","getImageData","bottomBorder","leftBorder","rightBorder","whenSet"],"version":3,"file":"sellItem.js.map"}