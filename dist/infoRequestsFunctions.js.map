{"mappings":"A,iD","sources":["<anon>","infoRequestsFunctions.js","general.js"],"sourcesContent":["(function () {\nfunction $3940e9575021adc4$var$signOut() {\n    firebase.auth().signOut().then(()=>{\n        console.log(\"User signed out\");\n        authUser.current = null;\n        user.current = null;\n        userId = null;\n        location.href = \"/\";\n        deleteCookie(\"maiAuth\");\n    }).catch((error)=>{\n        errorHandler.report(error);\n        console.log(error);\n    });\n}\nfunction $3940e9575021adc4$export$dafa36e3c090bd7e(user1) {\n    document.getElementById(\"addressFirstName\").value = user1.addressFirstName || \"\";\n    document.getElementById(\"addressFirstName\").dispatchEvent(new Event(\"input\"));\n    document.getElementById(\"addressLastName\").value = user1.addressLastName || \"\";\n    document.getElementById(\"addressLastName\").dispatchEvent(new Event(\"input\"));\n    document.getElementById(\"addressStreetAddress\").value = user1.addressStreetAddress || \"\";\n    document.getElementById(\"addressStreetAddress\").dispatchEvent(new Event(\"input\"));\n    document.getElementById(\"addressCO\").value = user1.addressCO || \"\";\n    document.getElementById(\"addressCO\").dispatchEvent(new Event(\"input\"));\n    document.getElementById(\"addressPostalCode\").value = user1.addressPostalCode || \"\";\n    document.getElementById(\"addressPostalCode\").dispatchEvent(new Event(\"input\"));\n    document.getElementById(\"addressCity\").value = user1.addressCity || \"\";\n    document.getElementById(\"addressCity\").dispatchEvent(new Event(\"input\"));\n    document.getElementById(\"addressDoorCode\").value = user1.addressDoorCode || \"\";\n    document.getElementById(\"addressDoorCode\").dispatchEvent(new Event(\"input\"));\n}\nfunction $3940e9575021adc4$export$bb56b8325423933() {\n    let addressFirstName = document.getElementById(\"addressFirstName\").value;\n    let addressLastName = document.getElementById(\"addressLastName\").value;\n    let addressStreetAddress = document.getElementById(\"addressStreetAddress\").value;\n    let addressCO = document.getElementById(\"addressCO\").value;\n    let addressPostalCode = document.getElementById(\"addressPostalCode\").value;\n    let addressCity = document.getElementById(\"addressCity\").value;\n    let addressDoorCode = document.getElementById(\"addressDoorCode\").value;\n    addressFirstName = addressFirstName ? addressFirstName.trim().charAt(0).toUpperCase() + addressFirstName.trim().slice(1) : \"\";\n    addressLastName = addressLastName ? addressLastName.trim().charAt(0).toUpperCase() + addressLastName.trim().slice(1) : \"\";\n    addressStreetAddress = addressStreetAddress ? addressStreetAddress.trim().charAt(0).toUpperCase() + addressStreetAddress.trim().slice(1) : \"\";\n    addressCO = addressCO ? addressCO.trim() : \"\";\n    addressPostalCode = addressPostalCode ? addressPostalCode.trim().replace(/\\D/g, \"\") : \"\";\n    addressCity = addressCity ? addressCity.trim().charAt(0).toUpperCase() + addressCity.trim().slice(1) : \"\";\n    addressDoorCode = addressDoorCode ? addressDoorCode.trim() : \"\";\n    return {\n        addressFirstName: addressFirstName,\n        addressLastName: addressLastName,\n        addressStreetAddress: addressStreetAddress,\n        addressCO: addressCO,\n        addressPostalCode: addressPostalCode,\n        addressCity: addressCity,\n        addressDoorCode: addressDoorCode\n    };\n}\nfunction $3940e9575021adc4$export$6186634e4bafe14d(ssn) {\n    ssn = ssn.replace(/\\D/g, \"\") // strip out all but digits\n    .split(\"\") // convert string to array\n    .reverse() // reverse order for Luhn\n    .slice(0, 10); // keep only 10 digits (i.e. 1977 becomes 77)\n    // verify we got 10 digits, otherwise it is invalid\n    if (ssn.length !== 10) return false;\n    const sum = ssn.map((n)=>Number(n)).reduce((previous, current, index)=>{\n        if (index % 2) current *= 2;\n        if (current > 9) current -= 9;\n        return previous + current;\n    });\n    return 0 === sum % 10;\n}\nfunction $3940e9575021adc4$export$2b32a697e92b0edc(personalIdInput) {\n    let personalId = personalIdInput.replace(\"-\", \"\");\n    if (personalId.length !== 12 && (personalId.substring(0, 2) !== \"19\" || personalId.substring(0, 2) !== \"20\")) {\n        if (Number(personalId.substring(0, 2)) <= 99 && Number(personalId.substring(0, 2)) > 25) personalId = \"19\" + personalId;\n        else personalId = \"20\" + personalId;\n    }\n    if (personalId.length === 12) return personalId;\n    return null;\n}\nfunction $3940e9575021adc4$export$b49e2d49708b2f8e(item) {\n    const images = item.images;\n    if (images.modelImage) return images.modelImageSmall || images.modelImage;\n    if (images.coverImage) return images.coverImageSmall || images.coverImage;\n    if (images.enhancedFrontImage) return images.enhancedFrontImageSmall || images.enhancedFrontImage;\n    return images.frontImageSmall || images.frontImage;\n}\nfunction $3940e9575021adc4$export$82ce321a7c87aa7e() {\n    const code = user.current.referralData.referralCode;\n    const text = `Hej, jag vill tipsa om Mai för att rensa ur garderoben. Mai är en tjänst som hjälper dig att sälja dina kläder på ett enkelt sätt. Man tar bara bilder på sina plagg, sedan sköter Mai resten - såsom värdering, annonsering på flera plattformar, kontakt med köpare och frakt när det blir sålt. Man får själv behålla 80% av vinsten, och blir det inte sålt kostar det ingenting.\\n\\nOm du registrerar dig med min kod (följ länken) och provar sälja ett plagg inom 7 dagar får du behålla 100% av vinsten för det första plagget (istället för 80%). Min kod: ${code}\\n\\nLäs mer och använd min kod här:`;\n    if (navigator.share) navigator.share({\n        text: text,\n        url: `https://maiapp.se/?invite=${code}`\n    }).then(()=>{\n        console.log(\"Thanks for sharing!\");\n    }).catch((e)=>{\n        console.error(e);\n        errorHandler.report(e);\n    });\n    else {\n        console.log(\"Browser doesn't support navigator.share => Copy to clipboard!\");\n        const shareText = text + \"\\n\" + `https://maiapp.se/?invite=${code}`;\n        navigator.clipboard.writeText(shareText);\n        linkCopiedBanner.style.display = \"flex\";\n        setTimeout(function() {\n            linkCopiedBanner.style.display = \"none\";\n        }, 1500);\n    }\n}\n\n\nasync function $d66f518873cb934c$var$openMeasurementsToast(itemId, description) {\n    measurementDescriptionText.innerHTML = description;\n    measurementsSubmitButton.addEventListener(\"click\", async function() {\n        const input = measurementsInput.value;\n        if (input.length > 0 && input !== \" \") await db.collection(\"items\").doc(itemId).update({\n            measurements: input,\n            \"infoRequests.measurements.status\": \"Resolved\"\n        });\n        triggerMeasurementsToastClose.click();\n        setTimeout(function() {\n            location.reload();\n        }, 400);\n    });\n    triggerMeasurementsToastOpen.click();\n}\nasync function $d66f518873cb934c$var$openLongerPeriodToast(itemId, brand, currentMinPrice, deniedBefore) {\n    // If user is qualified to get the discount question -> Show it to the user\n    const price = currentMinPrice;\n    const priceWithDiscount30 = Math.ceil(price * 0.7 / 10) * 10;\n    const priceWithDiscount20 = Math.ceil(price * 0.8 / 10) * 10;\n    priceAfterDiscount30.innerHTML = `(Priset blir ${priceWithDiscount30} kr)`;\n    priceAfterDiscount20.innerHTML = `(Priset blir ${priceWithDiscount20} kr)`;\n    priceNoDiscount.innerHTML = `(${price} kr)`;\n    if (price >= 140 && !deniedBefore) {\n        longerPeriodDescriptionText.innerHTML = `Säljperioden för ditt ${brand}-plagg har nått sitt slut. Välj om du vill förlänga säljperioden med ytterligare 30 dagar och om du vill sänka priset för att öka chansen att få det sålt.`;\n        discountFormDiv.style.display = \"block\";\n    } else {\n        longerPeriodDescriptionText.innerHTML = `Säljperioden för ditt ${brand}-plagg har nått sitt slut. Vill du förlänga säljperioden med ytterligare 30 dagar eller avsluta försäljningen?`;\n        discountFormDiv.style.display = \"none\";\n    }\n    // Accept longer selling window and store chosen discount\n    longerPeriodAcceptButton.addEventListener(\"click\", async function() {\n        const today = new Date();\n        const todayDate = today.toISOString().split(\"T\")[0];\n        let newPrice = price;\n        let discount = 0;\n        var discountRadioButtons = document.getElementsByName(\"Discount\");\n        for(var x = 0; x < discountRadioButtons.length; x++)if (discountRadioButtons[x].checked) {\n            const input = discountRadioButtons[x].value;\n            if (input === \"30\") {\n                newPrice = priceWithDiscount30;\n                discount = 30;\n            }\n            if (input === \"20\") {\n                newPrice = priceWithDiscount20;\n                discount = 20;\n            }\n        }\n        await db.collection(\"items\").doc(itemId).update({\n            longerPeriodAcceptedDate: todayDate,\n            \"infoRequests.longerPeriod.status\": \"Resolved\",\n            \"infoRequests.longerPeriod.response\": \"Accepted\",\n            longerPeriodAcceptedDiscount: discount,\n            minPriceEstimate: newPrice\n        });\n        triggerLongerPeriodToastClose.click();\n        setTimeout(function() {\n            location.reload();\n        }, 300);\n    });\n    // Decline longer selling period and quit sales\n    longerPeriodDenyButton.addEventListener(\"click\", async function() {\n        await db.collection(\"items\").doc(itemId).update({\n            \"infoRequests.longerPeriod.status\": \"Resolved\",\n            \"infoRequests.longerPeriod.response\": \"Denied\",\n            \"status\": \"Unsold\" // This field is normally mastered by AT - I do this for the user to see the effect immediately (the card is removed)\n        });\n        triggerLongerPeriodToastClose.click();\n        setTimeout(function() {\n            location.reload();\n        }, 300);\n    });\n    triggerLongerPeriodToastOpen.click();\n}\nasync function $d66f518873cb934c$var$storePriceResponse(itemId, max, min, response, status) {\n    console.log(\"storePriceResponse\", itemId, max, min, response);\n    // Accept price\n    if (response === \"Accepted\") await db.collection(\"items\").doc(itemId).update({\n        \"infoRequests.price.status\": \"Resolved\",\n        \"infoRequests.price.response\": \"Accepted\",\n        \"maxPriceEstimate\": max,\n        \"minPriceEstimate\": min\n    }).then(function() {\n        triggerNewPriceToastClose.click();\n        setTimeout(function() {\n            location.reload();\n        }, 300);\n    });\n    // Deny price\n    if (response === \"Denied\") {\n        let fields = {\n            \"infoRequests.price.status\": \"Resolved\",\n            \"infoRequests.price.response\": \"Denied\"\n        };\n        if (status === \"New\") {\n            fields[\"archived\"] = true;\n            fields[\"willNotSell\"] = true;\n        }\n        await db.collection(\"items\").doc(itemId).update(fields).then(function() {\n            triggerNewPriceToastClose.click();\n            setTimeout(function() {\n                location.reload();\n            }, 300);\n        });\n    }\n}\nasync function $d66f518873cb934c$var$openNewPriceToast(itemId, status, max, min, brand, description, category, type, currentMax, currentMin) {\n    console.log(\"openNewPriceToast\", itemId, status, max, min, brand, description, category, type, currentMax, currentMin);\n    previousMinPrice.style.display = \"none\";\n    previousMaxPrice.style.display = \"none\";\n    maxPriceDiv.style.display = \"block\";\n    minPriceDiv.style.display = \"block\";\n    // Set content of toast\n    newPriceToastTitle.innerHTML = \"Nytt l\\xe4gsta pris\";\n    newPriceHeading.innerHTML = `${brand}-plagg`;\n    const c = category.toLowerCase();\n    if (c && c !== \"null\") newPriceHeading.innerHTML = `${brand}-${c}`;\n    maxPrice.innerHTML = max;\n    minPrice.innerHTML = min;\n    if (currentMax && currentMax !== \"null\" && currentMax !== \"\" && currentMax !== \"undefined\" && max !== currentMax) {\n        previousMaxPrice.innerHTML = currentMax;\n        previousMaxPrice.style.display = \"block\";\n    }\n    if (currentMin && currentMin !== \"null\" && currentMin !== \"\" && currentMin !== \"undefined\" && min !== currentMin) {\n        previousMinPrice.innerHTML = currentMin;\n        previousMinPrice.style.display = \"block\";\n    }\n    acceptNewPriceButton.innerHTML = \"S\\xe4lj med nytt pris\";\n    denyNewPriceButton.innerHTML = \"S\\xe4nk ej\";\n    if (status === \"New\" && type === \"Valuation\") {\n        newPriceToastTitle.innerHTML = \"V\\xe4rdering\";\n        acceptNewPriceButton.innerHTML = \"S\\xe4lj till v\\xe4rdering\";\n        denyNewPriceButton.innerHTML = \"Avb\\xf6j och avsluta\";\n    }\n    if (type === \"Adjusted ML Valuation\") newPriceToastTitle.innerHTML = \"Nytt prisintervall\";\n    if (type !== \"Valuation\" && type !== \"Adjusted ML Valuation\") {\n        minPrice.innerHTML = `${min} kr`;\n        maxPriceDiv.style.display = \"none\";\n    }\n    if (description && description !== \"undefined\" && description !== \"\" && description !== \"null\") {\n        newPriceText.innerHTML = description;\n        descriptionDiv.style.display = \"block\";\n    }\n    acceptNewPriceButton.href = `javascript:storePriceResponse('${itemId}', ${max}, ${min}, 'Accepted', '${status}');`;\n    denyNewPriceButton.href = `javascript:storePriceResponse('${itemId}', ${max}, ${min}, 'Denied', '${status}');`;\n    // Open toast\n    triggerNewPriceToastOpen.click();\n}\nfunction $d66f518873cb934c$export$3c88ff5ea489d33c(userId) {\n    infoRequestsList.innerHTML = \"\";\n    db.collection(\"items\").where(\"user\", \"==\", userId).get().then((querySnapshot)=>{\n        querySnapshot.forEach((doc)=>{\n            var itemId = doc.id;\n            var item = doc.data();\n            var infoRequests = item.infoRequests;\n            var status = item.status;\n            var brand = item.brand.replace(/'/g, \"\");\n            var currentMinPrice = item.minPriceEstimate;\n            var currentMaxPrice = item.maxPriceEstimate;\n            var deniedBefore = item?.infoRequests?.price?.response === \"Denied\" ? true : false;\n            var archived = item.archived;\n            var category = item.category;\n            const images = item.images;\n            var frontImageUrl = (0, $3940e9575021adc4$export$b49e2d49708b2f8e)(item);\n            if (archived == undefined && status !== \"Unsold\" && status !== \"Sold\" && infoRequests) displayRequests();\n            function displayRequests() {\n                for(const req in infoRequests)if (infoRequests[req]?.status === \"Active\") {\n                    let title = \"\";\n                    let subText = \"\";\n                    let href = \"\";\n                    let buttonText = `Komplettera`;\n                    let buttonClass = \"completerequestbutton\";\n                    let buttonTextClass = \"text-block-69\";\n                    let description = infoRequests[req].description;\n                    if (description) description = description.replace(/'/g, \"\");\n                    // PRICE REQUEST\n                    if (req === \"price\") {\n                        const type = infoRequests[req].type;\n                        title = \"L\\xe4gre pris\";\n                        buttonClass = \"acceptnewpricebutton\";\n                        buttonTextClass = \"text-block-69-copy-copy\";\n                        buttonText = \"Se prisf\\xf6rslag\";\n                        subText = \"Vill du s\\xe4nka priset och f\\xe5 det s\\xe5lt?\";\n                        const max = infoRequests[req].maxPrice;\n                        const min = infoRequests[req].minPrice;\n                        href = `javascript:openNewPriceToast('${itemId}', '${status}', ${max}, ${min}, '${brand}', '${description}', '${category}', '${type}', '${currentMaxPrice}', '${currentMinPrice}');`;\n                        if (status === \"New\" && type !== \"Adjusted ML Valuation\") {\n                            title = \"V\\xe4rdering\";\n                            buttonClass = \"acceptnewpricebutton\";\n                            buttonTextClass = \"text-block-69-copy-copy\";\n                            buttonText = \"Se v\\xe4rdering\";\n                            subText = \"Vill du s\\xe4lja till v\\xe5r v\\xe4rdering?\";\n                            href = `/item-valuation?id=${itemId}`;\n                        }\n                    }\n                    // MEASUREMENTS REQUEST\n                    if (req === \"measurements\") {\n                        title = \"M\\xe5tt\";\n                        subText = \"Vi beh\\xf6ver m\\xe5tt f\\xf6r detta plagg\";\n                        buttonText = \"Se mer\";\n                        href = `javascript:openMeasurementsToast('${itemId}', '${description}');`;\n                    }\n                    // IMAGES REQUEST\n                    if (req === \"images\") {\n                        title = \"Bilder\";\n                        subText = \"Bilderna beh\\xf6ver kompletteras\";\n                        buttonText = \"\\xc4ndra bilder\";\n                        href = window.location.origin + `/edit-item?id=${itemId}`;\n                    }\n                    // LONGER PERIOD REQUEST\n                    if (req === \"longerPeriod\") {\n                        title = \"F\\xf6rl\\xe4ng\";\n                        subText = \"Vill du f\\xf6rl\\xe4nga med 30 dagar till?\";\n                        buttonText = \"Svara\";\n                        href = `javascript:openLongerPeriodToast('${itemId}', '${brand}', ${currentMinPrice}, ${deniedBefore});`;\n                    }\n                    // CARD\n                    let card = `<div class=\"div-block-126\">\n                                                <div class=\"ratio-box _16-9\">\n                                                    <div class=\"content-block with-image\">\n                                                        <div class=\"img-container\" style=\"background-image: url('${frontImageUrl}');\"></div>\n                                                    </div>\n                                                </div>\n                                                <div class=\"text-block-73\">${title}</div>\n                                                <div class=\"text-block-72\">${subText}</div>\n                                                <a href=\"${href}\" id=\"\" class=\"link-block-23 w-inline-block\">\n                                                    <div class=\"${buttonClass}\">\n                                                        <div class=\"${buttonTextClass}\">${buttonText}</div>\n                                                    </div>\n                                                </a>\n                                            </div>`;\n                    infoRequestsList.innerHTML += card;\n                    infoRequestsDiv.style.display = \"block\";\n                }\n            }\n        });\n    });\n}\n\n})();\n//# sourceMappingURL=infoRequestsFunctions.js.map\n","import {itemCoverImage} from \"./general\";\n\nasync function openMeasurementsToast(itemId, description) {\n    measurementDescriptionText.innerHTML = description;\n    measurementsSubmitButton.addEventListener('click', async function () {\n        const input = measurementsInput.value;\n        if (input.length > 0 && input !== \" \") {\n            await db.collection('items').doc(itemId).update({\n                measurements: input,\n                \"infoRequests.measurements.status\": \"Resolved\"\n            });\n        }\n        triggerMeasurementsToastClose.click();\n        setTimeout(function () { location.reload(); }, 400);\n    });\n    triggerMeasurementsToastOpen.click();\n}\n\nasync function openLongerPeriodToast(itemId, brand, currentMinPrice, deniedBefore) {\n    // If user is qualified to get the discount question -> Show it to the user\n    const price = currentMinPrice;\n    const priceWithDiscount30 = Math.ceil((price * 0.7) / 10) * 10;\n    const priceWithDiscount20 = Math.ceil((price * 0.8) / 10) * 10;\n    priceAfterDiscount30.innerHTML = `(Priset blir ${priceWithDiscount30} kr)`;\n    priceAfterDiscount20.innerHTML = `(Priset blir ${priceWithDiscount20} kr)`;\n    priceNoDiscount.innerHTML = `(${price} kr)`;\n    if (price >= 140 && !deniedBefore) {\n        longerPeriodDescriptionText.innerHTML = `Säljperioden för ditt ${brand}-plagg har nått sitt slut. Välj om du vill förlänga säljperioden med ytterligare 30 dagar och om du vill sänka priset för att öka chansen att få det sålt.`;\n        discountFormDiv.style.display = 'block';\n    } else {\n        longerPeriodDescriptionText.innerHTML = `Säljperioden för ditt ${brand}-plagg har nått sitt slut. Vill du förlänga säljperioden med ytterligare 30 dagar eller avsluta försäljningen?`;\n        discountFormDiv.style.display = 'none';\n    }\n\n    // Accept longer selling window and store chosen discount\n    longerPeriodAcceptButton.addEventListener('click', async function () {\n        const today = new Date();\n        const todayDate = today.toISOString().split('T')[0];\n        let newPrice = price;\n        let discount = 0\n        var discountRadioButtons = document.getElementsByName(\"Discount\");\n        for (var x = 0; x < discountRadioButtons.length; x++) {\n            if (discountRadioButtons[x].checked) {\n                const input = discountRadioButtons[x].value;\n                if (input === '30') {\n                    newPrice = priceWithDiscount30;\n                    discount = 30;\n                }\n                if (input === '20') {\n                    newPrice = priceWithDiscount20;\n                    discount = 20;\n                }\n            }\n        }\n        await db.collection('items').doc(itemId).update({\n            longerPeriodAcceptedDate: todayDate,\n            \"infoRequests.longerPeriod.status\": \"Resolved\",\n            \"infoRequests.longerPeriod.response\": \"Accepted\",\n            longerPeriodAcceptedDiscount: discount,\n            minPriceEstimate: newPrice\n        });\n        triggerLongerPeriodToastClose.click();\n        setTimeout(function () { location.reload(); }, 300);\n    });\n    // Decline longer selling period and quit sales\n    longerPeriodDenyButton.addEventListener('click', async function () {\n        await db.collection('items').doc(itemId).update({\n            \"infoRequests.longerPeriod.status\": \"Resolved\",\n            \"infoRequests.longerPeriod.response\": \"Denied\",\n            \"status\": \"Unsold\" // This field is normally mastered by AT - I do this for the user to see the effect immediately (the card is removed)\n        });\n        triggerLongerPeriodToastClose.click();\n        setTimeout(function () { location.reload(); }, 300);\n    });\n    triggerLongerPeriodToastOpen.click();\n}\n\nasync function storePriceResponse(itemId, max, min, response, status) {\n    console.log(\"storePriceResponse\", itemId, max, min, response);\n    // Accept price\n    if (response === \"Accepted\") {\n        await db.collection('items').doc(itemId).update({\n            \"infoRequests.price.status\": \"Resolved\",\n            \"infoRequests.price.response\": \"Accepted\",\n            \"maxPriceEstimate\": max,\n            \"minPriceEstimate\": min\n        }).then(function () {\n            triggerNewPriceToastClose.click();\n            setTimeout(function () { location.reload(); }, 300);\n        });\n    }\n    // Deny price\n    if (response === \"Denied\") {\n        let fields = {\n            \"infoRequests.price.status\": \"Resolved\",\n            \"infoRequests.price.response\": \"Denied\"\n        };\n        if (status === \"New\") {\n            fields[\"archived\"] = true;\n            fields[\"willNotSell\"] = true;\n        }\n        await db.collection('items').doc(itemId).update(fields).then(function () {\n            triggerNewPriceToastClose.click();\n            setTimeout(function () { location.reload(); }, 300);\n        });\n    }\n}\n\nasync function openNewPriceToast(itemId, status, max, min, brand, description, category, type, currentMax, currentMin) {\n    console.log(\"openNewPriceToast\", itemId, status, max, min, brand, description, category, type, currentMax, currentMin);\n    previousMinPrice.style.display = 'none';\n    previousMaxPrice.style.display = 'none';\n    maxPriceDiv.style.display = 'block';\n    minPriceDiv.style.display = 'block';\n\n    // Set content of toast\n    newPriceToastTitle.innerHTML = \"Nytt lägsta pris\";\n    newPriceHeading.innerHTML = `${brand}-plagg`;\n    const c = category.toLowerCase();\n    if (c && c !== \"null\") { newPriceHeading.innerHTML = `${brand}-${c}`; }\n    maxPrice.innerHTML = max;\n    minPrice.innerHTML = min;\n    if (currentMax && currentMax !== 'null' && currentMax !== '' && currentMax !== 'undefined' && max !== currentMax){\n        previousMaxPrice.innerHTML = currentMax;\n        previousMaxPrice.style.display = 'block';\n    }\n    if (currentMin && currentMin !== 'null' && currentMin !== '' && currentMin !== 'undefined' && min !== currentMin){\n        previousMinPrice.innerHTML = currentMin;\n        previousMinPrice.style.display = 'block';\n    }\n    acceptNewPriceButton.innerHTML = \"Sälj med nytt pris\";\n    denyNewPriceButton.innerHTML = \"Sänk ej\";\n\n    if (status === \"New\" && type === 'Valuation') {\n        newPriceToastTitle.innerHTML = \"Värdering\";\n        acceptNewPriceButton.innerHTML = \"Sälj till värdering\";\n        denyNewPriceButton.innerHTML = \"Avböj och avsluta\";\n    }\n    if (type === 'Adjusted ML Valuation'){\n        newPriceToastTitle.innerHTML = \"Nytt prisintervall\";\n\n    }\n    if (type !== 'Valuation' && type !== 'Adjusted ML Valuation'){ //Custom lowered price and automatic price dump cases\n        minPrice.innerHTML = `${min} kr`;\n        maxPriceDiv.style.display = 'none';\n    }\n    if (description && description !== 'undefined' && description !== '' && description !== 'null') {\n        newPriceText.innerHTML = description;\n        descriptionDiv.style.display = 'block';\n    }\n    acceptNewPriceButton.href = `javascript:storePriceResponse('${itemId}', ${max}, ${min}, 'Accepted', '${status}');`;\n    denyNewPriceButton.href = `javascript:storePriceResponse('${itemId}', ${max}, ${min}, 'Denied', '${status}');`;\n\n    // Open toast\n    triggerNewPriceToastOpen.click();\n}\n\nexport function loadInfoRequests(userId) {\n    infoRequestsList.innerHTML = \"\";\n    db.collection(\"items\").where(\"user\", \"==\", userId).get().then((querySnapshot) => {\n        querySnapshot.forEach((doc) => {\n            var itemId = doc.id;\n            var item = doc.data();\n            var infoRequests = item.infoRequests;\n            var status = item.status;\n            var brand = item.brand.replace(/'/g, '');\n            var currentMinPrice = item.minPriceEstimate;\n            var currentMaxPrice = item.maxPriceEstimate;\n            var deniedBefore = item?.infoRequests?.price?.response === \"Denied\" ? true : false;\n            var archived = item.archived;\n            var category = item.category;\n            const images = item.images;\n            var frontImageUrl = itemCoverImage(item);\n            if (archived == undefined && status !== \"Unsold\" && status !== \"Sold\" && infoRequests) {\n                displayRequests();\n            }\n\n            function displayRequests() {\n                for (const req in infoRequests) {\n                    if (infoRequests[req]?.status === \"Active\") {\n                        let title = \"\";\n                        let subText = \"\";\n                        let href = \"\";\n                        let buttonText = `Komplettera`;\n                        let buttonClass = \"completerequestbutton\";\n                        let buttonTextClass = \"text-block-69\";\n                        let description = infoRequests[req].description;\n                        \n                        if (description) { description = description.replace(/'/g, ''); }\n                        // PRICE REQUEST\n                        if (req === \"price\") {\n                            const type = infoRequests[req].type;\n                            title = \"Lägre pris\";\n                            buttonClass = \"acceptnewpricebutton\";\n                            buttonTextClass = \"text-block-69-copy-copy\";\n                            buttonText = \"Se prisförslag\";\n                            subText = \"Vill du sänka priset och få det sålt?\";\n                            const max = infoRequests[req].maxPrice;\n                            const min = infoRequests[req].minPrice;\n                            href = `javascript:openNewPriceToast('${itemId}', '${status}', ${max}, ${min}, '${brand}', '${description}', '${category}', '${type}', '${currentMaxPrice}', '${currentMinPrice}');`;\n                            if (status === \"New\" && type !== 'Adjusted ML Valuation') {\n                                title = \"Värdering\";\n                                buttonClass = \"acceptnewpricebutton\";\n                                buttonTextClass = \"text-block-69-copy-copy\";\n                                buttonText = \"Se värdering\";\n                                subText = \"Vill du sälja till vår värdering?\";\n                                href = `/item-valuation?id=${itemId}`;\n                            }\n                        }\n                        // MEASUREMENTS REQUEST\n                        if (req === \"measurements\") {\n                            title = \"Mått\";\n                            subText = \"Vi behöver mått för detta plagg\";\n                            buttonText = \"Se mer\";\n                            href = `javascript:openMeasurementsToast('${itemId}', '${description}');`;\n                        }\n                        // IMAGES REQUEST\n                        if (req === \"images\") {\n                            title = \"Bilder\";\n                            subText = \"Bilderna behöver kompletteras\";\n                            buttonText = \"Ändra bilder\";\n                            href = window.location.origin + `/edit-item?id=${itemId}`;\n                        }\n                        // LONGER PERIOD REQUEST\n                        if (req === \"longerPeriod\") {\n                            title = \"Förläng\";\n                            subText = \"Vill du förlänga med 30 dagar till?\";\n                            buttonText = \"Svara\";\n                            href = `javascript:openLongerPeriodToast('${itemId}', '${brand}', ${currentMinPrice}, ${deniedBefore});`;\n                        }\n                        // CARD\n                        let card = `<div class=\"div-block-126\">\n                                                <div class=\"ratio-box _16-9\">\n                                                    <div class=\"content-block with-image\">\n                                                        <div class=\"img-container\" style=\"background-image: url('${frontImageUrl}');\"></div>\n                                                    </div>\n                                                </div>\n                                                <div class=\"text-block-73\">${title}</div>\n                                                <div class=\"text-block-72\">${subText}</div>\n                                                <a href=\"${href}\" id=\"\" class=\"link-block-23 w-inline-block\">\n                                                    <div class=\"${buttonClass}\">\n                                                        <div class=\"${buttonTextClass}\">${buttonText}</div>\n                                                    </div>\n                                                </a>\n                                            </div>`;\n                        infoRequestsList.innerHTML += card;\n                        infoRequestsDiv.style.display = \"block\";\n                    }\n                }\n            }\n        });\n    });\n}\n","function signOut() {\n    firebase.auth().signOut().then(() => {\n        console.log('User signed out');\n        authUser.current = null;\n        user.current = null;\n        userId = null;\n        location.href = '/';\n        deleteCookie('maiAuth');\n    }).catch((error) => {\n        errorHandler.report(error);\n        console.log(error);\n    });\n}\n\nexport function setFormAddressFields(user) {\n    document.getElementById(\"addressFirstName\").value = user.addressFirstName || '';\n    document.getElementById(\"addressFirstName\").dispatchEvent(new Event('input'));\n    document.getElementById(\"addressLastName\").value = user.addressLastName || '';\n    document.getElementById(\"addressLastName\").dispatchEvent(new Event('input'));\n    document.getElementById(\"addressStreetAddress\").value = user.addressStreetAddress || '';\n    document.getElementById(\"addressStreetAddress\").dispatchEvent(new Event('input'));\n    document.getElementById(\"addressCO\").value = user.addressCO || '';\n    document.getElementById(\"addressCO\").dispatchEvent(new Event('input'));\n    document.getElementById(\"addressPostalCode\").value = user.addressPostalCode || '';\n    document.getElementById(\"addressPostalCode\").dispatchEvent(new Event('input'));\n    document.getElementById(\"addressCity\").value = user.addressCity || '';\n    document.getElementById(\"addressCity\").dispatchEvent(new Event('input'));\n    document.getElementById(\"addressDoorCode\").value = user.addressDoorCode || '';\n    document.getElementById(\"addressDoorCode\").dispatchEvent(new Event('input'));\n}\nexport function getFormAddressFields() {\n    let addressFirstName = document.getElementById(\"addressFirstName\").value;\n    let addressLastName = document.getElementById(\"addressLastName\").value;\n    let addressStreetAddress = document.getElementById(\"addressStreetAddress\").value;\n    let addressCO = document.getElementById(\"addressCO\").value;\n    let addressPostalCode = document.getElementById(\"addressPostalCode\").value;\n    let addressCity = document.getElementById(\"addressCity\").value;\n    let addressDoorCode = document.getElementById(\"addressDoorCode\").value;\n\n    addressFirstName = addressFirstName ? addressFirstName.trim().charAt(0).toUpperCase() + addressFirstName.trim().slice(1) : \"\";\n    addressLastName = addressLastName ? addressLastName.trim().charAt(0).toUpperCase() + addressLastName.trim().slice(1) : \"\";\n    addressStreetAddress = addressStreetAddress ? addressStreetAddress.trim().charAt(0).toUpperCase() + addressStreetAddress.trim().slice(1) : \"\";\n    addressCO = addressCO ? addressCO.trim() : \"\";\n    addressPostalCode = addressPostalCode ? addressPostalCode.trim().replace(/\\D/g, '') : \"\";\n    addressCity = addressCity ? addressCity.trim().charAt(0).toUpperCase() + addressCity.trim().slice(1) : \"\";\n    addressDoorCode = addressDoorCode ? addressDoorCode.trim() : \"\";\n    return { addressFirstName, addressLastName, addressStreetAddress, addressCO, addressPostalCode, addressCity, addressDoorCode };\n}\n\n\n// Validate Swedish Social Security Number (personnummer) using checksum\n//   Note: this is somewhat simplified because it does not take into account\n//   that the date of the number is valid (e.g. \"000000-0000\" does return as true)\nexport function isValidSwedishSsn(ssn) {\n    ssn = ssn\n        .replace(/\\D/g, \"\")     // strip out all but digits\n        .split(\"\")              // convert string to array\n        .reverse()              // reverse order for Luhn\n        .slice(0, 10);          // keep only 10 digits (i.e. 1977 becomes 77)\n\n    // verify we got 10 digits, otherwise it is invalid\n    if (ssn.length !== 10) {\n        return false;\n    }\n    const sum = ssn.map((n) => Number(n))\n        .reduce((previous, current, index) => {\n            if (index % 2) current *= 2;\n            if (current > 9) current -= 9;\n            return previous + current;\n        });\n    return 0 === sum % 10;\n}\n\n\nexport function formatPersonalId(personalIdInput) {\n    let personalId = personalIdInput.replace('-', '');\n    if (personalId.length !== 12 && (personalId.substring(0, 2) !== '19' || personalId.substring(0, 2) !== '20')) {\n        if (Number(personalId.substring(0, 2)) <= 99 && Number(personalId.substring(0, 2)) > 25) {\n            personalId = \"19\" + personalId;\n        } else {\n            personalId = \"20\" + personalId;\n        }\n    }\n    if (personalId.length === 12) {\n        return personalId;\n    }\n    return null;\n}\n\nexport function itemCoverImage(item) {\n    const images = item.images;\n    if (images.modelImage) {\n        return images.modelImageSmall || images.modelImage\n    }\n    if (images.coverImage) {\n        return images.coverImageSmall || images.coverImage\n    }\n    if (images.enhancedFrontImage) {\n        return images.enhancedFrontImageSmall || images.enhancedFrontImage\n    }\n    return images.frontImageSmall || images.frontImage\n}\n\n\nexport function shareCode() {\n    const code = user.current.referralData.referralCode;\n    const text = `Hej, jag vill tipsa om Mai för att rensa ur garderoben. Mai är en tjänst som hjälper dig att sälja dina kläder på ett enkelt sätt. Man tar bara bilder på sina plagg, sedan sköter Mai resten - såsom värdering, annonsering på flera plattformar, kontakt med köpare och frakt när det blir sålt. Man får själv behålla 80% av vinsten, och blir det inte sålt kostar det ingenting.\\n\\nOm du registrerar dig med min kod (följ länken) och provar sälja ett plagg inom 7 dagar får du behålla 100% av vinsten för det första plagget (istället för 80%). Min kod: ${code}\\n\\nLäs mer och använd min kod här:`\n    if (navigator.share) {\n        navigator.share({\n            text: text,\n            url: `https://maiapp.se/?invite=${code}`\n        }).then(() => { console.log('Thanks for sharing!'); }).catch((e) => {\n            console.error(e);\n            errorHandler.report(e);\n        });\n    } else {\n        console.log(\"Browser doesn't support navigator.share => Copy to clipboard!\");\n        const shareText = text + \"\\n\" + `https://maiapp.se/?invite=${code}`;\n        navigator.clipboard.writeText(shareText);\n        linkCopiedBanner.style.display = 'flex';\n        setTimeout(function () { linkCopiedBanner.style.display = 'none'; }, 1500);\n    }\n}\n"],"names":[],"version":3,"file":"infoRequestsFunctions.js.map"}