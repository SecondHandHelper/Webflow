!function(){let e;function t(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}async function n(e,t){sessionStorage.getItem("newItemId")||sessionStorage.setItem("newItemId",await i());let n=sessionStorage.getItem("newItemId"),o=await r(e);if(!o)throw"Fel vid bearbetning av vald bild.";let a=new FormData;a.append("itemId",n),a.append("fileName",t),a.append("file",o),a.append("temporary","true"),a.append("generateSmallImage","true");let l=await fetch("https://uploaditemimagebinary-heypmjzjfq-ew.a.run.app",{method:"POST",body:a});return await l.json()}async function r(e){return e.size<9437184?Promise.resolve(e):new Promise((t,n)=>{let r=new FileReader;r.onload=()=>{let e=document.createElement("img");e.onload=()=>{let n=e.width,r=e.height;n>r?n>1512&&(r*=1512/n,n=1512):r>2016&&(n*=2016/r,r=2016);let i=document.createElement("canvas");i.width=n,i.height=r;let o=i.getContext("2d");o.imageSmoothingQuality="high",o.drawImage(e,0,0,n,r),i.toBlob(t,"image/jpeg")},e.src=r.result,r.onerror=n},r.readAsDataURL(e)})}async function i(){try{let e=await fetch("https://generateuniqueid-heypmjzjfq-ew.a.run.app",{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)return console.error(`Error: ${e.statusText}`),null;let t=await e.json();return t.id}catch(e){return console.error(`Failed to fetch unique ID, generating uuidv4 id: ${e.message}`,e),uuidv4()}}async function o(e,t=!0){let n=await a(e);return n?.url&&(t&&s("enhancedFrontImage",n.url,n.urlSmall),d("frontImage",window.innerWidth<=400?n.urlSmall:n.url)),l("frontImage"),n}async function a(e){try{let t=await firebase.app().functions("europe-west1").httpsCallable("enhanceFrontImage")({imageUrl:e});return sessionStorage.setItem("enhancedFrontImage",t.data.url),t.data}catch(e){return errorHandler.report(e),console.error(e),""}}function l(e){document.getElementById(`loading${c(e)}Icon`).style.display="none",document.getElementById(`delete${c(e)}Icon`).style.display="inline-block","frontImage"===e&&(document.getElementById("enhancedAnimationDiv").style.display="none")}function s(e,t,n){let r=JSON.parse(localStorage.getItem("newItem")||JSON.stringify({})),i=r.images||{};i[e]=t,i[`${e}Small`]=n,r.images=i,localStorage.setItem("newItem",JSON.stringify(r))}function d(e,t){document.getElementById(`${e}Preview`).style.backgroundImage=`url('${t}')`,l(e)}function c(e){return e.charAt(0).toUpperCase()+e.slice(1)}async function u(e,t,r=!0){try{!function(e){let t=document.getElementById(e).parentNode.parentNode;t.querySelector(".w-file-upload-error").style.display="none"}(t);let i=URL.createObjectURL(e);document.getElementById(`${t}PreviewUploading`).style.backgroundImage=`url('${i}')`,document.getElementById(`${t}Preview`).style.backgroundImage=`url('${i}')`,f(t),g(t,"success-state");let{url:o,urlSmall:a}=await n(e,t);return r&&s(t,o,a),o}catch(n){console.error("Failed to upload image",n),errorHandler.report(n),document.getElementById(`${t}PreviewUploading`).style.backgroundImage="",document.getElementById(`${t}Preview`).style.backgroundImage="",document.getElementById(`loading${c(t)}Icon`).style.display="none",g(t,"default-state"),e.size>10485760?m(t,"Error: Bilden \xe4r f\xf6r stor. Max 10 MB."):m(t,"Error: N\xe5got gick fel vid uppladdning, f\xf6rs\xf6k igen eller kontakt oss om felet kvarst\xe5r."),document.getElementById(t).value=""}}function m(e,t){let n=document.getElementById(e).parentNode.parentNode;n.querySelector(".w-file-upload-error").style.display="block",n.querySelector(".w-file-upload-error-msg").innerText=t}function g(e,t){let n=document.getElementById(e).parentNode.parentNode.childNodes;for(let e=0;e<n.length;e++)n[e].className.includes(t)?n[e].style.display="block":n[e].style.display="none"}function f(e){if("frontImage"===e){document.getElementById(`delete${c(e)}Icon`).style.display="none",document.getElementById("enhancedAnimationDiv").style.display="block",triggerEnhancingAnimation.click();return}document.getElementById(`loading${c(e)}Icon`).style.display="inline-block",document.getElementById(`delete${c(e)}Icon`).style.display="none"}var h,p,y,I,v,x,w,S,E,B,b,k,C,A,L,P,T,M,N,q,F,V,j,U,D,z,R,O,_,J,K,H,W,Q,G,Y,Z,X,ee,et,en,er,ei,eo,ea,el,es,ed,ec,eu,em,eg,ef,eh,ep,ey,eI,ev,ex={};t(ex,"create",function(){return h},function(e){return h=e}),t(ex,"toCanvas",function(){return p},function(e){return p=e}),t(ex,"toDataURL",function(){return y},function(e){return y=e}),t(ex,"toString",function(){return I},function(e){return I=e});var ew={};// can-promise has a crash in some versions of react native that dont have
// standard global objects
// https://github.com/soldair/node-qrcode/issues/157
ew=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then};let eS=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];x=function(e){if(!e)throw Error('"version" cannot be null or undefined');if(e<1||e>40)throw Error('"version" should be in range from 1 to 40');return 4*e+17},w=function(e){return eS[e]},S=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},E=function(t){if("function"!=typeof t)throw Error('"toSJISFunc" is not a valid function.');e=t},B=function(){return void 0!==e},b={bit:1},k={bit:0},C={bit:3},A={bit:2},L=function(e,t){if(e&&void 0!==e.bit&&e.bit>=0&&e.bit<4)return e;try{return function(e){if("string"!=typeof e)throw Error("Param is not a string");let t=e.toLowerCase();switch(t){case"l":case"low":return b;case"m":case"medium":return k;case"q":case"quartile":return C;case"h":case"high":return A;default:throw Error("Unknown EC Level: "+e)}}(e)}catch(e){return t}};var eE={};function eB(){this.buffer=[],this.length=0}eB.prototype={get:function(e){return(this.buffer[Math.floor(e/8)]>>>7-e%8&1)==1},put:function(e,t){for(let n=0;n<t;n++)this.putBit((e>>>t-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){let t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},eE=eB;var eb={};/**
 * Helper class to handle QR Code symbol modules
 *
 * @param {Number} size Symbol size
 */function ek(e){if(!e||e<1)throw Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}/**
 * Set bit value at specified location
 * If reserved flag is set, this bit will be ignored during masking process
 *
 * @param {Number}  row
 * @param {Number}  col
 * @param {Boolean} value
 * @param {Boolean} reserved
 */ek.prototype.set=function(e,t,n,r){let i=e*this.size+t;this.data[i]=n,r&&(this.reservedBit[i]=!0)},/**
 * Returns bit value at specified location
 *
 * @param  {Number}  row
 * @param  {Number}  col
 * @return {Boolean}
 */ek.prototype.get=function(e,t){return this.data[e*this.size+t]},/**
 * Applies xor operator at specified location
 * (used during masking process)
 *
 * @param {Number}  row
 * @param {Number}  col
 * @param {Boolean} value
 */ek.prototype.xor=function(e,t,n){this.data[e*this.size+t]^=n},/**
 * Check if bit at specified location is reserved
 *
 * @param {Number}   row
 * @param {Number}   col
 * @return {Boolean}
 */ek.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},eb=ek,P=function(e){if(1===e)return[];let t=Math.floor(e/7)+2,n=x(e),r=145===n?26:2*Math.ceil((n-13)/(2*t-2)),i=[n-7]// Last coord is always (size - 7)
;for(let e=1;e<t-1;e++)i[e]=i[e-1]-r;return i.push(6)// First coord is always 6
,i.reverse()},T=function(e){let t=[],n=P(e),r=n.length;for(let e=0;e<r;e++)for(let i=0;i<r;i++)// Skip if position is occupied by finder patterns
(0!==e||0!==i)&&// top-left
(0!==e||i!==r-1)&&// bottom-left
(e!==r-1||0!==i)&&t.push([n[e],n[i]]);return t},M=function(e){let t=x(e);return[// top-left
[0,0],// top-right
[t-7,0],// bottom-left
[0,t-7]]},N={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};/**
 * Weighted penalty scores for the undesirable features
 * @type {Object}
 */let eC={N1:3,N2:3,N3:40,N4:10};q=function(e){let t=e.size,n=0,r=0,i=0,o=null,a=null;for(let l=0;l<t;l++){r=i=0,o=a=null;for(let s=0;s<t;s++){let t=e.get(l,s);t===o?r++:(r>=5&&(n+=eC.N1+(r-5)),o=t,r=1),(t=e.get(s,l))===a?i++:(i>=5&&(n+=eC.N1+(i-5)),a=t,i=1)}r>=5&&(n+=eC.N1+(r-5)),i>=5&&(n+=eC.N1+(i-5))}return n},F=function(e){let t=e.size,n=0;for(let r=0;r<t-1;r++)for(let i=0;i<t-1;i++){let t=e.get(r,i)+e.get(r,i+1)+e.get(r+1,i)+e.get(r+1,i+1);(4===t||0===t)&&n++}return n*eC.N2},V=function(e){let t=e.size,n=0,r=0,i=0;for(let o=0;o<t;o++){r=i=0;for(let a=0;a<t;a++)r=r<<1&2047|e.get(o,a),a>=10&&(1488===r||93===r)&&n++,i=i<<1&2047|e.get(a,o),a>=10&&(1488===i||93===i)&&n++}return n*eC.N3},j=function(e){let t=0,n=e.data.length;for(let r=0;r<n;r++)t+=e.data[r];let r=Math.abs(Math.ceil(100*t/n/5)-10);return r*eC.N4},U=function(e,t){let n=t.size;for(let r=0;r<n;r++)for(let i=0;i<n;i++)t.isReserved(i,r)||t.xor(i,r,/**
 * Return mask value at given position
 *
 * @param  {Number} maskPattern Pattern reference value
 * @param  {Number} i           Row
 * @param  {Number} j           Column
 * @return {Boolean}            Mask value
 */function(e,t,n){switch(e){case N.PATTERN000:return(t+n)%2==0;case N.PATTERN001:return t%2==0;case N.PATTERN010:return n%3==0;case N.PATTERN011:return(t+n)%3==0;case N.PATTERN100:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case N.PATTERN101:return t*n%2+t*n%3==0;case N.PATTERN110:return(t*n%2+t*n%3)%2==0;case N.PATTERN111:return(t*n%3+(t+n)%2)%2==0;default:throw Error("bad maskPattern:"+e)}}(e,i,r))},D=function(e,t){let n=Object.keys(N).length,r=0,i=1/0;for(let o=0;o<n;o++){t(o),U(o,e);// Calculate penalty
let n=q(e)+F(e)+V(e)+j(e);// Undo previously applied mask
U(o,e),n<i&&(i=n,r=o)}return r};let eA=[// L  M  Q  H
1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],eL=[// L  M  Q  H
7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];z=function(e,t){switch(t){case b:return eA[(e-1)*4+0];case k:return eA[(e-1)*4+1];case C:return eA[(e-1)*4+2];case A:return eA[(e-1)*4+3];default:return}},R=function(e,t){switch(t){case b:return eL[(e-1)*4+0];case k:return eL[(e-1)*4+1];case C:return eL[(e-1)*4+2];case A:return eL[(e-1)*4+3];default:return}};var eP={};let eT=new Uint8Array(512),eM=new Uint8Array(256)/**
 * Precompute the log and anti-log tables for faster computation later
 *
 * For each possible value in the galois field 2^8, we will pre-compute
 * the logarithm and anti-logarithm (exponential) of this value
 *
 * ref {@link https://en.wikiversity.org/wiki/Reed%E2%80%93Solomon_codes_for_coders#Introduction_to_mathematical_fields}
 */;function eN(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}!function(){let e=1;for(let t=0;t<255;t++)eT[t]=e,eM[e]=t,256&(e<<=1// multiply by 2
)&&(e^=285);// Optimization: double the size of the anti-log table so that we don't need to mod 255 to
// stay inside the bounds (because we will mainly use this table for the multiplication of
// two GF numbers, no more).
// @see {@link mul}
for(let e=255;e<512;e++)eT[e]=eT[e-255]}(),K=function(e,t){return 0===e||0===t?0:eT[eM[e]+eM[t]]},O=function(e,t){let n=new Uint8Array(e.length+t.length-1);for(let r=0;r<e.length;r++)for(let i=0;i<t.length;i++)n[r+i]^=K(e[r],t[i]);return n},_=function(e,t){let n=new Uint8Array(e);for(;n.length-t.length>=0;){let e=n[0];for(let r=0;r<t.length;r++)n[r]^=K(t[r],e);// remove all zeros from buffer head
let r=0;for(;r<n.length&&0===n[r];)r++;n=n.slice(r)}return n},J=function(e){let t=new Uint8Array([1]);for(let n=0;n<e;n++)t=O(t,new Uint8Array([1,eT[n]]));return t},/**
 * Initialize the encoder.
 * The input param should correspond to the number of error correction codewords.
 *
 * @param  {Number} degree
 */eN.prototype.initialize=function(e){// create an irreducible generator polynomial
this.degree=e,this.genPoly=J(this.degree)},/**
 * Encodes a chunk of data
 *
 * @param  {Uint8Array} data Buffer containing input data
 * @return {Uint8Array}      Buffer containing encoded data
 */eN.prototype.encode=function(e){if(!this.genPoly)throw Error("Encoder not initialized");// Calculate EC for this data block
// extends data size to data+genPoly size
let t=new Uint8Array(e.length+this.degree);t.set(e);// The error correction codewords are the remainder after dividing the data codewords
// by a generator polynomial
let n=_(t,this.genPoly),r=this.degree-n.length;if(r>0){let e=new Uint8Array(this.degree);return e.set(n,r),e}return n},eP=eN,ei=function(e){return!isNaN(e)&&e>=1&&e<=40};let eq="[0-9]+",eF="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";eF=eF.replace(/u/g,"\\u");let eV="(?:(?![A-Z0-9 $%*+\\-./:]|"+eF+")(?:.|[\r\n]))+";eo=RegExp(eF,"g"),ea=RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),el=RegExp(eV,"g"),es=RegExp(eq,"g"),ed=RegExp("[A-Z $%*+\\-./:]+","g");let e$=RegExp("^"+eF+"$"),ej=RegExp("^"+eq+"$"),eU=RegExp("^[A-Z0-9 $%*+\\-./:]+$");G={id:"Numeric",bit:1,ccBits:[10,12,14]},Y={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},Z={id:"Byte",bit:4,ccBits:[8,16,16]},X={id:"Kanji",bit:8,ccBits:[8,10,12]},ee={bit:-1},et=function(e,t){if(!e.ccBits)throw Error("Invalid mode: "+e);if(!ei(t))throw Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]},en=function(e){if(e&&e.id)return e.id;throw Error("Invalid mode")},er=function(e,t){if(e&&e.bit&&e.ccBits)return e;try{return(/**
 * Get mode object from its name
 *
 * @param   {String} string Mode name
 * @returns {Mode}          Mode object
 */function(e){if("string"!=typeof e)throw Error("Param is not a string");let t=e.toLowerCase();switch(t){case"numeric":return G;case"alphanumeric":return Y;case"kanji":return X;case"byte":return Z;default:throw Error("Unknown mode: "+e)}}(e))}catch(e){return t}};let eD=S(7973);H=function(e,t,n){if(!ei(e))throw Error("Invalid QR Code version");// Use Byte mode as default
void 0===n&&(n=Z);// Total codewords for this QR code version (Data + Error correction)
let r=w(e),i=R(e,t),o=(r-i)*8;if(n===ee)return o;let a=o-(et(n,e)+4);// Return max number of storable codewords
switch(n){case G:return Math.floor(a/10*3);case Y:return Math.floor(a/11*2);case X:return Math.floor(a/13);default:return Math.floor(a/8)}},W=function(e,t){let n;let r=L(t,k);if(Array.isArray(e)){if(e.length>1)return function(e,t){for(let n=1;n<=40;n++){let r=function(e,t){let n=0;return e.forEach(function(e){let r=et(e.mode,t)+4;n+=r+e.getBitsLength()}),n}(e,n);if(r<=H(n,t,ee))return n}}(e,r);if(0===e.length)return 1;n=e[0]}else n=e;return function(e,t,n){for(let r=1;r<=40;r++)if(t<=H(r,n,e))return r}(n.mode,n.getLength(),r)},Q=function(e){if(!ei(e)||e<7)throw Error("Invalid QR Code version");let t=e<<12;for(;S(t)-eD>=0;)t^=7973<<S(t)-eD;return e<<12|t};let ez=S(1335);ec=function(e,t){let n=e.bit<<3|t,r=n<<10;for(;S(r)-ez>=0;)r^=1335<<S(r)-ez;// xor final data with mask pattern in order to ensure that
// no combination of Error Correction Level and data mask pattern
// will result in an all-zero data string
return(n<<10|r)^21522};var eR={};function eO(e){this.mode=G,this.data=e.toString()}eO.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},eO.prototype.getLength=function(){return this.data.length},eO.prototype.getBitsLength=function(){return eO.getBitsLength(this.data.length)},eO.prototype.write=function(e){let t,n;// The input data string is divided into groups of three digits,
// and each group is converted to its 10-bit binary equivalent.
for(t=0;t+3<=this.data.length;t+=3)n=parseInt(this.data.substr(t,3),10),e.put(n,10);// If the number of input digits is not an exact multiple of three,
// the final one or two digits are converted to 4 or 7 bits respectively.
let r=this.data.length-t;r>0&&(n=parseInt(this.data.substr(t),10),e.put(n,3*r+1))},eR=eO;var e_={};/**
 * Array of characters available in alphanumeric mode
 *
 * As per QR Code specification, to each character
 * is assigned a value from 0 to 44 which in this case coincides
 * with the array index
 *
 * @type {Array}
 */let eJ=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function eK(e){this.mode=Y,this.data=e}eK.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)},eK.prototype.getLength=function(){return this.data.length},eK.prototype.getBitsLength=function(){return eK.getBitsLength(this.data.length)},eK.prototype.write=function(e){let t;// Input data characters are divided into groups of two characters
// and encoded as 11-bit binary codes.
for(t=0;t+2<=this.data.length;t+=2){// The character value of the first character is multiplied by 45
let n=45*eJ.indexOf(this.data[t]);// The character value of the second digit is added to the product
n+=eJ.indexOf(this.data[t+1]),// The sum is then stored as 11-bit binary number
e.put(n,11)}// If the number of input data characters is not a multiple of two,
// the character value of the final character is encoded as a 6-bit binary number.
this.data.length%2&&e.put(eJ.indexOf(this.data[t]),6)},e_=eK;var eH={},eW={};function eQ(e){this.mode=Z,"string"==typeof e&&(e=eW(e)),this.data=new Uint8Array(e)}eW=function(e){for(var t=[],n=e.length,r=0;r<n;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319&&n>r+1){var o=e.charCodeAt(r+1);o>=56320&&o<=57343&&(// https://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae
i=(i-55296)*1024+o-56320+65536,r+=1)}// US-ASCII
if(i<128){t.push(i);continue}// 2-byte UTF-8
if(i<2048){t.push(i>>6|192),t.push(63&i|128);continue}// 3-byte UTF-8
if(i<55296||i>=57344&&i<65536){t.push(i>>12|224),t.push(i>>6&63|128),t.push(63&i|128);continue}// 4-byte UTF-8
if(i>=65536&&i<=1114111){t.push(i>>18|240),t.push(i>>12&63|128),t.push(i>>6&63|128),t.push(63&i|128);continue}// Invalid character
t.push(239,191,189)}return new Uint8Array(t).buffer},eQ.getBitsLength=function(e){return 8*e},eQ.prototype.getLength=function(){return this.data.length},eQ.prototype.getBitsLength=function(){return eQ.getBitsLength(this.data.length)},eQ.prototype.write=function(e){for(let t=0,n=this.data.length;t<n;t++)e.put(this.data[t],8)},eH=eQ;var eG={};function eY(e){this.mode=X,this.data=e}eY.getBitsLength=function(e){return 13*e},eY.prototype.getLength=function(){return this.data.length},eY.prototype.getBitsLength=function(){return eY.getBitsLength(this.data.length)},eY.prototype.write=function(t){let n;// In the Shift JIS system, Kanji characters are represented by a two byte combination.
// These byte values are shifted from the JIS X 0208 values.
// JIS X 0208 gives details of the shift coded representation.
for(n=0;n<this.data.length;n++){var r;let i=(r=this.data[n],e(r));// For characters with Shift JIS values from 0x8140 to 0x9FFC:
if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw Error("Invalid SJIS character: "+this.data[n]+"\nMake sure your charset is UTF-8");// Multiply most significant byte of result by 0xC0
// and add least significant byte to product
i=(i>>>8&255)*192+(255&i),// Convert result to a 13-bit binary string
t.put(i,13)}},eG=eY;var eZ={},eX={single_source_shortest_paths:function(e,t,n){// Predecessor map for each node that has been encountered.
// node ID => predecessor node ID
var r,i,o,a,l,s,d,c={},u={};u[t]=0;// Costs of shortest paths from s to all nodes encountered; differs from
// `costs` in that it provides easy access to the node that currently has
// the known shortest path from s.
// XXX: Do we actually need both `costs` and `open`?
var m=eX.PriorityQueue.make();for(m.push(t,0);!m.empty();)// ...and explore the edges that connect u to those nodes, updating
// the cost of the shortest paths to any or all of those nodes as
// necessary. v is the node across the current edge from u.
for(o in i=// In the nodes remaining in graph that have a known cost from s,
// find the node, u, that currently has the shortest path from s.
(r=m.pop()).value,a=r.cost,// Get nodes adjacent to u...
l=e[i]||{})l.hasOwnProperty(o)&&(// Cost of s to u plus the cost of u to v across e--this is *a*
// cost from s to v that may or may not be less than the current
// known cost to v.
s=a+l[o],// If we haven't visited v yet OR if the current known cost from s to
// v is greater than the new cost we just found (cost of s to u plus
// cost of u to v across e), update v's cost in the cost list and
// update v's predecessor in the predecessor list (it's now u).
d=u[o],(void 0===u[o]||d>s)&&(u[o]=s,m.push(o,s),c[o]=i));if(void 0!==n&&void 0===u[n])throw Error(["Could not find a path from ",t," to ",n,"."].join(""));return c},extract_shortest_path_from_predecessor_list:function(e,t){for(var n=[],r=t;r;)n.push(r),e[r],r=e[r];return n.reverse(),n},find_path:function(e,t,n){var r=eX.single_source_shortest_paths(e,t,n);return eX.extract_shortest_path_from_predecessor_list(r,n)},/**
   * A very naive priority queue implementation.
   */PriorityQueue:{make:function(e){var t,n=eX.PriorityQueue,r={};for(t in e=e||{},n)n.hasOwnProperty(t)&&(r[t]=n[t]);return r.queue=[],r.sorter=e.sorter||n.default_sorter,r},default_sorter:function(e,t){return e.cost-t.cost},/**
     * Add a new item to the queue and ensure the highest priority element
     * is at the front of the queue.
     */push:function(e,t){this.queue.push({value:e,cost:t}),this.queue.sort(this.sorter)},/**
     * Return the highest priority element in the queue.
     */pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};/**
 * Returns UTF8 byte length
 *
 * @param  {String} str Input string
 * @return {Number}     Number of byte
 */function e0(e){return unescape(encodeURIComponent(e)).length}/**
 * Get a list of segments of the specified mode
 * from a string
 *
 * @param  {Mode}   mode Segment mode
 * @param  {String} str  String to process
 * @return {Array}       Array of object with segments data
 */function e1(e,t,n){let r;let i=[];for(;null!==(r=e.exec(n));)i.push({data:r[0],index:r.index,mode:t,length:r[0].length});return i}/**
 * Extracts a series of segments with the appropriate
 * modes from a string
 *
 * @param  {String} dataStr Input string
 * @return {Array}          Array of object with segments data
 */function e2(e){let t,n;let r=e1(es,G,e),i=e1(ed,Y,e);B()?(t=e1(el,Z,e),n=e1(eo,X,e)):(t=e1(ea,Z,e),n=[]);let o=r.concat(i,t,n);return o.sort(function(e,t){return e.index-t.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}/**
 * Returns how many bits are needed to encode a string of
 * specified length with the specified mode
 *
 * @param  {Number} length String length
 * @param  {Mode} mode     Segment mode
 * @return {Number}        Bit length
 */function e4(e,t){switch(t){case G:return eR.getBitsLength(e);case Y:return e_.getBitsLength(e);case X:return eG.getBitsLength(e);case Z:return eH.getBitsLength(e)}}/**
 * Builds a segment from a specified data and mode.
 * If a mode is not specified, the more suitable will be used.
 *
 * @param  {String} data             Input data
 * @param  {Mode | String} modesHint Data mode
 * @return {Segment}                 Segment
 */function e3(e,t){var n;let r;let i=(n=e,ej.test(n)?G:eU.test(n)?Y:e$.test(n)?X:Z);// Make sure data can be encoded
if((r=er(t,i))!==Z&&r.bit<i.bit)throw Error('"'+e+'" cannot be encoded with mode '+en(r)+".\n Suggested mode is: "+en(i));switch(r!==X||B()||(r=Z),r){case G:return new eR(e);case Y:return new e_(e);case X:return new eG(e);case Z:return new eH(e)}}/**
 * Add format info bits to matrix
 *
 * @param  {BitMatrix} matrix               Modules matrix
 * @param  {ErrorCorrectionLevel}    errorCorrectionLevel Error correction level
 * @param  {Number}    maskPattern          Mask pattern reference value
 */function e5(e,t,n){let r,i;let o=e.size,a=ec(t,n);for(r=0;r<15;r++)i=(a>>r&1)==1,r<6?e.set(r,8,i,!0):r<8?e.set(r+1,8,i,!0):e.set(o-15+r,8,i,!0),r<8?e.set(8,o-r-1,i,!0):r<9?e.set(8,15-r-1+1,i,!0):e.set(8,15-r-1,i,!0);// fixed module
e.set(o-8,8,1,!0)}function e6(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw Error("Invalid hex color: "+e);(3===t.length||4===t.length)&&(t=Array.prototype.concat.apply([],t.map(function(e){return[e,e]}))),6===t.length&&t.push("F","F");let n=parseInt(t.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n,hex:"#"+t.slice(0,6).join("")}}function e8(e,t){let n=e.a/255,r=t+'="'+e.hex+'"';return n<1?r+" "+t+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function e9(e,t,n){let r=e+t;return void 0!==n&&(r+=" "+n),r}function e7(e,t,n,r,i){let o=[].slice.call(arguments,1),a=o.length,l="function"==typeof o[a-1];if(!l&&!ew())throw Error("Callback required as last argument");if(l){if(a<2)throw Error("Too few arguments provided");2===a?(i=n,n=t,t=r=void 0):3===a&&(t.getContext&&void 0===i?(i=r,r=void 0):(i=r,r=n,n=t,t=void 0))}else{if(a<1)throw Error("Too few arguments provided");return 1===a?(n=t,t=r=void 0):2!==a||t.getContext||(r=n,n=t,t=void 0),new Promise(function(i,o){try{let o=v(n,r);i(e(o,t,r))}catch(e){o(e)}})}try{let o=v(n,r);i(null,e(o,t,r))}catch(e){i(e)}}function te(){return new Map().set("hole","H\xe5l").set("stain","Fl\xe4ck").set("lostFit","Tappad passform").set("nopprig","Nopprig").set("threadUp","Tr\xe5dsl\xe4pp").set("colorChange","F\xe4rg\xe4ndring").set("otherDefect","Annat")}function tt(){return["frontImage","brandTagImage","defectImage","materialTagImage","extraImage"]}async function tn(){// Create item from sessionStorage
if(console.log("sellItemMainAuthenticated "+new Date),// Visa alla "viktiga" fält om man är inloggad
toggleMoreInfoFields.click(),sessionStorage.getItem("itemToBeCreatedAfterSignIn")){// ... if we are redirected here from the sign-in page
if(document.referrer.includes("/sign-in")){document.getElementById("loadingDiv").style.display="flex",document.getElementById("creatingItemText").style.display="block",await tf();let e=sessionStorage.getItem("shippingMethod");e&&await firebase.app().functions("europe-west1").httpsCallable("updateFirebaseUser")({preferences:{shippingMethod:e}});let t=user.current?.phoneNumber?.length;return location.href=t?"/item-confirmation":"/user-contact"}sessionStorage.removeItem("itemToBeCreatedAfterSignIn")}// Get user's item count to be able to send 'User Activated' event
let e=await getItems(authUser.current.uid);ev=e.size}async function tr(){let e,t,n,r,i,o;let a=document.getElementById("qrCanvas");a&&(ex&&ex.__esModule?ex.default:ex).toCanvas(a,window.location.href,function(e){e&&console.error(e),console.log("success!")}),localStorage.removeItem("latestItemCreated"),sessionStorage.removeItem("itemValuation"),e=document.getElementById("frontImage"),t=document.getElementById("brandTagImage"),n=document.getElementById("productImage"),r=document.getElementById("defectImage"),i=document.getElementById("materialTagImage"),o=document.getElementById("extraImage"),// display image when file has been selected
$("#frontImage").off("change"),e.addEventListener("change",tS,{capture:!0}),$("#brandTagImage").off("change"),t.addEventListener("change",tE,{capture:!0}),$("#productImage").off("change"),n.addEventListener("change",tB,{capture:!0}),$("#defectImage").off("change"),r.addEventListener("change",tb,{capture:!0}),$("#materialTag").off("change"),i.addEventListener("change",tk,{capture:!0}),$("#extraImage").off("change"),o.addEventListener("change",tC,{capture:!0}),setupModelSearchEventListeners(),function(){let e=document.getElementById("itemColor");e.onchange=function(){""!==this.value?e.style.color="#333":e.style.color="#929292"};// Change font color of dropdown itemAge when user selects a value
let t=document.getElementById("itemAge");t.onchange=function(){""!==this.value?t.style.color="#333":t.style.color="#929292"}}(),itemBrand.addEventListener("input",ty("itemBrandLabel")),itemBrand.addEventListener("input",tA),itemModel.addEventListener("input",ty("itemModelLabel")),itemSize.addEventListener("input",ty("itemSizeLabel")),itemSize.addEventListener("input",tA),itemMaterial.addEventListener("input",ty("itemMaterialLabel")),itemMaterial.addEventListener("input",tA),itemOriginalPrice.addEventListener("input",ty("itemOriginalPriceLabel")),itemAge.addEventListener("input",ty("itemAgeLabel")),itemCondition.addEventListener("input",ty("itemConditionLabel")),itemColor.addEventListener("change",ty("itemColorLabel")),itemColor.addEventListener("input",tA),itemUserComment.addEventListener("input",ty("userCommentLabel")),document.getElementById("addItemButton").addEventListener("click",()=>{document.getElementById("wf-form-Add-Item").reportValidity();let e=document.getElementById("wf-form-Add-Item").querySelectorAll(":invalid"),t=e?.[0];t&&t.getBoundingClientRect().height<=1&&(t.style.cssText="width:100% !important;height:100% !important;"),setTimeout(()=>{if(e.length>0){if(!function(e){"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]);let t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight/2||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}(t)){let e=t.getBoundingClientRect().top+window.scrollY-40;window.scrollTo({top:e,behavior:"smooth"})}document.getElementById("wf-form-Add-Item").reportValidity()}},300)}),addItemForm.addEventListener("submit",ti),userAddressForm.addEventListener("submit",addUserDetails),autocomplete(document.getElementById("itemBrand"),brands);// Hide/Show warning about difficulty to sell certain brands
let l=document.getElementById("itemBrand");if(document.getElementById("hardToSellDiv"),l.oninput=function(){shareSoldDiv.style.display="none",function(e){if(words.some(t=>e.toLowerCase().includes(t.toLowerCase())))return hardToSellText.innerHTML=`Vi s\xe4ljer i regel inte ${e}-plagg p\xe5 grund av f\xf6r l\xe5gt andrahandsv\xe4rde. Undantag kan finnas.`,hardToSellDiv.style.display="block";hardToSellDiv.style.display="none"}(this.value)},// Hide/Show extra fields for defects
itemCondition.onchange=function(){let e=this.value;"Anv\xe4nd, tecken p\xe5 slitage"==e?(defectInfoDiv.style.display="block",itemCondition.style.color="#333"):""==e?(defectInfoDiv.style.display="none",itemCondition.style.color="#929292"):(defectInfoDiv.style.display="none",itemCondition.style.color="#333")},personalId.addEventListener("input",()=>{let e=isValidSwedishSsn(personalId.value)?"":"Ogiltigt personnummer";personalId.setCustomValidity(e)}),await t$(),await tq(),await tM(),await tT(),await tN(),function(){let e=new MutationObserver((e,t)=>{let n=e.find(e=>"style"===e.attributeName);n&&"none"===n.target.style.display&&th()});Array.from(document.querySelectorAll(".suggest-buttons")).forEach(t=>e.observe(t,{attributes:!0}))}(),function(){function e(e){let t=e.target;if(t instanceof Element){let e=tc()[t.name];e!==t.value&&""!==t.value&&(document.getElementById("clearItemForm").style.display="block")}}document.getElementById("wf-form-Add-Item").addEventListener("input",e),document.querySelector("#wf-form-Add-Item select").addEventListener("change",e)}(),tt().forEach(e=>{document.getElementById(`delete${c(e)}Icon`).addEventListener("click",()=>{tV(e)})}),document.getElementById("deleteFrontImageIcon").addEventListener("click",()=>{document.getElementById("frontImage").required=!0,tV("enhancedFrontImage")}),document.getElementById("deleteBrandTagImageIcon").addEventListener("click",()=>{document.getElementById("brandTagImage").required=!0}),document.getElementById("clearItemForm").addEventListener("click",tF),params.id)// Fill form if the user comes from a prefill link (re-sell item)
sessionStorage.removeItem("newItemId"),localStorage.removeItem("newItem"),auth.onAuthStateChanged(function(e){e||(document.getElementById("maiIntro").style.display="block")}),document.getElementById("resellIntro").style.display="block",await tv(params.id),document.getElementById("triggerShowSellItemContent").click();else if(sessionStorage.getItem("itemToBeCreatedAfterSignIn")&&document.referrer.includes("/sign-in"));else if(localStorage.getItem("newItem")&&!tp(JSON.parse(localStorage.getItem("newItem")))){// Saved state from a previous visit to /sell-item - restore the data
let e=JSON.parse(localStorage.getItem("newItem"));document.getElementById("frontImage").required=!0,document.getElementById("brandTagImage").required=!0,await tv(null,e,!0),document.getElementById("clearItemForm").style.display="block",document.getElementById("triggerShowSellItemContent").click()}else document.getElementById("triggerShowSellItemContent").click(),document.getElementById("frontImage").required=!0,document.getElementById("brandTagImage").required=!0;// We delay the rememberUnsavedChanges call to allow any confirm/reject animations to finish
document.getElementById("wf-form-Add-Item").querySelectorAll("input").forEach(e=>{e.addEventListener("input",th)}),document.getElementById("wf-form-Add-Item").querySelectorAll('input[type="radio"]').forEach(e=>{e.addEventListener("change",th)}),document.getElementById("wf-form-Add-Item").querySelectorAll('input[type="checkbox"]').forEach(e=>{e.addEventListener("change",th)}),// We delay the rememberUnsavedChanges call to allow any confirm/reject animations to finish
document.getElementById("wf-form-Add-Item").querySelectorAll("select").forEach(e=>{e.addEventListener("change",th)}),document.getElementById("wf-form-Add-Item").querySelectorAll("textarea").forEach(e=>{e.addEventListener("input",th)}),window.addEventListener("pageshow",e=>{e.persisted&&localStorage.getItem("newItem")&&setTimeout(async()=>{await tv(null,JSON.parse(localStorage.getItem("newItem")),!0)},10)})}async function ti(e){let t=sessionStorage.getItem("newItemId")||await i();try{document.getElementById("addItemFormDiv").style.display="none",document.getElementById("loadingDiv").style.display="flex",document.getElementById("clearItemForm").style.display="none";let e=await tg(t),n=await ts(t,e);0===ev&&analytics.track("User Activated"),location.href=n}catch(e){errorHandler.report(e),console.error("addItem failed",e)}}function to({humanCheckNeeded:e,newMinMaxLog:t}){return e||t.match(/accept price is above max/i)}async function ta(e,t,n){let{minPrice:r,maxPrice:i,decline:o,humanCheckNeeded:a,humanCheckExplanation:l,willNotSell:s,soldPrice:d,version:c,newMinPriceEstimate:u,newMaxPriceEstimate:m,newMinMaxLog:g,adjustmentAllowed:f,newBrand:h,newBrandCategory:p}=t||{};if(!r&&!o)return;let y={mlValuation:{decline:o,humanCheckNeeded:a,minPriceEstimate:r,maxPriceEstimate:i,humanCheckExplanation:l,willNotSellPrediction:s,soldPriceEstimate:d,modelVersion:c?.toString(),newMinPriceEstimate:u,newMaxPriceEstimate:m,newMinMaxLog:g,adjustmentAllowed:f,newBrand:h,newBrandCategory:p},...o||to(t)?{}:{valuationStatus:"Completed",valuationDate:new Date().toISOString(),...n?{}:{minPriceEstimate:r,maxPriceEstimate:i},infoRequests:{price:{status:n?"Active":"Resolved",response:n?"":"Accepted",description:"Vi b\xf6rjar med startpriset, och justerar successivt ner till l\xe4gsta priset under s\xe4ljperioden p\xe5 30 dagar. V\xe4rderingen utg\xe5r fr\xe5n vad liknande s\xe5lts f\xf6r.",minPrice:u||r,maxPrice:m||i}}}};if(sessionStorage.getItem("itemToBeCreatedAfterSignIn")){let e=JSON.parse(sessionStorage.getItem("itemToBeCreatedAfterSignIn"));sessionStorage.setItem("itemToBeCreatedAfterSignIn",JSON.stringify({id:e.id,item:{...e.item,...y}}))}else{await firebase.app().functions("europe-west1").httpsCallable("saveItemValuationFields")({itemId:e,...y});let t=JSON.parse(localStorage.getItem("latestItemCreated"));localStorage.setItem("latestItemCreated",JSON.stringify({...t,...y}))}}async function tl(e,t,n){let r={valuationStatus:"Completed",valuationDate:new Date().toISOString(),infoRequests:{price:{status:"Active",response:"",description:"Vi b\xf6rjar med startpriset, och justerar successivt ner till l\xe4gsta priset under s\xe4ljperioden p\xe5 30 dagar. V\xe4rderingen utg\xe5r fr\xe5n vad liknande s\xe5lts f\xf6r.",minPrice:e.minPriceEstimate,maxPrice:e.maxPriceEstimate,type:"Valuation",adjustmentAllowed:!0}}};if(sessionStorage.getItem("itemToBeCreatedAfterSignIn"))sessionStorage.setItem("itemToBeCreatedAfterSignIn",JSON.stringify({id:t.id,item:{...t.item,...r}}));else{await firebase.app().functions("europe-west1").httpsCallable("saveItemValuationFields")({itemId:n,...r});let e=JSON.parse(localStorage.getItem("latestItemCreated"));localStorage.setItem("latestItemCreated",JSON.stringify({...e,...r}))}}async function ts(e,t){let n=t.preferences.userValuationApproval;if(!e&&!t)return console.error("No item and no itemId, unexpected!!"),"/item-confirmation";if(params.id){let n=await firebase.app().functions("europe-west1").httpsCallable("getItem")({itemId:params.id}),r=n.data;if("Sold"===r.status)return await tl(r,t,e),"/item-valuation"}try{let r=await firebase.app().functions("europe-west1").httpsCallable("itemMlValuation")({itemId:e,item:t}),{minPrice:i,maxPrice:o,decline:a}=r.data||{};return await ta(e,r.data,n),td(i&&o,a,to(r.data),n)}catch(e){console.error("Failed to get ml valuation",e)}return td()}function td(e,t,n,r){if(!e||n||!r){if(sessionStorage.getItem("itemToBeCreatedAfterSignIn"))return"/sign-in";let e=user.current?.phoneNumber?.length;return e?"/item-confirmation":"/user-contact"}return"/item-valuation"}function tc(){return{acceptPrice:null,age:null,brand:null,category:null,color:null,condition:null,defectDescription:null,defects:[],images:{},material:null,model:null,originalPrice:null,userValuationApproval:!0,sex:"Woman",size:null,userComment:null}}function tu(){let e="",t=new Date,n=itemSize.value,r=itemMaterial.value?itemMaterial.value.trim():"",i=itemBrand.value?itemBrand.value.trim():"",o=itemModel.value?itemModel.value.trim():"",a=Number(itemOriginalPrice.value),l=itemAge.value,s=itemCondition.value,d=itemDefectDescription.value?itemDefectDescription.value.trim():"",c=itemUserComment.value?itemUserComment.value.trim():"",u=Number(itemLowestAcceptPrice.value),m=itemUserValuationApproval.checked,g=new Map().set("hole",hole.checked).set("stain",stain.checked).set("lostFit",lostFit.checked).set("nopprig",nopprig.checked).set("threadUp",threadUp.checked).set("colorChange",colorChange.checked).set("otherDefect",otherDefect.checked),f=[];"Anv\xe4nd, tecken p\xe5 slitage"===s&&g.forEach((e,t)=>{if(e){let e=te().get(t);f.push(e)}});for(var h=document.getElementsByName("Sex"),p=0;p<h.length;p++)h[p].checked&&(e=h[p].id);let y=document.getElementById("findModelBoxFilled"),I={};if("flex"===y.style.display){// There is a current model selected grab the cover image and id from it
let e=JSON.parse(y.getAttribute("data-model"));I={modelCoverImageUrl:e.coverImage,atModelVariantId:e.atVariantId}}let v=JSON.parse(localStorage.getItem("newItem")||"{}").images;return{user:authUser.current?.uid||null,createdAt:t.toISOString(),status:"New",shippingStatus:"Not sent",sex:e,size:n,material:r,color:itemColor.value,category:itemCategory.value,brand:i,model:o,originalPrice:a,age:l,condition:s,defects:f,defectDescription:d,userComment:c,acceptPrice:u,preferences:{userValuationApproval:m},...I,images:v}}async function tm(){// If first time: User chooses shipping method preference in sell item form
let e="Service point";return user.current?.preferences?.shippingMethod?e=user.current?.preferences?.shippingMethod:authUser.current?await firebase.app().functions("europe-west1").httpsCallable("updateFirebaseUser")({preferences:{shippingMethod:e}}):sessionStorage.setItem("shippingMethod",e),e}async function tg(e){let{modelCoverImageUrl:t,images:n,...r}=tu(),i=await tm();t&&(n.modelImage=t);let o=params.id?{createdFromItem:params.id}:{},a={...r,shippingMethod:i,images:n,...o,version:"2"};if(authUser.current){let t=await firebase.app().functions("europe-west1").httpsCallable("createItem")({id:e,item:a});localStorage.removeItem("newItem"),sessionStorage.removeItem("newItemId"),localStorage.setItem("latestItemCreated",JSON.stringify(t.data))}else sessionStorage.setItem("itemToBeCreatedAfterSignIn",JSON.stringify({id:e,item:a}));return a}async function tf(){let e=JSON.parse(sessionStorage.getItem("itemToBeCreatedAfterSignIn"));sessionStorage.removeItem("itemToBeCreatedAfterSignIn"),sessionStorage.removeItem("newItemId"),await firebase.app().functions("europe-west1").httpsCallable("createItem")(e),localStorage.removeItem("newItem"),e.item.id=e.id,localStorage.setItem("latestItemCreated",JSON.stringify(e.item))}function th(){if(localStorage.getItem("latestItemCreated"))return;let{user:e,createdAt:t,status:n,shippingStatus:r,modelVariantFields:i,...o}=tu(),a=Object.keys(o).reduce((e,t)=>(e[t]=""===o[t]?null:o[t],e),{});a.defects=a.defects?a.defects:[],a.userValuationApproval=a.preferences.userValuationApproval,delete a.preferences,a.acceptPrice=a.acceptPrice&&a.acceptPrice>0?a.acceptPrice:null,a.originalPrice=a.originalPrice&&a.originalPrice>0?a.originalPrice:null,["itemBrand","itemSize","itemMaterial","itemColor"].forEach(e=>{let t=document.getElementById(e).parentNode.querySelector(".suggest-buttons")||document.getElementById(e).parentNode.parentNode.querySelector(".suggest-buttons");t?.style?.display==="block"&&(a[`${e}Confirm`]=!0)}),tp(a)?localStorage.removeItem("newItem"):localStorage.setItem("newItem",JSON.stringify(a))}function tp(e){let t=tc();for(let n in t)if(n in e){if(t[n]instanceof Object){if(JSON.stringify(t[n])!==JSON.stringify(e[n]))return!1;continue}if(e[n]!==t[n])return!1}return!0}function ty(e){return t=>{document.getElementById(e).style.display=t.target.value.length>0?"inline-block":"none"}}function tI(e,t,n){if(t&&n){let t=document.getElementById(e).parentNode.querySelector(".suggest-buttons")||document.getElementById(e).parentNode.parentNode.querySelector(".suggest-buttons");t.style.display="block",document.getElementById(e).setCustomValidity("Bekr\xe4fta eller \xe4ndra v\xe4rdet")}}async function tv(e,t=null,n=!1){try{let r={data:t},i=null;t||([r,i]=await Promise.all([firebase.app().functions("europe-west1").httpsCallable("getItem")({itemId:e}),fetch(`https://getatitem-heypmjzjfq-ew.a.run.app?itemId=${e}`)]));let a=await i.json(),l=r.data,c=l.images||{},u=l.originalPrice;// Populate images
for(let e in u<=0&&(u=null),c){let t=c[`${e}Small`]||c[`${e}Medium`]||c[e]||c[`${e}Large`],n=c[e]||c[`${e}Large`]||c[`${e}Medium`]||c[`${e}Small`];tt().includes(e)&&(s(e,n,t),"frontImage"===e&&(c.enhancedFrontImage?(t=c.enhancedFrontImageSmall||c.enhancedFrontImageMedium||c.enhancedFrontImage||c.enhancedFrontImageLarge,n=c.enhancedFrontImage||c.enhancedFrontImageLarge||c.enhancedFrontImageMedium||c.enhancedFrontImageSmall,s("enhancedFrontImage",n,t)):(function(e){let t=new MutationObserver(e),n=document.getElementById("loadingDiv");t.observe(n,{attributeFilter:["style"]})}(()=>f(e)),o(n).then(()=>console.log("Image enhanced")))),d(e,t),g(e,"success-state"),document.getElementById(e).required=!1)}if(c.modelImage){let e=c.modelImageLarge||c.modelImage,t=c.modelImageSmall||c.modelImageMedium||c.modelImage;document.getElementById("coverImageContainer").style.backgroundImage=`url('${t}')`,document.getElementById("coverImagePreview").style.display="block",s("modelImage",e,t)}else if(c.coverImage&&!await tj(c.coverImage)){// Show cover image preview if it is a model image, if it is a noBg image we skip it
sessionStorage.removeItem("coverImagePreviewUrl");let e=c.coverImageLarge||c.coverImage,t=c.coverImage;document.getElementById("coverImageContainer").style.backgroundImage=`url('${t}')`,document.getElementById("coverImagePreview").style.display="block",s("modelImage",e,t)}// Populate text input fields
itemBrand.value=l.brand||"",tI("itemBrand",n,l.itemBrandConfirm),// Don't use the setFieldValue for the brand since that triggers a dropdown to open
document.getElementById("itemBrandLabel").style.display=l.brand?"inline-block":"none",setFieldValue("itemSize",l.size),tI("itemSize",n,l.itemSizeConfirm),setFieldValue("itemMaterial",l.material),tI("itemMaterial",n,l.itemMaterialConfirm),setFieldValue("itemModel",l.model||a?.model),setFieldValue("itemOriginalPrice",u||a?.originalPrice),n&&(setFieldValue("itemUserComment",l.userComment),setFieldValue("itemDefectDescription",l.defectDescription),setFieldValue("itemLowestAcceptPrice",l.acceptPrice<=0?null:l.acceptPrice),tx(itemCondition,l.condition)),params.id&&"Sold"===l.status&&(document.getElementById("priceSettings").style.display="none"),// Populate select fields
tx(itemAge,l.age),tx(itemColor,l.color||a?.color),tI("itemColor",n,l.itemColorConfirm),itemCondition.selectedIndex>=0&&"Anv\xe4nd, tecken p\xe5 slitage"===itemCondition.options[itemCondition.selectedIndex].text&&(defectInfoDiv.style.display="block");let m=$("#itemCategory");m.val(l.category),m.trigger("change"),l.sex?(document.getElementById("Woman").previousElementSibling.classList.remove("w--redirected-checked"),document.getElementById("Woman").checked=!1,document.getElementById(l.sex).previousElementSibling.classList.add("w--redirected-checked"),document.getElementById(l.sex).checked=!0):(document.getElementById("Woman").previousElementSibling.classList.add("w--redirected-checked"),document.getElementById("Woman").checked=!0),n&&(// Populate checkboxes
te().forEach((e,t)=>{l.defects&&l.defects.includes(e)&&(document.getElementById(t).previousElementSibling.classList.add("w--redirected-checked"),document.getElementById(t).checked=!0)}),"userValuationApproval"in l&&!l.userValuationApproval&&(document.getElementById("itemUserValuationApproval").click(),document.getElementById("itemUserValuationApproval").previousElementSibling.classList.remove("w--redirected-checked")))}catch(e){console.error("Error getting item document:",e),errorHandler.report(e)}document.getElementById("loadingDiv").style.display="none"}function tx(e,t){let n=Array.from(e.options).map(e=>e.attributes.value.value).indexOf(t);n>0?(e.selectedIndex=n,e.style.color="#333"):(e.selectedIndex=0,e.style.color="#929292"),e.dispatchEvent(new Event("input")),e.dispatchEvent(new Event("change"))}eZ=eX,eu=function(e){return e.reduce(function(e,t){return"string"==typeof t?e.push(e3(t,null)):t.data&&e.push(e3(t.data,t.mode)),e},[])},em=function(e,t){let n=e2(e,B()),r=/**
 * Generates a list of all possible nodes combination which
 * will be used to build a segments graph.
 *
 * Nodes are divided by groups. Each group will contain a list of all the modes
 * in which is possible to encode the given text.
 *
 * For example the text '12345' can be encoded as Numeric, Alphanumeric or Byte.
 * The group for '12345' will contain then 3 objects, one for each
 * possible encoding mode.
 *
 * Each node represents a possible segment.
 *
 * @param  {Array} segs Array of object with segments data
 * @return {Array}      Array of object with segments data
 */function(e){let t=[];for(let n=0;n<e.length;n++){let r=e[n];switch(r.mode){case G:t.push([r,{data:r.data,mode:Y,length:r.length},{data:r.data,mode:Z,length:r.length}]);break;case Y:t.push([r,{data:r.data,mode:Z,length:r.length}]);break;case X:t.push([r,{data:r.data,mode:Z,length:e0(r.data)}]);break;case Z:t.push([{data:r.data,mode:Z,length:e0(r.data)}])}}return t}(n),i=/**
 * Builds a graph from a list of nodes.
 * All segments in each node group will be connected with all the segments of
 * the next group and so on.
 *
 * At each connection will be assigned a weight depending on the
 * segment's byte length.
 *
 * @param  {Array} nodes    Array of object with segments data
 * @param  {Number} version QR Code version
 * @return {Object}         Graph of all possible segments
 */function(e,t){let n={},r={start:{}},i=["start"];for(let o=0;o<e.length;o++){let a=e[o],l=[];for(let e=0;e<a.length;e++){let s=a[e],d=""+o+e;l.push(d),n[d]={node:s,lastCount:0},r[d]={};for(let e=0;e<i.length;e++){let o=i[e];n[o]&&n[o].node.mode===s.mode?(r[o][d]=e4(n[o].lastCount+s.length,s.mode)-e4(n[o].lastCount,s.mode),n[o].lastCount+=s.length):(n[o]&&(n[o].lastCount=s.length),r[o][d]=e4(s.length,s.mode)+4+et(s.mode,t)// switch cost
)}}i=l}for(let e=0;e<i.length;e++)r[i[e]].end=0;return{map:r,table:n}}(r,t),o=eZ.find_path(i.map,"start","end"),a=[];for(let e=1;e<o.length-1;e++)a.push(i.table[o[e]].node);return eu(a.reduce(function(e,t){let n=e.length-1>=0?e[e.length-1]:null;return n&&n.mode===t.mode?e[e.length-1].data+=t.data:e.push(t),e},[]))},v=function(e,t){let n,r;if(void 0===e||""===e)throw Error("No input text");let i=k;if(void 0!==t){var o,a;// Use higher error correction level as default
i=L(t.errorCorrectionLevel,k),n=ei(o=t.version)?parseInt(o,10):void 0,r=null!=(a=t.maskPattern)&&""!==a&&!isNaN(a)&&a>=0&&a<=7?parseInt(a,10):void 0,t.toSJISFunc&&E(t.toSJISFunc)}return(/**
 * Build QR Code symbol
 *
 * @param  {String} data                 Input string
 * @param  {Number} version              QR Code version
 * @param  {ErrorCorretionLevel} errorCorrectionLevel Error level
 * @param  {MaskPattern} maskPattern     Mask pattern
 * @return {Object}                      Object containing symbol data
 */function(e,t,n,r){let i;if(Array.isArray(e))i=eu(e);else if("string"==typeof e){let r=t;if(!r){let t=eu(e2(e,B()));// Estimate best version that can contain raw splitted segments
r=W(t,n)}// Build optimized segments
// If estimated version is undefined, try with the highest version
i=em(e,r||40)}else throw Error("Invalid data");// Get the min version that can contain data
let o=W(i,n);// If no version is found, data cannot be stored
if(!o)throw Error("The amount of data is too big to be stored in a QR Code");// If not specified, use min version as default
if(t){if(t<o)throw Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+o+".\n")}else t=o;let a=/**
 * Create encoded codewords from data input
 *
 * @param  {Number}   version              QR Code version
 * @param  {ErrorCorrectionLevel}   errorCorrectionLevel Error correction level
 * @param  {ByteData} data                 Data input
 * @return {Uint8Array}                    Buffer containing encoded codewords
 */function(e,t,n){// Prepare data buffer
let r=new eE;n.forEach(function(t){// prefix data with mode indicator (4 bits)
r.put(t.mode.bit,4),// Prefix data with character count indicator.
// The character count indicator is a string of bits that represents the
// number of characters that are being encoded.
// The character count indicator must be placed after the mode indicator
// and must be a certain number of bits long, depending on the QR version
// and data mode
// @see {@link Mode.getCharCountIndicator}.
r.put(t.getLength(),et(t.mode,e)),// add binary data sequence to buffer
t.write(r)});// Calculate required number of bits
let i=w(e),o=R(e,t),a=(i-o)*8;// If the bit string is fewer than four bits shorter, add only the number of 0s that
// are needed to reach the required number of bits.
// After adding the terminator, if the number of bits in the string is not a multiple of 8,
// pad the string on the right with 0s to make the string's length a multiple of 8.
for(r.getLengthInBits()+4<=a&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(0);// Add pad bytes if the string is still shorter than the total number of required bits.
// Extend the buffer to fill the data capacity of the symbol corresponding to
// the Version and Error Correction Level by adding the Pad Codewords 11101100 (0xEC)
// and 00010001 (0x11) alternately.
let l=(a-r.getLengthInBits())/8;for(let e=0;e<l;e++)r.put(e%2?17:236,8);return(/**
 * Encode input data with Reed-Solomon and return codewords with
 * relative error correction bits
 *
 * @param  {BitBuffer} bitBuffer            Data to encode
 * @param  {Number}    version              QR Code version
 * @param  {ErrorCorrectionLevel} errorCorrectionLevel Error correction level
 * @return {Uint8Array}                     Buffer containing encoded codewords
 */function(e,t,n){let r,i;// Total codewords for this QR code version (Data + Error correction)
let o=w(t),a=R(t,n),l=o-a,s=z(t,n),d=o%s,c=s-d,u=Math.floor(o/s),m=Math.floor(l/s),g=m+1,f=u-m,h=new eP(f),p=0,y=Array(s),I=Array(s),v=0,x=new Uint8Array(e.buffer);// Divide the buffer into the required number of blocks
for(let e=0;e<s;e++){let t=e<c?m:g;// extract a block of data from buffer
y[e]=x.slice(p,p+t),// Calculate EC codewords for this data block
I[e]=h.encode(y[e]),p+=t,v=Math.max(v,t)}// Create final data
// Interleave the data and error correction codewords from each block
let S=new Uint8Array(o),E=0;// Add data codewords
for(r=0;r<v;r++)for(i=0;i<s;i++)r<y[i].length&&(S[E++]=y[i][r]);// Apped EC codewords
for(r=0;r<f;r++)for(i=0;i<s;i++)S[E++]=I[i][r];return S}(r,e,t))}(t,n,i),l=x(t),s=new eb(l);return(// Add function modules
/**
 * QRCode for JavaScript
 *
 * modified by Ryan Day for nodejs support
 * Copyright (c) 2011 Ryan Day
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 *
//---------------------------------------------------------------------
// QRCode for JavaScript
//
// Copyright (c) 2009 Kazuhiko Arase
//
// URL: http://www.d-project.com/
//
// Licensed under the MIT license:
//   http://www.opensource.org/licenses/mit-license.php
//
// The word "QR Code" is registered trademark of
// DENSO WAVE INCORPORATED
//   http://www.denso-wave.com/qrcode/faqpatent-e.html
//
//---------------------------------------------------------------------
*//**
 * Add finder patterns bits to matrix
 *
 * @param  {BitMatrix} matrix  Modules matrix
 * @param  {Number}    version QR Code version
 */function(e,t){let n=e.size,r=M(t);for(let t=0;t<r.length;t++){let i=r[t][0],o=r[t][1];for(let t=-1;t<=7;t++)if(!(i+t<=-1)&&!(n<=i+t))for(let r=-1;r<=7;r++)o+r<=-1||n<=o+r||(t>=0&&t<=6&&(0===r||6===r)||r>=0&&r<=6&&(0===t||6===t)||t>=2&&t<=4&&r>=2&&r<=4?e.set(i+t,o+r,!0,!0):e.set(i+t,o+r,!1,!0))}}(s,t),/**
 * Add timing pattern bits to matrix
 *
 * Note: this function must be called before {@link setupAlignmentPattern}
 *
 * @param  {BitMatrix} matrix Modules matrix
 */function(e){let t=e.size;for(let n=8;n<t-8;n++){let t=n%2==0;e.set(n,6,t,!0),e.set(6,n,t,!0)}}(s),/**
 * Add alignment patterns bits to matrix
 *
 * Note: this function must be called after {@link setupTimingPattern}
 *
 * @param  {BitMatrix} matrix  Modules matrix
 * @param  {Number}    version QR Code version
 */function(e,t){let n=T(t);for(let t=0;t<n.length;t++){let r=n[t][0],i=n[t][1];for(let t=-2;t<=2;t++)for(let n=-2;n<=2;n++)-2===t||2===t||-2===n||2===n||0===t&&0===n?e.set(r+t,i+n,!0,!0):e.set(r+t,i+n,!1,!0)}}(s,t),// Add temporary dummy bits for format info just to set them as reserved.
// This is needed to prevent these bits from being masked by {@link MaskPattern.applyMask}
// since the masking operation must be performed only on the encoding region.
// These blocks will be replaced with correct values later in code.
e5(s,n,0),t>=7&&/**
 * Add version info bits to matrix
 *
 * @param  {BitMatrix} matrix  Modules matrix
 * @param  {Number}    version QR Code version
 */function(e,t){let n,r,i;let o=e.size,a=Q(t);for(let t=0;t<18;t++)n=Math.floor(t/3),r=t%3+o-8-3,i=(a>>t&1)==1,e.set(n,r,i,!0),e.set(r,n,i,!0)}(s,t),// Add data codewords
/**
 * Add encoded data bits to matrix
 *
 * @param  {BitMatrix}  matrix Modules matrix
 * @param  {Uint8Array} data   Data codewords
 */function(e,t){let n=e.size,r=-1,i=n-1,o=7,a=0;for(let l=n-1;l>0;l-=2)for(6===l&&l--;;){for(let n=0;n<2;n++)if(!e.isReserved(i,l-n)){let r=!1;a<t.length&&(r=(t[a]>>>o&1)==1),e.set(i,l-n,r),-1==--o&&(a++,o=7)}if((i+=r)<0||n<=i){i-=r,r=-r;break}}}(s,a),isNaN(r)&&(r=D(s,e5.bind(null,s,n))),// Apply mask pattern
U(r,s),// Replace format info bits with correct values
e5(s,n,r),{modules:s,version:t,errorCorrectionLevel:n,maskPattern:r,segments:i})}(e,n,i,r))},ef=function(e){e||(e={}),e.color||(e.color={});let t=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,n=e.width&&e.width>=21?e.width:void 0,r=e.scale||4;return{width:n,scale:n?4:r,margin:t,color:{dark:e6(e.color.dark||"#000000ff"),light:e6(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},eh=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},ep=function(e,t){let n=eh(e,t);return Math.floor((e+2*t.margin)*n)},ey=function(e,t,n){let r=t.modules.size,i=t.modules.data,o=eh(r,n),a=Math.floor((r+2*n.margin)*o),l=n.margin*o,s=[n.color.light,n.color.dark];for(let t=0;t<a;t++)for(let d=0;d<a;d++){let c=(t*a+d)*4,u=n.color.light;if(t>=l&&d>=l&&t<a-l&&d<a-l){let e=Math.floor((t-l)/o),n=Math.floor((d-l)/o);u=s[i[e*r+n]?1:0]}e[c++]=u.r,e[c++]=u.g,e[c++]=u.b,e[c]=u.a}},eg=function(e,t,n){var r;let i=n,o=t;void 0!==i||t&&t.getContext||(i=t,t=void 0),t||(o=function(){try{return document.createElement("canvas")}catch(e){throw Error("You need to specify a canvas element")}}()),i=ef(i);let a=ep(e.modules.size,i),l=o.getContext("2d"),s=l.createImageData(a,a);return ey(s.data,e,i),r=o,l.clearRect(0,0,r.width,r.height),r.style||(r.style={}),r.height=a,r.width=a,r.style.height=a+"px",r.style.width=a+"px",l.putImageData(s,0,0),o},eI=function(e,t,n){let r=ef(t),i=e.modules.size,o=e.modules.data,a=i+2*r.margin,l=r.color.light.a?"<path "+e8(r.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",s="<path "+e8(r.color.dark,"stroke")+' d="'+function(e,t,n){let r="",i=0,o=!1,a=0;for(let l=0;l<e.length;l++){let s=Math.floor(l%t),d=Math.floor(l/t);s||o||(o=!0),e[l]?(a++,l>0&&s>0&&e[l-1]||(r+=o?e9("M",s+n,.5+d+n):e9("m",i,0),i=0,o=!1),s+1<t&&e[l+1]||(r+=e9("h",a),a=0)):i++}return r}(o,i,r.margin)+'"/>',d=r.width?'width="'+r.width+'" height="'+r.width+'" ':"",c='<svg xmlns="http://www.w3.org/2000/svg" '+d+('viewBox="0 0 '+a)+" "+a+'" shape-rendering="crispEdges">'+l+s+"</svg>\n";return"function"==typeof n&&n(null,c),c},h=v,p=e7.bind(null,eg),y=e7.bind(null,function(e,t,n){let r=n;void 0!==r||t&&t.getContext||(r=t,t=void 0),r||(r={});let i=eg(e,t,r),o=r.type||"image/png",a=r.rendererOpts||{};return i.toDataURL(o,a.quality)}),I=e7.bind(null,function(e,t,n){return eI(e,n)});let tw={black:"Black",white:"White",gray:"Grey",blue:"Blue",dark_blue:"Navy","multicolor/colorful":"Multicolour",red:"Red",pink:"Pink",brown:"Brown",beige:"Beige",light_blue:"Blue",green:"Green",silver:"Silver",purple:"Purple",maroon:"Burgundy",gold:"Gold",orange:"Orange",yellow:"Yellow",teal:"Turquoise",olive:"Green",cyan:"Turquoise",magenta:"Pink",mustard:"Yellow"};async function tS(e){let t=this.files[0];if(t){e.stopPropagation();let n=await u(t,"frontImage");if(!n||0===Object.keys(n).length)return;let r=[];r.push(tP(n),tL(n),o(n)),await Promise.all(r),th()}}async function tE(e){let t=this.files[0];if(t){e.stopPropagation();let n=await u(t,"brandTagImage");l("brandTagImage"),await tL(n),th()}}async function tB(e){let t=this.files[0];if(t){e.stopPropagation();let n=await u(t,"productImage");l("productImage"),await tL(n),th()}}async function tb(e){let t=this.files[0];if(t){e.stopPropagation();let n=await u(t,"defectImage");l("defectImage"),await tL(n),th()}}async function tk(e){let t=this.files[0];if(t){e.stopPropagation();let n=await u(t,"materialTagImage");l("materialTagImage"),await tL(n),th()}}async function tC(e){let t=this.files[0];if(t){e.stopPropagation();let n=await u(t,"extraImage");l("extraImage"),await tL(n),th()}}function tA(e){e.currentTarget.setCustomValidity("");let t=e.currentTarget.parentNode.querySelector(".suggest-buttons")||e.currentTarget.parentNode.parentNode.querySelector(".suggest-buttons");t.style.display="none"}async function tL(e){try{if(document.querySelector("#itemBrand").value.length&&document.querySelector("#itemMaterial").value.length&&document.querySelector("#itemSize").value.length)return;let t=await firebase.app().functions("europe-west1").httpsCallable("detectItemBrandAndMaterialAndSize")({imageUrl:e});!document.querySelector("#itemBrand").value.length&&t.data?.brand&&(document.querySelector("#itemBrand").value=t.data.brand,document.querySelector("#itemBrand").setCustomValidity("Bekr\xe4fta eller \xe4ndra m\xe4rket"),document.getElementById("itemBrandLabel").style.display="inline-block",document.querySelector("#brandSuggestButtons").style.display="block",document.querySelector("#itemBrand").dispatchEvent(new Event("change")),analytics.track("Element Viewed",{elementID:"brandSuggestButtons"})),!document.querySelector("#itemMaterial").value.length&&t.data?.materials&&(document.querySelector("#itemMaterial").value=t.data.materials,document.querySelector("#itemMaterial").setCustomValidity("Bekr\xe4fta eller \xe4ndra materialet"),document.getElementById("itemMaterialLabel").style.display="inline-block",document.querySelector("#materialSuggestButtons").style.display="block",document.querySelector("#itemMaterial").dispatchEvent(new Event("change")),analytics.track("Element Viewed",{elementID:"materialSuggestButtons"})),!document.querySelector("#itemSize").value.length&&t.data?.size&&(document.querySelector("#itemSize").value=t.data.size,document.querySelector("#itemSize").setCustomValidity("Bekr\xe4fta eller \xe4ndra storlek"),document.getElementById("itemSizeLabel").style.display="inline-block",document.querySelector("#sizeSuggestButtons").style.display="block",document.querySelector("#itemSize").dispatchEvent(new Event("change")),analytics.track("Element Viewed",{elementID:"sizeSuggestButtons"}))}catch(e){errorHandler.report(e),console.log("Error calling detectItemBrandAndMaterialAndSize",e)}}async function tP(e){try{let t=await firebase.app().functions("europe-west1").httpsCallable("detectItemColor")({imageUrl:e});if(!t.data?.colors||!t.data.colors.length){console.log("Unable to detect product color");return}if(t.data.colors.length>2)document.querySelector("#itemColor").value="Multicolour";else if(tw[t.data.colors?.[0]])document.querySelector("#itemColor").value=tw[t.data.colors?.[0]];else{console.log("Unable to set color from",t.data.colors?.[0]);return}document.querySelector("#itemColor").setCustomValidity("Bekr\xe4fta eller \xe4ndra f\xe4rgen"),document.querySelector("#colorSuggestButtons").style.display="block",document.querySelector("#itemColor").dispatchEvent(new Event("change")),analytics.track("Element Viewed",{elementID:"colorSuggestButtons"})}catch(e){errorHandler.report(e),console.log("Error calling detectItemColor",e)}}async function tT(){document.getElementById("rejectMaterial").addEventListener("click",()=>{document.querySelector("#itemMaterial").value="",document.querySelector("#materialSuggestButtons").style.display="none",ty("itemMaterialLabel"),document.querySelector("#itemMaterial").setCustomValidity("")}),document.getElementById("confirmMaterial").addEventListener("click",()=>{document.querySelector("#itemMaterial").setCustomValidity("")})}async function tM(){document.getElementById("rejectBrand").addEventListener("click",()=>{document.querySelector("#itemBrand").value="",document.querySelector("#brandSuggestButtons").style.display="none",document.querySelector("#itemBrand").setCustomValidity(""),ty("itemBrandLabel")}),document.getElementById("confirmBrand").addEventListener("click",()=>{document.querySelector("#itemBrand").setCustomValidity(""),document.querySelector("#itemBrand").setCustomValidity("")})}async function tN(){document.getElementById("rejectSize").addEventListener("click",()=>{document.querySelector("#itemSize").value="",document.querySelector("#sizeSuggestButtons").style.display="none",ty("itemBrandLabel"),document.querySelector("#itemSize").setCustomValidity("")}),document.getElementById("confirmSize").addEventListener("click",()=>{document.querySelector("#itemSize").setCustomValidity("")})}async function tq(){document.getElementById("rejectColor").addEventListener("click",()=>{document.querySelector("#itemColor").value="",document.querySelector("#colorSuggestButtons").style.display="none",ty("itemColorLabel"),document.querySelector("#itemColor").setCustomValidity("")}),document.getElementById("confirmColor").addEventListener("click",()=>{document.querySelector("#itemColor").setCustomValidity("")})}function tF(){document.getElementById("clearItemForm").style.display="none",tt().forEach(e=>{document.getElementById(`${e}Preview`).style.backgroundImage="",g(e,"default-state")}),setFieldValue("itemBrand",null),Array.from(document.querySelectorAll(".suggest-buttons")).forEach(e=>e.style.display="none"),setFieldValue("itemSize",null),setFieldValue("itemMaterial",null),setFieldValue("itemModel",null),setFieldValue("itemOriginalPrice",null),setFieldValue("itemUserComment",null),setFieldValue("itemDefectDescription",null),setFieldValue("itemLowestAcceptPrice",null),tx(itemAge,""),tx(itemColor,""),tx(itemCondition,""),defectInfoDiv.style.display="none";let e=$("#itemCategory");e.val(""),e.trigger("change"),// Populate radio-buttons
document.getElementById("Man").previousElementSibling.classList.remove("w--redirected-checked"),document.getElementById("Man").checked=!1,document.getElementById("Unisex").previousElementSibling.classList.remove("w--redirected-checked"),document.getElementById("Unisex").checked=!1,document.getElementById("Woman").previousElementSibling.classList.add("w--redirected-checked"),document.getElementById("Woman").checked=!0,// Populate checkboxes
te().forEach((e,t)=>{document.getElementById(t).previousElementSibling.classList.remove("w--redirected-checked"),document.getElementById(t).checked=!1}),!1===document.getElementById("itemUserValuationApproval").checked&&(document.getElementById("itemUserValuationApproval").click(),document.getElementById("itemUserValuationApproval").previousElementSibling.classList.add("w--redirected-checked")),sessionStorage.removeItem("newItemId"),localStorage.removeItem("newItem")}function tV(e){let t=JSON.parse(localStorage.getItem("newItem"));delete t?.images?.[e],delete t?.images?.[`${e}Small`],localStorage.setItem("newItem",JSON.stringify(t))}async function t$(){$("#itemCategory").select2({selectionCssClass:"form-field",placeholder:"Kategori",data:[{id:"",text:""},{text:"\xd6verdelar",children:[{id:"Tr\xf6ja",text:"Tr\xf6ja"},{id:"Blus",text:"Blus"},{id:"Topp",text:"Topp"},{id:"Skjorta",text:"Skjorta"},{id:"Linneskjorta",text:"Linneskjorta"},{id:"T-shirt",text:"T-shirt"},{id:"Kavaj",text:"Kavaj"},{id:"Sweatshirt",text:"Sweatshirt"},{id:"Hoodie",text:"Hoodie"},{id:"Polotr\xf6ja",text:"Polotr\xf6ja"},{id:"Tunika",text:"Tunika"},{id:"V\xe4st",text:"V\xe4st"},{id:"Kofta",text:"Kofta"},{id:"Linne",text:"Linne"},{id:"Tr\xe4ningstr\xf6ja",text:"Tr\xe4ningstr\xf6ja"},{id:"Poncho",text:"Poncho"},{id:"Pik\xe9",text:"Pik\xe9"},{id:"L\xe5ng\xe4rmad T-shirt",text:"L\xe5ng\xe4rmad T-shirt"},{id:"Kostymv\xe4st",text:"Kostymv\xe4st"}]},{text:"Underdelar",children:[{id:"Kjol",text:"Kjol"},{id:"Byxor",text:"Byxor"},{id:"Jeans",text:"Jeans"},{id:"Chinos",text:"Chinos"},{id:"Fritidsbyxor",text:"Fritidsbyxor"},{id:"Tr\xe4ningsbyxor",text:"Tr\xe4ningsbyxor"},{id:"Tights",text:"Tights"},{id:"Strumpbyxor",text:"Strumpbyxor"},{id:"Mjukisbyxor",text:"Mjukisbyxor"},{id:"Kostymbyxor",text:"Kostymbyxor"},{id:"Shorts",text:"Shorts"},{id:"Sarong",text:"Sarong"}]},{text:"Helkropp",children:[{id:"Kl\xe4nning",text:"Kl\xe4nning"},{id:"Kaftan",text:"Kaftan"},{id:"Kostym",text:"Kostym"},{id:"Set",text:"Set"},{id:"Jumpsuit",text:"Jumpsuit"},{id:"Baddr\xe4kt",text:"Baddr\xe4kt"},{id:"Bikini",text:"Bikini"},{id:"Pyjamas",text:"Pyjamas"},{id:"Morgonrock",text:"Morgonrock"},{id:"Br\xf6llopskl\xe4nning",text:"Br\xf6llopskl\xe4nning"},{id:"Balkl\xe4nning",text:"Balkl\xe4nning"},{id:"Bodysuit",text:"Bodysuit"},{id:"Underst\xe4ll",text:"Underst\xe4ll"}]},{text:"Ytterkl\xe4der",children:[{id:"Jacka",text:"Jacka"},{id:"Kappa",text:"Kappa"},{id:"Rock",text:"Rock"},{id:"Fritidsjacka",text:"Fritidsjacka"},{id:"Trenchcoat",text:"Trenchcoat"},{id:"Skinnjacka",text:"Skinnjacka"},{id:"Dunjacka",text:"Dunjacka"},{id:"Regnjacka",text:"Regnjacka"},{id:"P\xe4lsjacka",text:"P\xe4lsjacka"}]},{text:"Skor",children:[{id:"Sneakers",text:"Sneakers"},{id:"Sandaler",text:"Sandaler"},{id:"Klackar",text:"Klackar"},{id:"Ballerinaskor",text:"Ballerinaskor"},{id:"Loafers",text:"Loafers"},{id:"Flip-flops",text:"Flip-flops"},{id:"Boots",text:"Boots"},{id:"K\xe4ngor",text:"K\xe4ngor"},{id:"Vinterskor",text:"Vinterskor"},{id:"Skor",text:"Annat (Skor)"}]},{text:"V\xe4skor",children:[{id:"Axelremsv\xe4ska",text:"Axelremsv\xe4ska"},{id:"Handv\xe4ska",text:"Handv\xe4ska"},{id:"Kuvertv\xe4ska",text:"Kuvertv\xe4ska"},{id:"Ryggs\xe4ck",text:"Ryggs\xe4ck"},{id:"Tr\xe4ningsv\xe4ska",text:"Tr\xe4ningsv\xe4ska"},{id:"Resv\xe4ska",text:"Resv\xe4ska"},{id:"Datorv\xe4ska",text:"Datorv\xe4ska"},{id:"V\xe4ska",text:"Annat (V\xe4ska)"}]},{text:"Accessoarer",children:[{id:"Solglas\xf6gon",text:"Solglas\xf6gon"},{id:"Glas\xf6gon",text:"Glas\xf6gon"},{id:"\xd6rh\xe4nge",text:"\xd6rh\xe4nge"},{id:"Halsband",text:"Halsband"},{id:"Armband",text:"Armband"},{id:"Ring",text:"Ring"},{id:"Brosch",text:"Brosch"},{id:"Keps",text:"Keps"},{id:"Sjal",text:"Sjal"},{id:"Krage",text:"Krage"},{id:"B\xe4lte",text:"B\xe4lte"},{id:"Pl\xe5nbok",text:"Pl\xe5nbok"},{id:"Halsduk",text:"Halsduk"},{id:"Hatt",text:"Hatt"},{id:"M\xf6ssa",text:"M\xf6ssa"},{id:"Vantar",text:"Vantar"},{id:"Necess\xe4r",text:"Necess\xe4r"},{id:"Slips",text:"Slips"},{id:"Handduk",text:"Handduk"},{id:"Klocka",text:"Klocka"}]}]}),$("body").on("click",".select2-container--open .select2-results__group",function(){$(this).parent().attr("class").match(/expanded-group/)?$(this).parent().removeClass("expanded-group"):($(".expanded-group").first().removeClass("expanded-group"),$(this).parent().addClass("expanded-group"))});let e=!1;$("#itemCategory").on("select2:select",()=>{analytics.track("Click",{elementID:"itemCategoryValue"}),document.querySelector("#itemCategory").dispatchEvent(new Event("change"))});let t=!1;$("#itemCategory").on("select2:open",()=>{t||(t=!0,$("input.select2-search__field").on("click",()=>{analytics.track("Click",{elementID:"itemCategorySearch"})}))}),$("#itemCategory").on("select2:close",()=>{document.querySelector("body").style.overflow="auto",document.querySelector("body").style.position="static",document.querySelector("html").style.overflow="static"}),$("#itemCategory").on("select2:open",function(){analytics.track("Element Viewed",{elementID:"itemCategoryContainer"}),document.querySelector("body").style.overflow="hidden",document.querySelector("body").style.position="fixed",document.querySelector("html").style.overflow="fixed";let t=document.querySelector(".select2-search__field");if(t.placeholder="S\xf6k... (t.ex. Kl\xe4nning/Sneakers/Blus)",$(".select2-search__field").on("input",e=>{e.target.value.length>0?$(".select2-results__option[role=group]").each((e,t)=>$(t).addClass("expanded-group")):$(".expanded-group").each((e,t)=>$(t).removeClass("expanded-group"))}),!e){let t=document.getElementById("categoryPopUpHeader"),n=document.querySelector(".select2-dropdown");n.insertBefore(t,n.firstChild),t.style.display="block",t.querySelector("#categorySelectClose").onclick=()=>$("#itemCategory").select2("close"),e=!0}document.querySelector(".select2-results__options").addEventListener("scroll",()=>document.activeElement.blur())}),$("#itemCategory").on("change",ty("itemCategoryLabel")),// From https://github.com/select2/select2/issues/3015#issuecomment-570171720
$("#itemCategory").on("select2:open",function(){$(".select2-results").css("visibility","hidden")}),$("#itemCategory").on("select2:opening",function(){setTimeout(function(){$(".select2-results").css("visibility","visible")},50)})}let tj=async e=>{let t=async e=>{let t=new Image;return t.crossOrigin="Anonymous",t.src=e,await t.decode(),t},n=e=>{let[t,n,r,i]=[e[0],e[1],e[2],e[3]];for(let o=4;o<e.length;o+=4)if(e[o]!==t||e[o+1]!==n||e[o+2]!==r||e[o+3]!==i)return!1;return!0};try{if(e.match(/nobg|no-bg/i))return!0;let r=await t(e),i=document.createElement("canvas"),o=i.getContext("2d");i.width=r.naturalWidth,i.height=r.naturalHeight,o.drawImage(r,0,0,r.naturalWidth,r.naturalHeight);let a=o.getImageData(0,0,r.naturalWidth,10).data,l=o.getImageData(0,r.naturalHeight,r.naturalWidth,-10).data,s=o.getImageData(0,0,10,r.naturalHeight).data,d=o.getImageData(r.naturalWidth,0,-10,r.naturalHeight).data;return n(a)&&n(l)&&n(s)&&n(d)}catch(e){// If we cannot load the image, play it safe and assume it is the no-bg image
return console.error(e),!0}};// Call sellItemMain directly
tr(),// and call sellItemMainAuthenticated after/when a user has logged in
user.whenSet(tn)}();//# sourceMappingURL=sellItem.js.map

//# sourceMappingURL=sellItem.js.map
