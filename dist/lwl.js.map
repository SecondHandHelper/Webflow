{"mappings":"C,A,S,C,C,C,C,C,C,C,C,C,E,I,E,A,a,O,W,W,A,a,O,K,K,A,a,O,O,O,A,a,O,O,O,C,E,E,A,Y,O,C,C,E,E,C,C,E,C,E,E,K,E,C,E,E,A,a,O,Q,A,Y,O,O,O,E,O,O,C,I,C,Q,S,E,C,C,C,E,G,C,C,C,E,C,C,G,C,C,C,E,C,C,I,E,A,Y,O,C,C,E,E,C,C,E,C,G,C,G,E,O,E,E,C,G,G,E,O,E,E,C,G,G,G,A,U,O,E,O,E,G,I,E,A,M,uB,E,I,O,E,I,C,mB,C,C,E,O,C,S,C,E,I,E,C,C,E,C,E,C,E,C,O,A,M,E,E,C,E,E,K,C,C,E,I,E,C,C,E,C,I,E,M,C,G,C,C,E,C,E,C,I,C,E,O,C,E,E,E,O,C,I,C,C,O,C,C,E,C,O,C,S,E,C,E,I,E,E,O,C,G,M,A,C,I,E,C,E,E,E,C,C,E,e,C,C,E,E,M,C,S,C,E,I,C,E,C,E,I,C,M,C,E,I,C,O,C,C,C,E,E,O,C,E,E,K,C,E,E,M,C,E,E,Q,C,S,C,C,C,E,C,C,E,C,C,S,C,C,C,E,E,O,C,C,E,C,E,A,E,O,c,C,E,O,C,I,W,O,C,C,E,A,C,G,C,C,E,C,E,I,I,E,E,E,E,M,C,I,E,C,C,E,E,G,E,C,I,E,E,E,A,C,U,O,S,A,a,O,O,O,O,C,E,A,Y,O,Q,O,G,C,O,W,O,C,G,G,C,I,C,E,C,C,C,C,E,C,Q,C,S,C,C,C,C,C,ECGA,GAAI,AAAwB,SAAxB,AAFW,kBAEJ,YAAY,EACjB,aAAa,OAAO,CAAC,kBAAqB,CAAA,SAAS,QAAQ,CAAC,QAAQ,CAAC,YAAc,SAAS,QAAQ,CAAC,QAAQ,CAAC,UAAA,EAAa,CAC7H,SAAS,cAAc,CAAC,eAAe,KAAK,CAAC,OAAO,CAAG,OACvD,SAAS,cAAc,CAAC,kBAAkB,KAAK,CAAC,OAAO,CAAG,OAC1D,SAAS,cAAc,CAAC,eAAe,KAAK,CAAC,OAAO,CAAG,OACvD,SAAS,cAAc,CAAC,cAAc,KAAK,CAAC,OAAO,CAAG,OACtD,IAAM,EAAa,KAAK,KAAK,CAAC,aAAa,OAAO,CAAC,kBACnD,SAAS,OAAO,CAAC,UACb,MAAM,QAAQ,GAAG,CAAC,EAAW,GAAG,CAAC,AAAA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","sources":["<anon>","lwl.js"],"sourcesContent":["// modules are defined as an array\n// [ module function, map of requires ]\n//\n// map of requires is short require name -> numeric require\n//\n// anything defined in a previous bundle is accessed via the\n// orig method which is the require for previous bundles\n\n(function (modules, entry, mainEntry, parcelRequireName, globalName) {\n  /* eslint-disable no-undef */\n  var globalObject =\n    typeof globalThis !== 'undefined'\n      ? globalThis\n      : typeof self !== 'undefined'\n      ? self\n      : typeof window !== 'undefined'\n      ? window\n      : typeof global !== 'undefined'\n      ? global\n      : {};\n  /* eslint-enable no-undef */\n\n  // Save the require from previous bundle to this closure if any\n  var previousRequire =\n    typeof globalObject[parcelRequireName] === 'function' &&\n    globalObject[parcelRequireName];\n\n  var cache = previousRequire.cache || {};\n  // Do not use `require` to prevent Webpack from trying to bundle this call\n  var nodeRequire =\n    typeof module !== 'undefined' &&\n    typeof module.require === 'function' &&\n    module.require.bind(module);\n\n  function newRequire(name, jumped) {\n    if (!cache[name]) {\n      if (!modules[name]) {\n        // if we cannot find the module within our internal map or\n        // cache jump to the current global require ie. the last bundle\n        // that was added to the page.\n        var currentRequire =\n          typeof globalObject[parcelRequireName] === 'function' &&\n          globalObject[parcelRequireName];\n        if (!jumped && currentRequire) {\n          return currentRequire(name, true);\n        }\n\n        // If there are other bundles on this page the require from the\n        // previous one is saved to 'previousRequire'. Repeat this as\n        // many times as there are bundles until the module is found or\n        // we exhaust the require chain.\n        if (previousRequire) {\n          return previousRequire(name, true);\n        }\n\n        // Try the node require function if it exists.\n        if (nodeRequire && typeof name === 'string') {\n          return nodeRequire(name);\n        }\n\n        var err = new Error(\"Cannot find module '\" + name + \"'\");\n        err.code = 'MODULE_NOT_FOUND';\n        throw err;\n      }\n\n      localRequire.resolve = resolve;\n      localRequire.cache = {};\n\n      var module = (cache[name] = new newRequire.Module(name));\n\n      modules[name][0].call(\n        module.exports,\n        localRequire,\n        module,\n        module.exports,\n        this\n      );\n    }\n\n    return cache[name].exports;\n\n    function localRequire(x) {\n      var res = localRequire.resolve(x);\n      return res === false ? {} : newRequire(res);\n    }\n\n    function resolve(x) {\n      var id = modules[name][1][x];\n      return id != null ? id : x;\n    }\n  }\n\n  function Module(moduleName) {\n    this.id = moduleName;\n    this.bundle = newRequire;\n    this.exports = {};\n  }\n\n  newRequire.isParcelRequire = true;\n  newRequire.Module = Module;\n  newRequire.modules = modules;\n  newRequire.cache = cache;\n  newRequire.parent = previousRequire;\n  newRequire.register = function (id, exports) {\n    modules[id] = [\n      function (require, module) {\n        module.exports = exports;\n      },\n      {},\n    ];\n  };\n\n  Object.defineProperty(newRequire, 'root', {\n    get: function () {\n      return globalObject[parcelRequireName];\n    },\n  });\n\n  globalObject[parcelRequireName] = newRequire;\n\n  for (var i = 0; i < entry.length; i++) {\n    newRequire(entry[i]);\n  }\n\n  if (mainEntry) {\n    // Expose entry point to Node, AMD or browser globals\n    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js\n    var mainExports = newRequire(mainEntry);\n\n    // CommonJS\n    if (typeof exports === 'object' && typeof module !== 'undefined') {\n      module.exports = mainExports;\n\n      // RequireJS\n    } else if (typeof define === 'function' && define.amd) {\n      define(function () {\n        return mainExports;\n      });\n\n      // <script>\n    } else if (globalName) {\n      this[globalName] = mainExports;\n    }\n  }\n})({\"2mRjC\":[function(require,module,exports) {\nconst WS_SERVER = \"wss://lwl-to-mai-heypmjzjfq-ey.a.run.app\";\nconst params = getParamsObject();\nif (params.createDrafts === \"true\") {\n    if (localStorage.getItem(\"lwlItemDrafts\") && (document.referrer.includes(\"sign-in\") || document.referrer.includes(\"private\"))) {\n        document.getElementById(\"headerImage\").style.display = \"none\";\n        document.getElementById(\"threadInputDiv\").style.display = \"none\";\n        document.getElementById(\"lwlItemsDiv\").style.display = \"none\";\n        document.getElementById(\"loadingDiv\").style.display = \"flex\";\n        const draftItems = JSON.parse(localStorage.getItem(\"lwlItemDrafts\"));\n        authUser.whenSet(async ()=>{\n            await Promise.all(draftItems.map((item)=>firebase.app().functions(\"europe-west1\").httpsCallable(\"createItem\")({\n                    id: item.id,\n                    item\n                })));\n            localStorage.removeItem(\"lwlItemDrafts\");\n            location.href = \"/private#wardrobe\";\n        });\n    }\n}\nlet scrapingStarted = false;\nconst showParseError = (error)=>{\n    const message = error || \"Hittade inga plagg i tr\\xe5den, kontrollera att du skrivit in en giltig LWL tr\\xe5d. Eller kontakta oss om problemet kvarst\\xe5r.\";\n    document.getElementById(\"errorMessage\").innerText = message;\n    document.getElementsByClassName(\"w-form-fail\")[0].style.display = \"block\";\n    document.getElementById(\"lwlThreadUrl\").style.display = \"block\";\n    document.getElementById(\"buttonsDiv\").style.display = \"block\";\n    document.getElementById(\"doneButton\").style.display = \"flex\";\n    document.getElementById(\"introHeading\").style.display = \"block\";\n    document.getElementById(\"scrapeProgressDiv\").style.display = \"none\";\n    scrapingStarted = false;\n};\ndocument.getElementById(\"doneButton\").addEventListener(\"click\", ()=>{\n    if (scrapingStarted) return;\n    document.getElementsByClassName(\"w-form-fail\")[0].style.display = \"none\";\n    const lwlThreadUrl = document.getElementById(\"lwlThreadUrl\");\n    if (!lwlThreadUrl.value.length) {\n        console.log(\"No url thread given\");\n        return;\n    }\n    if (!lwlThreadUrl.value.match(/^https:\\/\\/www.facebook.com\\/groups\\/982264948455365\\/permalink\\/\\d+/)) {\n        showParseError(\"Ogilitg LWL url angiven.\");\n        return;\n    }\n    scrapingStarted = true;\n    document.getElementById(\"lwlThreadUrl\").style.display = \"none\";\n    document.getElementById(\"buttonsDiv\").style.display = \"none\";\n    document.getElementById(\"doneButton\").style.display = \"none\";\n    document.getElementById(\"introHeading\").style.display = \"none\";\n    document.getElementById(\"scrapeProgressDiv\").style.display = \"flex\";\n    document.getElementById(\"scrapeProgress\").innerText = \"Startar...\";\n    const webSocket = new WebSocket(WS_SERVER);\n    webSocket.addEventListener(\"open\", ()=>{\n        console.log(\"connected to lwl thread scraping server\");\n        webSocket.send(JSON.stringify({\n            url: lwlThreadUrl.value\n        }));\n    });\n    webSocket.addEventListener(\"error\", (event)=>{\n        showParseError();\n        webSocket.close();\n    });\n    webSocket.addEventListener(\"message\", async (event)=>{\n        console.log(\"received message from server\", event.data);\n        let message = event.data;\n        try {\n            message = JSON.parse(event.data);\n        } catch (e) {\n            message = {\n                status: \"Startar...\"\n            };\n        }\n        if (message.status === \"Error\") {\n            showParseError();\n            webSocket.close();\n            return;\n        }\n        message.status === \"Item\" && message.data;\n        document.getElementById(\"scrapeProgress\").innerText = message.status;\n        if (message.status.match(/klar/i)) {\n            webSocket.close();\n            document.getElementById(\"scrapeProgress\").innerText = \"Skapar plagg i Mai med data h\\xe4mtade fr\\xe5n LWL\";\n            if (!message.data.length) {\n                showParseError();\n                webSocket.close();\n                return;\n            }\n            const draftItemResponse = await firebase.app().functions(\"europe-west3\").httpsCallable(\"createItemDraftsFromLwl\", {\n                timeout: 240000\n            })({\n                itemData: message.data,\n                url: lwlThreadUrl\n            });\n            if (authUser.current) location.href = \"/private#wardrobe\";\n            else {\n                document.getElementById(\"scrapeProgressDiv\").style.display = \"none\";\n                document.getElementById(\"introHeading\").innerText = \"Plaggen fr\\xe5n din tr\\xe5d. Logga in f\\xf6r att l\\xe5ta Mai s\\xe4lja dem.\";\n                document.getElementById(\"introHeading\").style.display = \"block\";\n                // showLwLDraftItemsFromPreview(draftItemResponse.data);\n                showLwLDraftItems(draftItemResponse.data);\n                document.getElementById(\"buttonsDiv\").style.display = \"block\";\n                document.getElementById(\"signInButton\").style.display = \"flex\";\n                document.getElementById(\"signInButton\").addEventListener(\"click\", async ()=>{\n                    localStorage.setItem(\"lwlItemDrafts\", JSON.stringify(draftItemResponse.data));\n                    location.href = \"/sign-in\";\n                });\n            }\n        }\n    });\n});\nlet firstPreviewShown = false;\nconst addLwLItemPreview = (itemData)=>{\n    const itemCard = document.getElementsByClassName(\"lwlitemcard\")[0];\n    const itemList = document.getElementById(\"lwlItemList\");\n    if (!firstPreviewShown) {\n        document.getElementById(\"lwlItemsDiv\").style.display = \"block\";\n        itemList.innerHTML = \"\";\n        firstPreviewShown = true;\n    }\n    const newItemCard = itemCard.cloneNode(true);\n    newItemCard.classList.add(\"lwlItemCard\");\n    const frontImage = itemData.images?.[0];\n    if (frontImage) {\n        newItemCard.querySelector(\".img-container\").style.backgroundImage = `url(\"${frontImage}\")`;\n        newItemCard.querySelector(\".no-image-text\").style.display = \"none\";\n        newItemCard.style.opacity = \"0.5\";\n    } else newItemCard.querySelector(\".img-container\").style.display = \"none\";\n    newItemCard.querySelector(\".lwl-item-title\").innerText = \"\";\n    newItemCard.querySelector(\".lwl-item-subtext\").innerText = \"\";\n    itemList.appendChild(newItemCard);\n};\nconst showLwLDraftItemsFromPreview = (draftItems)=>{\n    const itemCards = document.getElementsByClassName(\"lwlItemCard\");\n    for (const itemCard of itemCards){\n        const itemImageUrl = itemCard.getElementsByClassName(\"img-container\")[0].style.backgroundImage.slice(4, -1).replaceAll(/\"/g, \"\");\n        const draftItem = draftItems.find((di)=>di.draftSourceProperties.rawData.images.includes(itemImageUrl));\n        itemCard.style.opacity = \"1\";\n        itemCard.querySelector(\".lwl-item-title\").innerText = `${draftItem.cleanedBrand || draftItem.brand?.trim()}`;\n        itemCard.querySelector(\".lwl-item-subtext\").innerText = `${[\n            draftItem.category,\n            draftItem.maiSize\n        ].filter((i)=>i).join(\", \")}`;\n    }\n};\nconst showLwLDraftItems = (draftItems)=>{\n    document.getElementById(\"lwlItemsDiv\").style.display = \"block\";\n    const itemCard = document.getElementById(\"lwlItemCard\") || document.getElementsByClassName(\"lwlItemCard\")[0];\n    const itemList = document.getElementById(\"lwlItemList\");\n    itemList.innerHTML = \"\";\n    for (const item of draftItems){\n        const newItemCard = itemCard.cloneNode(true);\n        newItemCard.id = `lwlItemCard${item.id}`;\n        newItemCard.classList.add(\"lwlItemCard\");\n        const frontImage = item.images?.frontImage;\n        if (frontImage) {\n            newItemCard.querySelector(\".img-container\").style.backgroundImage = `url(\"${frontImage}\")`;\n            newItemCard.querySelector(\".no-image-text\").style.display = \"none\";\n        } else newItemCard.querySelector(\".img-container\").style.display = \"none\";\n        newItemCard.querySelector(\".lwl-item-title\").innerText = `${item.cleanedBrand || item.brand?.trim()}`;\n        newItemCard.querySelector(\".lwl-item-subtext\").innerText = `${[\n            item.category,\n            item.maiSize\n        ].filter((i)=>i).join(\", \")}`;\n        itemList.appendChild(newItemCard);\n    }\n};\n//INTRO STUFF\ndocument.getElementById(\"introNext\").addEventListener(\"click\", ()=>{\n    if (document.getElementById(\"introNext\").innerText === \"S\\xe4tt ig\\xe5ng\") {\n        setCookie(\"lwlIntroSeen\", \"true\");\n        document.getElementById(\"introSection\").style.display = \"none\";\n    }\n    document.getElementById(\"introRightArrow\").click();\n    if (document.querySelector(\".w-slider-nav div:last-child\").classList.contains(\"w-active\")) document.getElementById(\"introNext\").innerText = \"S\\xe4tt ig\\xe5ng\";\n});\ndocument.getElementById(\"skipIntro\").addEventListener(\"click\", ()=>{\n    setCookie(\"lwlIntroSeen\", \"true\");\n    document.getElementById(\"introSection\").style.display = \"none\";\n});\nif (getCookie(\"lwlIntroSeen\") !== \"true\") document.getElementById(\"introSection\").style.display = \"flex\";\ndocument.getElementById(\"openIntroButton\").addEventListener(\"click\", ()=>{\n    document.getElementById(\"introSection\").style.display = \"flex\";\n});\n\n},{}]},[\"2mRjC\"], \"2mRjC\", \"parcelRequire81ca\")\n\n//# sourceMappingURL=lwl.js.map\n","const WS_SERVER = 'wss://lwl-to-mai-heypmjzjfq-ey.a.run.app';\nconst params = getParamsObject();\n\nif (params.createDrafts === 'true') {\n  if (localStorage.getItem('lwlItemDrafts') && (document.referrer.includes('sign-in') || document.referrer.includes('private'))) {\n    document.getElementById('headerImage').style.display = 'none';\n    document.getElementById('threadInputDiv').style.display = 'none';\n    document.getElementById('lwlItemsDiv').style.display = 'none';\n    document.getElementById('loadingDiv').style.display = 'flex';\n    const draftItems = JSON.parse(localStorage.getItem('lwlItemDrafts'));\n    authUser.whenSet(async () => {\n        await Promise.all(draftItems.map(item =>\n          firebase.app().functions(\"europe-west1\").httpsCallable('createItem')({id: item.id, item})\n        ));\n        localStorage.removeItem('lwlItemDrafts');\n        location.href = '/private#wardrobe';\n    });\n  }\n}\n\nlet scrapingStarted = false;\n\nconst showParseError = (error) => {\n  const message = error || 'Hittade inga plagg i tråden, kontrollera att du skrivit in en giltig LWL tråd. Eller kontakta oss om problemet kvarstår.';\n  document.getElementById('errorMessage').innerText = message;\n  document.getElementsByClassName('w-form-fail')[0].style.display = 'block';\n  document.getElementById('lwlThreadUrl').style.display = 'block';\n  document.getElementById('buttonsDiv').style.display = 'block';\n  document.getElementById('doneButton').style.display = 'flex';\n  document.getElementById('introHeading').style.display = 'block';\n  document.getElementById('scrapeProgressDiv').style.display = 'none';\n  scrapingStarted = false;\n}\n\ndocument.getElementById('doneButton').addEventListener('click', () => {\n  if (scrapingStarted) {\n    return;\n  }\n  document.getElementsByClassName('w-form-fail')[0].style.display = 'none';\n  const lwlThreadUrl = document.getElementById('lwlThreadUrl');\n  if (!lwlThreadUrl.value.length) {\n    console.log('No url thread given');\n    return;\n  }\n  if (!lwlThreadUrl.value.match(/^https:\\/\\/www.facebook.com\\/groups\\/982264948455365\\/permalink\\/\\d+/)) {\n    showParseError('Ogilitg LWL url angiven.');\n    return;\n  }\n  scrapingStarted = true;\n  document.getElementById('lwlThreadUrl').style.display = 'none';\n  document.getElementById('buttonsDiv').style.display = 'none';\n  document.getElementById('doneButton').style.display = 'none';\n  document.getElementById('introHeading').style.display = 'none';\n\n  document.getElementById('scrapeProgressDiv').style.display = 'flex';\n  document.getElementById('scrapeProgress').innerText = 'Startar...'\n  const webSocket = new WebSocket(WS_SERVER);\n  webSocket.addEventListener('open', () => {\n    console.log('connected to lwl thread scraping server');\n    webSocket.send(JSON.stringify({ url: lwlThreadUrl.value }));\n  });\n  webSocket.addEventListener('error', (event) => {\n    showParseError();\n    webSocket.close();\n  });\n  webSocket.addEventListener('message', async (event) => {\n    console.log('received message from server', event.data);\n    let message = event.data;\n    try {\n      message = JSON.parse(event.data);\n    } catch (e) {\n      message = { status: 'Startar...' };\n    }\n    if (message.status === 'Error') {\n      showParseError();\n      webSocket.close();\n      return;\n    }\n    if (message.status === 'Item' && message.data) {\n      // addLwLItemPreview(message.data);\n    }\n    document.getElementById('scrapeProgress').innerText = message.status;\n    if (message.status.match(/klar/i)) {\n      webSocket.close();\n      document.getElementById('scrapeProgress').innerText = 'Skapar plagg i Mai med data hämtade från LWL';\n      if (!message.data.length) {\n        showParseError();\n        webSocket.close();\n        return;\n      }\n      const draftItemResponse = await firebase.app().functions(\"europe-west3\").httpsCallable('createItemDraftsFromLwl', {timeout: 240 * 1000})({\n        itemData: message.data,\n        url: lwlThreadUrl\n      });\n      if (authUser.current) {\n        location.href = '/private#wardrobe';\n      } else {\n        document.getElementById('scrapeProgressDiv').style.display = 'none';\n        document.getElementById('introHeading').innerText = 'Plaggen från din tråd. Logga in för att låta Mai sälja dem.';\n        document.getElementById('introHeading').style.display = 'block';\n\n        // showLwLDraftItemsFromPreview(draftItemResponse.data);\n        showLwLDraftItems(draftItemResponse.data);\n        document.getElementById('buttonsDiv').style.display = 'block';\n        document.getElementById('signInButton').style.display = 'flex';\n        document.getElementById('signInButton').addEventListener('click', async () => {\n          localStorage.setItem('lwlItemDrafts', JSON.stringify(draftItemResponse.data));\n          location.href = '/sign-in';\n        });\n      }\n    }\n  });\n})\n\nlet firstPreviewShown = false;\nconst addLwLItemPreview = (itemData) => {\n  const itemCard = document.getElementsByClassName('lwlitemcard')[0];\n  const itemList = document.getElementById('lwlItemList');\n  if (!firstPreviewShown) {\n    document.getElementById('lwlItemsDiv').style.display = 'block'\n    itemList.innerHTML = '';\n    firstPreviewShown = true;\n  }\n  const newItemCard = itemCard.cloneNode(true);\n  newItemCard.classList.add('lwlItemCard');\n  const frontImage = itemData.images?.[0];\n  if (frontImage) {\n    newItemCard.querySelector('.img-container').style.backgroundImage = `url(\"${frontImage}\")`;\n    newItemCard.querySelector('.no-image-text').style.display = 'none';\n    newItemCard.style.opacity = '0.5';\n  } else {\n    newItemCard.querySelector('.img-container').style.display = 'none';\n  }\n  newItemCard.querySelector('.lwl-item-title').innerText = '';\n  newItemCard.querySelector('.lwl-item-subtext').innerText = '';\n  itemList.appendChild(newItemCard);\n}\n\nconst showLwLDraftItemsFromPreview = (draftItems) => {\n  const itemCards = document.getElementsByClassName('lwlItemCard');\n  for (const itemCard of itemCards) {\n    const itemImageUrl = itemCard.getElementsByClassName('img-container')[0].style.backgroundImage.slice(4,-1).replaceAll(/\"/g, '');\n    const draftItem = draftItems.find(di => di.draftSourceProperties.rawData.images.includes(itemImageUrl));\n    itemCard.style.opacity = '1';\n    itemCard.querySelector('.lwl-item-title').innerText = `${draftItem.cleanedBrand || draftItem.brand?.trim()}`;\n    itemCard.querySelector('.lwl-item-subtext').innerText = `${[draftItem.category, draftItem.maiSize].filter(i => i).join(', ')}`;\n  }\n}\n\nconst showLwLDraftItems = (draftItems) => {\n  document.getElementById('lwlItemsDiv').style.display = 'block'\n  const itemCard = document.getElementById('lwlItemCard') || document.getElementsByClassName('lwlItemCard')[0];\n  const itemList = document.getElementById('lwlItemList');\n  itemList.innerHTML = '';\n  for (const item of draftItems) {\n    const newItemCard = itemCard.cloneNode(true);\n    newItemCard.id = `lwlItemCard${item.id}`;\n    newItemCard.classList.add('lwlItemCard');\n    const frontImage = item.images?.frontImage;\n    if (frontImage) {\n      newItemCard.querySelector('.img-container').style.backgroundImage = `url(\"${frontImage}\")`;\n      newItemCard.querySelector('.no-image-text').style.display = 'none';\n    } else {\n      newItemCard.querySelector('.img-container').style.display = 'none';\n    }\n    newItemCard.querySelector('.lwl-item-title').innerText = `${item.cleanedBrand || item.brand?.trim()}`;\n    newItemCard.querySelector('.lwl-item-subtext').innerText = `${[item.category, item.maiSize].filter(i => i).join(', ')}`;\n    itemList.appendChild(newItemCard);\n  }\n}\n\n//INTRO STUFF\ndocument.getElementById('introNext').addEventListener('click', () => {\n  if (document.getElementById('introNext').innerText === 'Sätt igång') {\n    setCookie('lwlIntroSeen', 'true');\n    document.getElementById('introSection').style.display = 'none';\n  }\n  document.getElementById('introRightArrow').click();\n  if (document.querySelector('.w-slider-nav div:last-child').classList.contains('w-active')) {\n    document.getElementById('introNext').innerText = 'Sätt igång';\n  }\n});\ndocument.getElementById('skipIntro').addEventListener('click', () => {\n  setCookie('lwlIntroSeen', 'true');\n  document.getElementById('introSection').style.display = 'none';\n});\n\nif (getCookie('lwlIntroSeen') !== 'true') {\n  document.getElementById('introSection').style.display='flex';\n}\n\ndocument.getElementById('openIntroButton').addEventListener('click', () => {\n  document.getElementById('introSection').style.display = 'flex';\n});\n"],"names":["modules","entry","mainEntry","parcelRequireName","globalName","globalObject","globalThis","self","window","global","previousRequire","cache","nodeRequire","module","require","bind","newRequire","name","jumped","currentRequire","err","Error","code","localRequire","resolve","x","id","Module","call","exports","res","isParcelRequire","moduleName","bundle","parent","register","Object","defineProperty","get","i","length","mainExports","define","amd","params","getParamsObject","createDrafts","localStorage","getItem","document","referrer","includes","getElementById","style","display","draftItems","JSON","parse","authUser","whenSet","Promise","all","map","item","firebase","app","functions","httpsCallable","removeItem","location","href","scrapingStarted","showParseError","error","innerText","getElementsByClassName","addEventListener","lwlThreadUrl","value","console","log","match","webSocket","WebSocket","send","stringify","url","event","close","data","message","e","status","draftItemResponse","timeout","itemData","current","showLwLDraftItems","setItem","itemCard","itemList","innerHTML","newItemCard","cloneNode","classList","add","frontImage","images","querySelector","backgroundImage","cleanedBrand","brand","trim","category","maiSize","filter","join","appendChild","setCookie","click","contains","getCookie"],"version":3,"file":"lwl.js.map"}