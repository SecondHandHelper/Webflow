!// modules are defined as an array
// [ module function, map of requires ]
//
// map of requires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the require for previous bundles
function(t,n,i,r,o){/* eslint-disable no-undef */var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},l="function"==typeof a[r]&&a[r],s=l.cache||{},d="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function c(n,i){if(!s[n]){if(!t[n]){// if we cannot find the module within our internal map or
// cache jump to the current global require ie. the last bundle
// that was added to the page.
var o="function"==typeof a[r]&&a[r];if(!i&&o)return o(n,!0);// If there are other bundles on this page the require from the
// previous one is saved to 'previousRequire'. Repeat this as
// many times as there are bundles until the module is found or
// we exhaust the require chain.
if(l)return l(n,!0);// Try the node require function if it exists.
if(d&&"string"==typeof n)return d(n);var u=Error("Cannot find module '"+n+"'");throw u.code="MODULE_NOT_FOUND",u}g.resolve=function(i){var r=t[n][1][i];return null!=r?r:i},g.cache={};var m=s[n]=new c.Module(n);t[n][0].call(m.exports,g,m,m.exports,this)}return s[n].exports;function g(t){var n=g.resolve(t);return!1===n?{}:c(n)}}c.isParcelRequire=!0,c.Module=function(t){this.id=t,this.bundle=c,this.exports={}},c.modules=t,c.cache=s,c.parent=l,c.register=function(n,i){t[n]=[function(t,n){n.exports=i},{}]},Object.defineProperty(c,"root",{get:function(){return a[r]}}),a[r]=c;for(var u=0;u<n.length;u++)c(n[u]);if(i){// Expose entry point to Node, AMD or browser globals
// Based on https://github.com/ForbesLindesay/umd/blob/master/template.js
var m=c(i);// CommonJS
"object"==typeof exports&&"undefined"!=typeof module?module.exports=m:"function"==typeof define&&define.amd?define(function(){return m}):o&&(this[o]=m)}}({dxOtH:[function(t,n,i){var r=t("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(i),r.export(i,"loadItemCards",()=>m);var o=t("./general"),a=t("./private");async function l(t,n){console.log(`storeShippingMethod(${t}, ${n}) is running`),await db.collection("items").doc(t).update({shippingMethod:n}).then(i=>{console.log(`Shipping method '${n}' stored on item with ID: `,t),window.pickupFlowItemId=t,"Service point"==n&&(document.getElementById("feedbackFormTitle").innerHTML="Tack, d\xe5 vet vi att paketet snart l\xe4mnas till ett ombud.",document.getElementById("triggerShippingToastClose").click()),(0,a.closePickupToast)(),document.getElementById("triggerFeedbackFormOpen").click()})}function s(t,n){console.log(`openShippingToast(${t}, ${n})`),window.pickupFlowItemId=t,setTimeout(()=>{document.getElementById("servicePointButton").addEventListener("click",async()=>{await l(t,"Service point")}),document.getElementById("bookPickupButton").addEventListener("click",()=>{d(t,n)})},0),triggerShippingToastOpen.click()}function d(t,n,i="none"){console.log(`openPickupToast(${t}, ${n}) is running`),triggerShippingToastClose.click(),triggerServicePointToastClose.click(),changeToServicePointButton.addEventListener("click",async()=>{await l(t,"Service point")}),changeToServicePointButton.style.display=i,function(t){console.log(`setDatesOfPickupToast(${t}) is running`),// Hide all options first, to later determine which ones to show
radioFieldOne.style.display="none",radioFieldTwo.style.display="none",radioFieldThree.style.display="none",radioFieldFour.style.display="none";// Create the 4 first possible pickup dates, starting 4 b-days after soldDate
var n=new Date(t);n.setTime(n.getTime()+36e5),n.setDate(n.getDate()+4),6==n.getDay()||0==n.getDay()||1==n.getDay()||2==n.getDay()?n.setDate(n.getDate()+2):3==n.getDay()&&n.setDate(n.getDate()+1);var i=new Date(n);i.setDate(i.getDate()+1),6==i.getDay()&&i.setDate(i.getDate()+2);var r=new Date(i);r.setDate(r.getDate()+1),6==r.getDay()&&r.setDate(r.getDate()+2);var o=new Date(r);o.setDate(o.getDate()+1),6==o.getDay()&&o.setDate(o.getDate()+2);var a=["S\xf6ndag","M\xe5ndag","Tisdag","Onsdag","Torsdag","Fredag","L\xf6rdag"],l=["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"];// Change value of radio buttons and display to user
let s=new Date,d=0;console.log("Today",s),console.log("firstDate > today",n>s),console.log("secondDate > today",i>s),console.log("thirdDate > today",r>s),console.log("forthDate > today",o>s);let c=document.getElementById("pickupDateOne"),u=document.getElementById("pickupDateTwo"),m=document.getElementById("pickupDateThree"),g=document.getElementById("pickupDateFour");// If less than two options displayed, add at least two options
if(n>s&&($("#radioButtonOne").val(n.toISOString().split("T")[0]),c.innerHTML=a[n.getDay()]+", "+n.getDate()+" "+l[n.getMonth()]+", kl 9-16",radioFieldOne.style.display="flex",d++),i>s&&($("#radioButtonTwo").val(i.toISOString().split("T")[0]),u.innerHTML=a[i.getDay()]+", "+i.getDate()+" "+l[i.getMonth()]+", kl 9-16",radioFieldTwo.style.display="flex",d++),r>s&&($("#radioButtonThree").val(r.toISOString().split("T")[0]),m.innerHTML=a[r.getDay()]+", "+r.getDate()+" "+l[r.getMonth()]+", kl 9-16",radioFieldThree.style.display="flex",d++),o>s&&($("#radioButtonFour").val(o.toISOString().split("T")[0]),g.innerHTML=a[o.getDay()]+", "+o.getDate()+" "+l[o.getMonth()]+", kl 9-16",radioFieldFour.style.display="flex",d++),d<2){radioFieldOne.style.display="none",radioFieldTwo.style.display="none",radioFieldThree.style.display="none",radioFieldFour.style.display="none";var p=new Date;p.setDate(s.getDate()+1),0==p.getDay()?p.setDate(p.getDate()+1):6==p.getDay()&&p.setDate(p.getDate()+2);var y=new Date(p);y.setDate(y.getDate()+1),6==y.getDay()&&y.setDate(y.getDate()+2),console.log("dayOne: ",p),console.log("dayTwo: ",y),// Show tomorrow as an option
$("#radioButtonOne").val(p.toISOString().split("T")[0]),c.innerHTML=a[p.getDay()]+", "+p.getDate()+" "+l[p.getMonth()]+", kl 9-16",radioFieldOne.style.display="flex",// Show day after tomorrow as an option
$("#radioButtonTwo").val(y.toISOString().split("T")[0]),u.innerHTML=a[y.getDay()]+", "+y.getDate()+" "+l[y.getMonth()]+", kl 9-16",radioFieldTwo.style.display="flex"}}(n),window.pickupFlowItemId=t,triggerPickupAnimation.click()}function c(t,n,i,r){t.checked?(db.collection("items").doc(n).update({bagReceived:!0}).then(t=>{console.log("Stored in DB that bag is received for item with ID: ",n)}),"Pickup"===r)?d(n,i,"flex"):"Service point"===r?(console.log("openServicePointToast"),changeToPickupButton.addEventListener("click",()=>{d(n,i)}),triggerServicePointToastOpen.click()):s(n,i):db.collection("items").doc(n).update({bagReceived:!1}).then(t=>{console.log("Stored in DB that bag is NOT received for item with ID: ",n)})}function u(t,n,i){let r=`<div class="w-form">
            <form method="get" name="wf-form-" id="bagReceivedForm">
                <label class="w-checkbox checkbox-field-3">
                    <div class="w-checkbox-input w-checkbox-input--inputType-custom checkbox-2"></div>
                    <input type="checkbox" id="bagReceivedCheckbox-${t}" style="opacity:0;position:absolute;z-index:-1">
                    <span class="checkbox-label-3 w-form-label">Etiketten har kommit</span>
                </label>
            </form>
        </div>`;return r}function m(t,n=null){itemListSelling.innerHTML="",itemListSoldNotSent.innerHTML="",itemListSold.innerHTML="";var i=0;(t||[]).forEach(t=>{let r,a;var l=t.id,m=t.soldDate,g=t.status,p=t.shippingStatus,y=t.brand,f=t.soldPrice,x=t.sellerGets?Math.ceil(t.sellerGets):t.sellerGets,v="Brand Gift Card"===t.payoutType?f:x,k=t.buyer?.FirstName||t.buyerFirstName,h=t.buyer?.City||t.buyerAddressCity,b=t.minPriceEstimate,I=t.maxPriceEstimate,S=t.infoRequests,B=t.pickupDate,w=t.shippingMethod,T=t.postnordQrCode,E=t.dhlLicensePlateBarcodeSrc,L=t.upsShipmentId,D=t.bagReceived,C=t.soldPlatform,M=t.archived,P=t.holidayMode,j=t.longerPeriodAcceptedDate;t.images;var F=(0,o.itemCoverImage)(t);let H="",N=t.publishedDate;if(N){N=new Date(N);let t=Math.round((j?60:30)-(r=(new Date().getTime()-N.getTime())/864e5));H=t<=0?"0 dagar kvar":`${t} dagar kvar`}if(m){let t=new Date(m),n=new Date;t.setHours(0,0,0,0),n.setHours(0,0,0,0),a=Math.round((n-t)/864e5)}M||"Unsold"===g||function(){//Putting the items in the right list
let o=window.location.origin+`/item?id=${l}`;// WE SELL RIGHT NOW
if("Sold"!==g){let t="",i="";if("New"===g&&(S?.price?.status==="Active"?t=`<div class='text-block-34'>Inv\xe4ntar ditt svar</div>`:b&&I?(t=`<div class='text-block-34'>${b} - ${I} kr</div>`,i=`<div class='text-block-34'>F\xf6rbereds</div>`):t=`<div class='text-block-34'>V\xe4rdering p\xe5g\xe5r</div>`),"Published"===g&&b&&I){t=`<div class='text-block-34'>${b} - ${I} kr</div>`;let o=n?.specialDeal?`Live (${Math.round(r)} dagar)`:H;i=`<div class='text-block-34'>${P?"Pausad":o}</div>`}let a=`<div class="div-block-14-big"><a id="itemLinkBlock" href="${o}" class="link-block-18 w-inline-block"><div class="ratio-box _16-9"><div class="conten-block with-image"><div class="img-container" style="background-image: url('${F}');"></div></div></div><div class="text-block-14">${y}</div>${t}${i}</a></div>`;itemListSelling.innerHTML+=a,//Display list
myItemsDiv.style.display="block",//Hide empty state
noItemsDiv.style.display="none",headerSellItemButton.style.display="block",sellButtonText.innerHTML="S\xe4lj ett plagg";// SOLD - NOT SENT
}else if("Sold"!=g||"Not sent"!=p&&p){let n="Brand Gift Card"===t.payoutType?"<br> (Presentkort)":"";var x=`<div class="item-card-small"><div class="ratio-box _16-9"><div class="conten-block with-image"><a id="itemLinkFromSoldBeforeSection" href="${o}"><div class="img-container" style="background-image: url('${F}');"></div></a></div></div><div class="text-block-14">${f} kr</div><div class='text-block-34'>${"Payed"===t.payoutStatus?"Du fick":"Du f\xe5r"} ${v} kr${n}</div></div>`;itemListSold.innerHTML+=x,// Display list, hide empty state
soldItemsDiv.style.display="block",itemListSoldContainer.style.display="block",sellButtonText.innerHTML="S\xe4lj ett plagg",i+=v,youEarnedDiv.innerHTML=`Du har tj\xe4nat ${Math.round(i).toLocaleString("en-US").replaceAll(","," ")} kr`}else{// Prepare card
let n="Vestiaire Collective"===C&&a>7;var M="",j="";let i="",r="",g="",p=`Du f\xe5r ${v} kr`,y="",x="";if(n)M=function(t){let n=window.location.origin+`/sell-item?id=${t}`,i=`<a id="resellButton" href="${n}" class="link-block-39">
                            <div class="div-block-194">
                                            <div class="text-block-113">L\xe4gg upp p\xe5 nytt</div>
                            </div>
                    </a>`;return i}(l),p="K\xf6paren avbr\xf6t k\xf6pet",y="Skickades ej inom 7 dagar",r+=`
          <a id="removeItemButton-${l}" href="#" class="link-block-87">
              <img src="https://global-uploads.webflow.com/6297d3d527db5dd4cf02e924/65269f37a18d8c128d29ed1c_trash-can%20(1).svg" class="image-154">
              <div class="text-block-373">Ta bort plagg</div>
          </a>`,setTimeout(()=>{document.getElementById(`removeItemButton-${l}`).addEventListener("click",()=>{itemMoreMenu.style.display="block",setTimeout(()=>itemMoreMenu.classList.add("sticky-bottom-show"),0),itemMoreMenu.dataset.itemId=l,itemMoreMenu.dataset.section="sold-not-sent",e.preventDefault(),e.stopPropagation()})},0);else{if(null!=k&&null!=h&&f){let n=isBrandPartner(t.brand)?.giftCards,i=`S\xe5ld till ${k} i ${h}${n?"":" f\xf6r "+f+" kr"}`;if(n)y=i.trim();else{// Split sentence into two equally long rows
let t="",n=i.split(" ");n.forEach(function(n){t.trim().length>i.length/2&&!t.includes("<br>")&&(t+="<br>"),t+=n+" "}),y=t.trim()}y="Brand Gift Card"===t.payoutType?`(${brandPartners[t.brand].name}-presentkort)<br>`+y:y,x=n&&"Brand Gift Card"!==t.payoutType?`\xc4ndra till ${f} kr i presentkort?`:""}"Service point"===w&&(E?(M=function(t){let n=window.location.origin+`/ship-item?id=${t}`,i=`<a id="barcodeButton" href="${n}" class="link-block-39">
                            <div class="div-block-194">
                                            <img src="https://global-uploads.webflow.com/6297d3d527db5dd4cf02e924/65418186f29682eaff3f74be_barcode-icon%20(1).svg" class="image-100">
                                            <div class="text-block-113">Visa streckkod</div>
                            </div>
                    </a>`;return i}(l),g="dhl"):"Vestiaire Collective"===C||"Grailed"===C?D||(M=u(l,m,w),L&&(g="ups"),setTimeout(()=>{document.getElementById(`bagReceivedCheckbox-${l}`).addEventListener("click",t=>{c(t.target,l,m,w)})},0)):T&&(g="postnord",M=function(t){let n=window.location.origin+`/ship-item?id=${t}`,i=`<a id="qrCodeButton" href="${n}" class="link-block-39">
                            <div class="div-block-194">
                                            <img src="https://global-uploads.webflow.com/6297d3d527db5dd4cf02e924/63bdeaf1af902f05607f86ef_Group.svg" class="image-43">
                                            <div class="text-block-113">Visa QR</div>
                            </div>
                    </a>`;return i}(l))),"Pickup"===w&&(D?D&&!B&&(M=function(t){let n=`<a id="bookPickupButton-${t}" href="#" class="link-block-39">
                            <div class="div-block-194">
                                <div class="text-block-113">Boka h\xe4mtning</div>
                            </div>
                    </a>`;return n}(l),setTimeout(()=>{document.getElementById(`bookPickUpButton-${l}`).addEventListener("click",()=>{d(l,m)})},0)):(M=u(l,m,w),setTimeout(()=>{document.getElementById(`bagReceivedCheckbox-${l}`).addEventListener("click",t=>{c(t.target,l,m,w)})},0))),// Always show the 'shippingInfoDiv' - Styling depending on state is set in the function
j=function(t,n,i,r,o,a){let l="",s=o&&(!o||"Pickup"!=n||r)?"":'<img src="https://global-uploads.webflow.com/6297d3d527db5dd4cf02e924/63be70f55a4305a398cf918e_info-icon.svg" class="image-44">',d=window.location.origin+`/ship-item?id=${t}`;if("Service point"==n){let t="6297d3d527db5dd4cf02e924/6399ac2a3505ee6071fbc18a_Vector%20(1).svg";"postnord"===a&&(t="6297d3d527db5dd4cf02e924/655d182c37fc30df71b078cd_postnord-square-icon%20(1).svg"),"dhl"===a&&(t="6297d3d527db5dd4cf02e924/655d1830f259c0bc084c2937_dhl-square-icon%20(1).svg"),"ups"===a&&(t="6297d3d527db5dd4cf02e924/6603eaef0d5af57f5cce2e40_ups-squared-icon.jpg"),l+=`
                        <img src="https://global-uploads.webflow.com/${t}" class="shipper-icon">
                        <div class="next-step-text-small">L\xe4mnas till ombud</div>
                        ${s}
                    `}else if("Pickup"==n){if(r){var c=new Date(r),u=c.getDate(),m=["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"][c.getMonth()],g=["S\xf6n","M\xe5n","Tis","Ons","Tors","Fre","L\xf6r"][c.getDay()];l+=`
                                <img src="https://global-uploads.webflow.com/6297d3d527db5dd4cf02e924/63999dabb3be9ead61bf6488_Vector.svg" class="image-45">
                                <div class="next-step-text-small">${g+", "+u+" "+m+", kl 9-16"}</div>`}else l+=`
                            <img src="https://global-uploads.webflow.com/6297d3d527db5dd4cf02e924/63999dabb3be9ead61bf6488_Vector.svg" class="image-45">
                            <div class="next-step-text-small">Upph\xe4mtning</div>
                            ${s}
                        `}// Turn shipping info into a link to ship item page
let p=`
                        <a id="shipItemPageLink" href="${d}" class="link-block-40">
                                ${l}
                        </a>`;return p}(l,w,0,B,D,g),D&&("Service point"===w||"Pickup"===w&&B)&&(j='<div class="spacing-15-px"></div>'+j,i+=`
          <a id="changeShippingMethodA-${l}" href="#">
              <div id="changeShippingMethod-${l}" class="change-shipping-method-text">\xc4ndra frakts\xe4tt</div>
          </a>`,setTimeout(()=>{document.getElementById(`changeShippingMethodA-${l}`).addEventListener("click",()=>{s(l,m)})},0))}//Create card
var N="";N=`<div class="div-block-118"><div class="div-block-45"><div class="div-block-43"><div class="ratio-box _16-9"><div class="content-block with-image"><a id="itemLinkFromSoldNotSentSection" href="${o}"><div class="img-container" style="background-image: url('${F}');"></div></a></div></div></div><div class="div-block-46">
          <a id="youGetLink-${l}" href="#" class="you-get-link">
              <div class="text-block-43" id="text1-${l}">${p}</div>
              ${"K\xf6paren avbr\xf6t k\xf6pet"!==p?'<img src="https://global-uploads.webflow.com/6297d3d527db5dd4cf02e924/63be70f55a4305a398cf918e_info-icon.svg" class="you-get-info-icon"></img>':""}
          </a>
          <div class="text-block-44" id="text2-${l}">${y}</div>
          ${x?`<div class="change-to-gift-card-text" id="convertToGiftCardDiv-${l}"><a id="convertToGiftCard-${l}">${x}</a></div>`:""}
          ${M}
          ${j}
          ${i}
          ${r}
          </div></div></div></div>`,setTimeout(()=>{document.getElementById(`youGetLink-${l}`).addEventListener("click",()=>{console.log(`clicked youGetLink-${l}`),function(t,n){priceAfterPlatformFee.innerHTML=t;let i=t-n;commissionAmount.innerHTML=0===i?"-":"-"+i,i/t>.9&&i/t<.11&&(commissionTitle.innerHTML="Rabatterad kommission (10%)"),i/t>.19&&i/t<.21&&(commissionTitle.innerHTML="Kommission (20%)"),i/t>.29&&i/t<.31&&50!==i&&500!==i&&(commissionTitle.innerHTML="Kommission (30%)"),i<1&&(commissionTitle.innerHTML="Fri kommission (0%)"),youGetAmount.innerHTML=n,youGetInfoBox.style.display="flex",darkOverlay.style.display="block",closeYouGetInfoBox.addEventListener("click",()=>{youGetInfoBox.style.display="none",darkOverlay.style.display="none"})}(f,v)}),document.getElementById(`convertToGiftCard-${l}`)?.addEventListener("click",()=>{var n;let i=t?.images?.modelImage||t?.images?.enhancedFrontImageSmall||t?.images?.enhancedFrontImage||t?.images?.frontImageSmall||t?.images?.frontImage;n=t.brand,document.getElementById("convertGiftCardInfoBox").style.display="flex",document.querySelector(".dark-overlay").style.display="block",document.getElementById("giftCardItemImage").src=i,document.getElementById("giftCardText").innerText=`Vill du f\xe5 ${f}kr (100% av vinsten) att handla f\xf6r p\xe5 ${brandPartners[n].url} ist\xe4llet?`,document.getElementById("closeGiftCardBox").addEventListener("click",()=>{document.getElementById("convertGiftCardInfoBox").style.display="none",document.querySelector(".dark-overlay").style.display="none"}),document.getElementById("closeGiftCardBoxButton").addEventListener("click",()=>{document.getElementById("convertGiftCardInfoBox").style.display="none",document.querySelector(".dark-overlay").style.display="none"}),// This is updating the dataset with the itemId, brand and soldPrice, to be used when the user clicks the button
document.getElementById("convertToGiftCardButton").dataset.currentItemId=l,document.getElementById("convertToGiftCardButton").dataset.currentBrand=n,document.getElementById("convertToGiftCardButton").dataset.currentSoldPrice=f})},0),itemListSoldNotSent.innerHTML+=N,// Display list
soldNotSentDiv.style.display="block",// Hide empty state
noItemsDiv.style.display="none",headerSellItemButton.style.display="block",sellButtonText.innerHTML="S\xe4lj ett plagg";// SOLD BEFORE
}}()}),loadingDiv.style.display="none",sectionsDiv.style.display="block",analytics.track("Element Viewed",{elementID:"sectionsDiv"}),quickInfoDiv.style.display="block"}t("./sellItemHelpers"),document.getElementById("convertToGiftCardButton").addEventListener("click",async()=>{let t=document.getElementById("convertToGiftCardButton").dataset.currentItemId,n=document.getElementById("convertToGiftCardButton").dataset.currentBrand,i=document.getElementById("convertToGiftCardButton").dataset.currentSoldPrice;await callBackendApi(`/api/items/${t}`,{data:{payoutType:"Brand Gift Card"},method:"PUT"}),document.getElementById("convertGiftCardInfoBox").style.display="none",document.querySelector(".dark-overlay").style.display="none",document.getElementById(`convertToGiftCardDiv-${t}`).style.display="none",document.getElementById(`text1-${t}`).innerHTML=document.getElementById(`text1-${t}`).innerHTML.replace(/\d+/,i),document.getElementById(`text2-${t}`).innerHTML=`(${brandPartners[n].name}-presentkort)<br>`})},{"./general":"1tOWF","./private":"flS2m","./sellItemHelpers":"2G59s","@parcel/transformer-js/src/esmodule-helpers.js":"bNgzC"}],"1tOWF":[function(t,n,i){var r=t("@parcel/transformer-js/src/esmodule-helpers.js");function o(){firebase.auth().signOut().then(()=>{console.log("User signed out"),authUser.current=null,user.current=null,userId=null,localStorage.removeItem("sessionUser"),localStorage.removeItem("idToken"),localStorage.removeItem("authUserId"),localStorage.removeItem("authUser"),deleteCookie("maiAuth"),location.href="/"}).catch(t=>{errorHandler.report(t),console.log(t)})}function a(t){document.getElementById("addressFirstName").value=t.addressFirstName||"",document.getElementById("addressFirstName").dispatchEvent(new Event("input")),document.getElementById("addressLastName").value=t.addressLastName||"",document.getElementById("addressLastName").dispatchEvent(new Event("input")),document.getElementById("addressStreetAddress").value=t.addressStreetAddress||"",document.getElementById("addressStreetAddress").dispatchEvent(new Event("input")),document.getElementById("addressCO").value=t.addressCO||"",document.getElementById("addressCO").dispatchEvent(new Event("input")),document.getElementById("addressPostalCode").value=t.addressPostalCode||"",document.getElementById("addressPostalCode").dispatchEvent(new Event("input")),document.getElementById("addressCity").value=t.addressCity||"",document.getElementById("addressCity").dispatchEvent(new Event("input")),document.getElementById("addressDoorCode").value=t.addressDoorCode||"",document.getElementById("addressDoorCode").dispatchEvent(new Event("input"))}function l(){let t=document.getElementById("addressFirstName").value,n=document.getElementById("addressLastName").value,i=document.getElementById("addressStreetAddress").value,r=document.getElementById("addressCO").value,o=document.getElementById("addressPostalCode").value,a=document.getElementById("addressCity").value,l=document.getElementById("addressDoorCode").value;return t=t?t.trim().charAt(0).toUpperCase()+t.trim().slice(1):"",n=n?n.trim().charAt(0).toUpperCase()+n.trim().slice(1):"",i=i?i.trim().charAt(0).toUpperCase()+i.trim().slice(1):"",r=r?r.trim():"",{addressFirstName:t,addressLastName:n,addressStreetAddress:i,addressCO:r,addressPostalCode:o=o?o.trim().replace(/\D/g,""):"",addressCity:a=a?a.trim().charAt(0).toUpperCase()+a.trim().slice(1):"",addressDoorCode:l=l?l.trim():""}}function s(t){// verify we got 10 digits, otherwise it is invalid
if(10!==(t=t.replace(/\D/g,"")// strip out all but digits
.split("")// convert string to array
.reverse()// reverse order for Luhn
.slice(0,10)).length)return!1;let n=t.map(t=>Number(t)).reduce((t,n,i)=>(i%2&&(n*=2),n>9&&(n-=9),t+n));return 0==n%10}function d(t){let n=t.replace("-","");return(12!==n.length&&("19"!==n.substring(0,2)||"20"!==n.substring(0,2))&&(n=99>=Number(n.substring(0,2))&&Number(n.substring(0,2))>25?"19"+n:"20"+n),12===n.length)?n:null}function c(t){if(t.images){let n=t.images;return n.modelImageSmall||n.modelImage||n.coverImageSmall||n.coverImage||n.enhancedFrontImageSmall||n.enhancedFrontImage||n.frontImageSmall||n.frontImage}if(t.imagesv2)for(let n of["modelImage","enhancedFrontImage","frontImage"]){let i=t.imagesv2.find(t=>t.name===n);if(i){if(i.versions.small)return i.versions.small;if(i.versions.medium)return i.versions.medium;if(i.versions.large)return i.versions.large;if(i.url)return i.url}}return null}function u(){let t=user.current.referralData.referralCode,n=`Hej! F\xf6lj min personliga l\xe4nk s\xe5 s\xe4ljer Mai ditt f\xf6rsta plagg kostnadsfritt! Mai sk\xf6ter f\xf6rs\xe4ljningen av dina kl\xe4der, inklusive v\xe4rdering, l\xe4gger ut p\xe5 flera plattformar samtidigt, har kontakten med k\xf6pare och ordnar med frakt n\xe4r det blir s\xe5lt. Man f\xe5r sj\xe4lv beh\xe5lla 80% av vinsten, och blir det inte s\xe5lt kostar det ingenting.

Om du registrerar dig med min kod (f\xf6lj l\xe4nken) och provar s\xe4lja ett plagg inom 7 dagar f\xe5r du beh\xe5lla 100% av vinsten f\xf6r det f\xf6rsta plagget (ist\xe4llet f\xf6r 80%). Min kod: ${t}`;if(navigator.share)navigator.share({text:n,url:`https://invite.maiapp.se/refer?invite=${t}`}).then(()=>{console.log("Thanks for sharing!")}).catch(t=>{console.error(t),errorHandler.report(t)});else{console.log("Browser doesn't support navigator.share => Copy to clipboard!");let i=n+"\n"+`https://invite.maiapp.se/refer?invite=${t}`;navigator.clipboard.writeText(i),linkCopiedBanner.style.display="flex",setTimeout(function(){linkCopiedBanner.style.display="none"},1500)}}function m(t){let n=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;n?(document.getElementById("continueOnWebBottomSheet").href=window.location.origin+t,document.getElementById("darkOverlay").classList.add("active"),document.getElementById("channelBottomSheet").classList.add("active")):window.location.href=t}function g(){document.getElementById("darkOverlay").classList.remove("active"),document.getElementById("channelBottomSheet").classList.remove("active")}r.defineInteropFlag(i),r.export(i,"signOut",()=>o),r.export(i,"setFormAddressFields",()=>a),r.export(i,"getFormAddressFields",()=>l),// Validate Swedish Social Security Number (personnummer) using checksum
//   Note: this is somewhat simplified because it does not take into account
//   that the date of the number is valid (e.g. "000000-0000" does return as true)
r.export(i,"isValidSwedishSsn",()=>s),r.export(i,"formatPersonalId",()=>d),r.export(i,"itemCoverImage",()=>c),r.export(i,"shareCode",()=>u),// Channel bottom sheet
r.export(i,"channelRouter",()=>m),r.export(i,"hideChannelBottomSheet",()=>g)// End of channel bottom sheet
},{"@parcel/transformer-js/src/esmodule-helpers.js":"bNgzC"}],bNgzC:[function(t,n,i){i.interopDefault=function(t){return t&&t.__esModule?t:{default:t}},i.defineInteropFlag=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.exportAll=function(t,n){return Object.keys(t).forEach(function(i){"default"===i||"__esModule"===i||n.hasOwnProperty(i)||Object.defineProperty(n,i,{enumerable:!0,get:function(){return t[i]}})}),n},i.export=function(t,n,i){Object.defineProperty(t,n,{enumerable:!0,get:i})}},{}],flS2m:[function(t,n,i){var r,o=t("@parcel/transformer-js/src/esmodule-helpers.js");o.defineInteropFlag(i),o.export(i,"updateIC",()=>c),o.export(i,"closePickupToast",()=>S);var a=t("./general"),l=t("./infoRequestsFunctions"),s=t("./loadItemCards");async function d(){let t=await callBackendApi("/api/users/token",{method:"POST",requiresAuth:!0});document.getElementById("openAppAndSignIn").href="maiapp://?aat="+encodeURIComponent(t.data.customToken)}function c(t,n,i){let r=n,o=i;null===r&&(r=""),null===o&&(o=""),window.intercomSettings={app_id:"klyy0le5",user_id:`${t}`},db.collection("users").doc(t).get().then(n=>{if(n.exists){let a=n.data(),l="",s="";if(a.addressFirstName){let t=a.addressFirstName,n=a.addressLastName;l=t+" "+n,s=a.addressCity}a.phoneNumber&&(o=a.phoneNumber);// Update intercom
var i={mai_user_id:`${t}`,user_id:`${t}`,phone:`${o}`,email:`${r}`,name:`${l}`,city:`${s}`};Intercom("update",i)}else console.log("No such user document exist!")}).catch(t=>{errorHandler.report(t),console.log("Error getting document:",t)})}function u(t){let n,i;console.log("Prepare menu",t.signInMethod),"phone"===t.signInMethod&&t.phoneNumber?(n=t.phoneNumber,i="Inloggad med SMS-kod"):"password"===t.signInMethod&&t.email?(n=t.email,i="Inloggad med email"):"google.com"===t.signInMethod&&t.email&&(n=t.email,i="Inloggad med Google"),n&&(account.innerHTML=n,account.style.display="block",accountSignInMethod.innerHTML=i,accountSignInMethod.style.display="block"),t.addressFirstName&&t.addressLastName&&(accountName.innerHTML=t.addressFirstName+" "+t.addressLastName,accountName.style.display="block"),t?.referralData?.referralCode&&(referralCodeText.innerHTML=t.referralData.referralCode,headerInviteButton.style.display="flex",menuInviteLink.style.display="block")}d(),setInterval(d,6e5);let m=JSON.parse(localStorage.getItem("sessionUser"));async function g(){try{let t=await callBackendApi("/api/bags/orders/allowed",{requiresAuth:!0});t?.data?.maxOrderBags>0&&(document.getElementById("orderBagsSection").style.display="block")}catch(t){console.log(t)}}async function p(t){let n,i="",r="",o=!0,a=!1,l=!1,s=!1,d=!1;// First, get items with status "Sold" and shippingStatus "Not sent"
await db.collection("items").where("user","==",t).where("status","==","Sold").orderBy("soldDate").get().then(t=>{t.forEach(t=>{t.data().status,i=t.data().shippingStatus;let n=t.data().payoutStatus,r=t.data().saleApprovalStatus;"Not sent"===i&&(s=!0),"Payed"!==n&&(a=!0,"Approved"===r&&(l=!0))})}),// Second, check if user has no address or personal id added yet
await db.collection("users").doc(t).get().then(t=>{r=t.data().addressFirstName,n=t.data().personalId;let i=t.data()?.preferences?.shippingMethod;n?""===n&&(o=!1):o=!1,"Pickup"==i&&(d=!0)}),!0==s&&void 0==r&&d&&(location.href="/address-form");// Redirect user to personalId form if they haven't added it yet
let c=user.current?.trustedSellerStatus==="Trusted";user.current?.trustedSellerStatus,a&&!o&&(c||l)&&(location.href="/personal-id-form")}async function y(){var t;if(console.log("privateMain running"),!user.current)return;c(r=authUser.current.uid,authUser.current.email||sessionStorage.getItem("email"),authUser.current.phoneNumber||sessionStorage.getItem("phoneNumber")),p(r),user.current?.trustedSellerStatus==="Trusted"?document.getElementById("trustedIconHeader").style.display="block":(document.getElementById("fullLogo").style.display="block",document.getElementById("onlyLogo").style.display="none"),(t=document.getElementById("itemListSoldByOthers")).innerHTML="",// SOLD BY OTHERS QUERY + Add cards to list
db.collection("items").where("status","==","Sold").orderBy("soldDate","desc").limit(30).get().then(n=>{n.forEach(n=>{var i=n.data().user,o=n.data().brand,l=n.data().soldPrice,s=(0,a.itemCoverImage)(n.data());// Add card to list if seller is other than myself
if(i!=r&&l>=200){var d=`<div class="div-block-14"><div class="ratio-box _16-9"><div class="conten-block with-image"><div class="img-container" style="background-image: url('${s}');"></div></div></div><div class="text-block-14">${l} kr</div><div class='text-block-34'>${o}</div></div>`;t.innerHTML+=d}})}),soldByOthersDiv.style.display="block",setPreferredLogInMethodCookie(authUser.current.providerData[0].providerId);//Yearly Summary
/*
  yearlyDataExist(userId).then((result) => {
    if (result) {
      console.log('Yearly data exist!');
      document.getElementById('yearlySummaryDiv').style.display = 'block';
      document.getElementById('yearlySummaryDiv').addEventListener("click", function () {
        location.href = `/yearly-summary?id=${userId.substring(0, 10)}&year=2024`;
      });
    } else {
      console.log('No yearly summary exist!');
    }
  });
  */let n=(await callBackendApi("/api/items",{requiresAuth:!0}))?.data;!function(t){let n=new Date,i=10,r=0,o=!1,a=user.current?.elementViews?user.current.elementViews.filter(t=>"inviteToast"===t.elementID):[],l=a.length?Array.from(a,t=>parseInt(Math.floor((n.getTime()-1e3*t.timestamp.seconds)/864e5))):[],s=l.length?Math.min(...l):null,d=!!a.length;t&&t.forEach(t=>{let a=t.soldDate,l=t.status,s=t.shippingStatus,d=t.archived;if(!d&&"Sold"===l&&a){if(r++,a){a=new Date(a);let t=Math.floor((n.getTime()-a.getTime())/864e5);t<=i&&(i=t)}"Sent"===s&&(o=!0)}}),user.current?.referralData?.referralCode&&o&&(!d||s>45)&&(i<=14||r>=3&&i<=45)&&(referralCodeText.innerHTML=user.current.referralData.referralCode,triggerInviteToastOpen.click(),// Store elementViews to be able to not show it again
db.collection("users").doc(authUser.current.uid).update({elementViews:firebase.firestore.FieldValue.arrayUnion({elementID:"inviteToast",timestamp:new Date})}),// Track with segment
analytics.track("Element Viewed",{elementID:"inviteToast"}))}(n);let i=checkCookie("invite");i&&await connectReferralUsers(i);// Set invite code cookie
let o=checkCookie("photo_invite");o&&!localStorage.getItem("photoShootBooked")&&(photoShootOffer.style.display="block",bonusSection.style.display="block"),document.getElementById("stickyBottomClose").addEventListener("click",()=>{itemMoreMenu.classList.remove("sticky-bottom-show"),setTimeout(()=>itemMoreMenu.style.display="none",500)}),document.getElementById("stickyBottomDelete").addEventListener("click",async()=>{if(itemMoreMenu.classList.remove("sticky-bottom-show"),setTimeout(()=>itemMoreMenu.style.display="none",500),"inactive"===itemMoreMenu.dataset.section){document.getElementById(itemMoreMenu.dataset.itemId).style.display="none";let t=document.getElementById("inactiveItemList"),n=Array.from(t.children).find(t=>"none"!==t.style.display);n||(document.getElementById("inactiveItemsDiv").style.display="none"),await callBackendApi(`/api/items/unsold/${itemMoreMenu.dataset.itemId}`,{method:"DELETE",data:{itemId:itemMoreMenu.dataset.itemId}})}if("sold-not-sent"===itemMoreMenu.dataset.section){await callBackendApi(`/api/items/unsold/${itemMoreMenu.dataset.itemId}`,{method:"DELETE",data:{itemId:itemMoreMenu.dataset.itemId}});// hide the element from the list
let t=document.getElementById(`removeItemButton-${itemMoreMenu.dataset.itemId}`),n=t.parentElement;for(;n&&!n.classList.contains("div-block-45");)n=n.parentElement;n&&(n.style.display="none");// Also hide the full 'Sold - to be sent' list if this was the only item in it
let i=document.querySelectorAll("#itemListSoldNotSent .div-block-45"),r=Array.from(i).filter(t=>"none"!==t.style.display);0===r.length&&(document.getElementById("soldNotSentDiv").style.display="none")}else{document.getElementById(itemMoreMenu.dataset.itemId).style.display="none";let t=document.getElementById("wardrobeItemList"),n=Array.from(t.children).find(t=>"none"!==t.style.display);n||(document.getElementById("wardrobeItemsDiv").style.display="none"),await callBackendApi(`/api/items/wardrobe/${itemMoreMenu.dataset.itemId}`,{method:"DELETE",data:{itemId:itemMoreMenu.dataset.itemId}})}}),await Promise.all([v(),g(),x()]),(0,s.loadItemCards)(n,user.current),function(t){if(!user.current?.trustedSellerStatus||user.current?.trustedSellerStatus==="Pending"){let n=document.getElementById("trustedSellerWidget"),i=t?.data?.length>0;// If no items, move widget after soldByOthersDiv
if(!i){console.log("No items, moving widget after soldByOthersDiv");let t=document.getElementById("soldByOthersDiv");t.parentNode.insertBefore(n,t.nextSibling)}user.current?.approvedSalesCount&&(document.getElementById("widgetNumApprovedSales").innerText=Math.max(0,3-Number(user.current?.approvedSalesCount))),user.current?.approvedSalesCount===2&&(document.getElementById("approvedSalesText").innerText="godk\xe4nd f\xf6rs\xe4ljning kvar"),user.current?.approvedSalesCount>=1&&(document.getElementById("widgetFirstSaleBar").style.backgroundColor="#02AC08"),user.current?.approvedSalesCount>=2&&(document.getElementById("widgetSecondSaleBar").style.backgroundColor="#02AC08"),user.current?.approvedSalesCount>=3&&(document.getElementById("widgetThirdSaleBar").style.backgroundColor="#02AC08"),n.style.display="block"}}(n),console.log("user.current",user.current),window.location.href.endsWith("#wardrobe")&&setTimeout(()=>{document.getElementById("wardrobeItemsDiv").scrollIntoView({behavior:"smooth",block:"center"})},600),b(n),I(n),showReferralSection(),showBonusSection(),function(t){let n=getCookie("noCommissionCampaignCookie"),i=new Intl.DateTimeFormat("se-SV").format(new Date),r=t.filter(t=>t?.status!=="Draft").length;"noCommission"===n&&i>="2024-08-12"&&i<="2024-08-18"&&r<1&&("none"===bonusActivatedState.style.display||""===bonusActivatedState.style.display)&&document.getElementById("bonusSection")&&(document.getElementById("bonusName").innerHTML="KAMPANJ - T.o.m s\xf6n 18/8",document.getElementById("bonusTitle").innerHTML="S\xe4lj f\xf6rsta gratis",document.getElementById("bonusText").innerHTML="L\xe4gg upp ett plagg senast s\xf6ndag 18 augusti s\xe5 f\xe5r du beh\xe5lla 100% av vinsten f\xf6r ditt f\xf6rsta s\xe5lda plagg (ist\xe4llet f\xf6r 80%).",document.getElementById("bonusActivatedState").style.display="block",document.getElementById("enterCodeState").style.display="none",bonusSection.style.display="block")}(n),u(user.current),(0,l.loadInfoRequests)(n),k(n),user.current?.trustedSellerStatus!=="Pending"&&user.current?.trustedSellerStatusChange&&!user.current.trustedSellerStatusChange.seen&&function(){document.getElementById("darkOverlay").classList.add("active");let t=user.current?.trustedSellerStatusChange.type;"pendingToTrusted"===t?(document.getElementById("trustedSellerTitle").innerText="Du har uppn\xe5t statusen\nP\xe5litlig S\xe4ljare!",document.getElementById("trustedSellerText").innerText="Tack vare en h\xf6g andel godk\xe4nda f\xf6rs\xe4ljningar har du nu blivit P\xe5litlig S\xe4ljare! Fr\xe5n och med nu f\xe5r du utbetalt direkt n\xe4r du skickar dina plagg och t\xe4cks av Mais s\xe4ljarskydd vid eventuella reklamationer."):"untrustedToTrusted"===t?(document.getElementById("trustedSellerTitle").innerText="Du har uppn\xe5t statusen\nP\xe5litlig S\xe4ljare!",document.getElementById("trustedSellerText").innerText=`Tack${user.current?.addressFirstName?" "+user.current.addressFirstName:""}, f\xf6r att du g\xf6r det enkelt f\xf6r k\xf6pare att handla tryggt i andra hand! Fr\xe5n och med nu f\xe5r du utbetalt direkt n\xe4r du skickar dina plagg och t\xe4cks av Mais s\xe4ljarskydd vid eventuella reklamationer.`):"pendingToUntrusted"===t?(document.getElementById("trustedSellerButton").innerText="Okej",document.getElementById("trustedSellerIcon").style.opacity="0.2",document.getElementById("trustedSellerLink").innerText="Hur blir jag P\xe5litlig S\xe4ljare?",document.getElementById("trustedSellerTitle").innerText="Just nu uppfyller du inte kriterierna f\xf6r P\xe5litlig S\xe4ljare",document.getElementById("trustedSellerText").innerHTML=`Eftersom en av dina f\xf6rsta f\xf6rs\xe4ljningar antingen reklamerades eller inte skickades i tid, s\xe5 uppfyller du just nu inte kriterierna f\xf6r statusen P\xe5litlig S\xe4ljare. Du kan fortfarande s\xe4lja, men har \xe4nnu inte kvalificerat dig f\xf6r snabbare utbetalningar eller Mais s\xe4ljarskydd.`):"trustedToUntrusted"===t&&(document.getElementById("trustedSellerButton").innerText="Okej",document.getElementById("trustedSellerIcon").style.opacity="0.2",document.getElementById("trustedSellerLink").innerText="Hur blir jag P\xe5litlig S\xe4ljare igen?",document.getElementById("trustedSellerTitle").innerText="Du har inte l\xe4ngre statusen P\xe5litlig S\xe4ljare",document.getElementById("trustedSellerText").innerText=`P\xe5 grund av upprepade reklamationer eller f\xf6rs\xe4ljningar som inte skickats i tid, s\xe5 uppfyller du f\xf6r n\xe4rvarande inte kriterierna f\xf6r s\xe4ljarstatusen P\xe5litlig S\xe4ljare. Du kan fortfarande s\xe4lja, men utbetalning sker f\xf6rst n\xe4r k\xf6paren mottagit varan och eventuella reklamationer skickas tillbaka till dig.`),document.getElementById("trustedSellerBottomSheet").classList.add("active")}(),user.current&&user.current.addressFirstName&&user.current.addressLastName&&!user.current?.referralData?.referralCode&&await createReferralCode()}function f(t){if(!t||["Tr\xf6ja","Blus","Topp","Skjorta","Linneskjorta","T-shirt","Kavaj","Sweatshirt","Hoodie","Polotr\xf6ja","Tunika","V\xe4st","Kofta","Linne","Tr\xe4ningstr\xf6ja","Poncho","Pik\xe9","L\xe5ng\xe4rmad T-shirt","Kostymv\xe4st","Kjol","Byxor","Jeans","Chinos","Fritidsbyxor","Tr\xe4ningsbyxor","Tights","Strumpbyxor","Mjukisbyxor","Kostymbyxor","Sarong","Kl\xe4nning","Kaftan","Kostym","Set","Jumpsuit","Baddr\xe4kt","Bikini","Pyjamas","Morgonrock","Br\xf6llopskl\xe4nning","Balkl\xe4nning","Bodysuit","Jacka","Kappa","Rock","Fritidsjacka","Trenchcoat","Skinnjacka","Regnjacka","Sneakers","Klackar","Ballerinaskor","Loafers","Boots","K\xe4ngor","Skor","Axelremsv\xe4ska","Handv\xe4ska","Kuvertv\xe4ska","Ryggs\xe4ck","Tr\xe4ningsv\xe4ska","Resv\xe4ska","Datorv\xe4ska","V\xe4ska","Solglas\xf6gon","Glas\xf6gon","\xd6rh\xe4nge","Halsband","Armband","Ring","Brosch","Keps","Sjal","Krage","B\xe4lte","Pl\xe5nbok","Hatt","Necess\xe4r","Slips","Handduk","Klocka"].includes(t))return!0;let n=new Date,i=new Date(n.getFullYear(),7,15),r=new Date(n.getFullYear(),3,15);return!!["Underst\xe4ll","Dunjacka","P\xe4lsjacka","Vinterskor","Halsduk","M\xf6ssa","Vantar"].includes(t)&&(n<=r||n>=i)||["Shorts","Sandaler","Flip-flops"].includes(t)&&n>=r&&n<=i}async function x(){let t=await callBackendApi("/api/items/unsold",{requiresAuth:!0});if(!t.data?.length)return;t.data.sort((t,n)=>{let i=f(t.category),r=f(n.category);return i&&!r?-1:r&&!i?1:t.minPriceEstimate>=100&&n.minPriceEstimate<=100?-1:t.minPriceEstimate<=100&&n.minPriceEstimate>=100?1:0});let n=document.querySelector("#inactiveItemsDiv");n.style.display="block";let i=n.querySelector("#inactiveItemCard"),r=n.querySelector("#inactiveItemList");r.innerHTML="";let o=document.querySelector("#itemMoreMenu");for(let n of t.data){let t=i.cloneNode(!0);t.id=n.id;let a=n.images?.modelImageLarge||n.images?.modelImage||n.images?.enhancedFrontImageLarge||n.images?.enhancedFrontImage||n.images?.frontImageLarge||n.images?.frontImage;t.querySelector(".img-container").style.backgroundImage=`url("${a}")`,t.querySelector(".inactive-card-brand").innerText=`${n.cleanedBrand||n.brand?.trim()}`,t.querySelector(".inactive-card-category").innerText=`${n.category||""}`,t.querySelector(".inactive-card-reason").innerText="Avslutad",f(n.category)&&(t.querySelector(".in-season-label").style.display="block",n.minPriceEstimate>100&&(t.querySelector(".restart-button").href=`/sell-item?id=${n.id}&type=${"Draft"===n.status?"draft":"resell"}`,t.querySelector(".restart-button").style.display="inline-block")),t.querySelector(".inactive-dots-button").style.display="block",t.querySelector(".inactive-dots-button").addEventListener("click",async t=>{o.style.display="block",setTimeout(()=>o.classList.add("sticky-bottom-show"),0),o.dataset.itemId=n.id,o.dataset.section="inactive",t.preventDefault(),t.stopPropagation()}),r.appendChild(t)}//Tracking
r.querySelectorAll("a").forEach(t=>t.addEventListener("click",linkClickTracker))}async function v(){let t=await callBackendApi("/api/items/wardrobe",{requiresAuth:!0});if(!t.data?.length)return;document.getElementById("wardrobeItemsDiv").style.display="block";let n=document.getElementById("wardrobeItemCard"),i=document.getElementById("wardrobeItemList");i.innerHTML="";let r=document.getElementById("itemMoreMenu");for(let o of t.data){let t=n.cloneNode(!0);t.id=o.id;let a=o.images?.modelImageLarge||o.images?.modelImage||o.images?.enhancedFrontImageLarge||o.images?.enhancedFrontImage||o.images?.frontImageLarge||o.images?.frontImage;a?(t.querySelector(".img-container").style.backgroundImage=`url("${a}")`,t.querySelector(".no-image-text").style.display="none"):t.querySelector(".img-container").style.display="none",t.addEventListener("click",()=>{location.href=`/sell-item?id=${o.id}&type=${"Draft"===o.status?"draft":"resell"}`}),t.querySelector(".resell-button").href=`/sell-item?id=${o.id}&type=${"Draft"===o.status?"draft":"resell"}`,t.querySelector(".resell-item-title").innerText=`${o.cleanedBrand||o.brand?.trim()}`,t.querySelector(".resell-subtext").innerText=`${[o.category,o.maiSize].filter(t=>t).join(", ")}`;let l=o.soldPlatform||"Mai purchase"===o.draftSource?`K\xf6pt via Mai`:"Digital receipt"===o.draftSource?"Fr\xe5n digitalt kvitto":"lwl"===o.draftSource?"Fr\xe5n LWL":"";t.querySelector(".resell-sub-subtext").innerText=l;let s=o.soldPlatform||"Mai purchase"===o.draftSource?"resellPurchaseButton":"Digital receipt"===o.draftSource?"resellDigitalReceiptButton":"lwl"===o.draftSource?"resellLwlButton":"";t.querySelector(".resell-button").id=s,t.querySelector("#wardrobeDotsButton").addEventListener("click",async t=>{r.style.display="block",setTimeout(()=>r.classList.add("sticky-bottom-show"),0),r.dataset.itemId=o.id,r.dataset.section="wardrobe",t.preventDefault(),t.stopPropagation()}),i.appendChild(t)}//Tracking
i.querySelectorAll("a").forEach(t=>t.addEventListener("click",linkClickTracker));let o=new IntersectionObserver((t,n)=>{let r=i.getBoundingClientRect(),a=r.top>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight);a&&(console.log("Wardrobe viewed"),analytics.track("Element Viewed",{elementID:"wardrobeItemsDiv"}),o.disconnect())},{threshold:1,root:null});o.observe(i)}async function k(t){let n=0===t.length,i=!t.some(t=>"Sold"===t.status),r=await db.collection("users").doc(authUser.current.uid).get(),o=r.data()?.oneTimeCommissionFreeCoupon==="Active";o&&(!n&&i&&(document.getElementById("freeSellBoxTitle").innerHTML="N\xe4sta f\xf6rs\xe4ljning \xe4r fri",document.getElementById("freeSellBoxText").innerHTML="Du har f\xe5tt en fri f\xf6rs\xe4ljning av Mai"),document.getElementById("freeSellBox").style.display="block")}async function h(){document.getElementById("appPromoSection").style.display="none",authUser.current&&db.collection("users").doc(authUser.current.uid).update({elementViews:firebase.firestore.FieldValue.arrayUnion({elementID:"appPromoSection",timestamp:new Date})})}async function b(t){if(!user)return;let n=new Date,i=0,r=0,o=user.current?.elementViews?user.current.elementViews.reverse().find(t=>"npsSurvey"===t.elementID):null,a=o?new Date("string"!=typeof o?1e3*o.seconds:o):null,l=a?Math.floor((n.getTime()-a.getTime())/864e5):null;t&&t.forEach(t=>{if(t.publishedDate&&!t.archived){let o=new Date(t.publishedDate),a=Math.floor((n.getTime()-o.getTime())/864e5);a>i&&(i=a),(a<r||0===r&&a>0)&&(r=a)}}),i>=25&&r<=60&&(!a||l>90)&&!document.referrer.includes("feedback-nps")&&(location.href="/feedback-nps")}async function I(t){if(t&&t.length)try{let n=[];t.forEach(t=>n.push(t.id));let i=n.slice(0,10).map(t=>`items=${t}`).join("&")+"&number=20",r=await callBackendApi(`/api/items/recommendations?${i}`,{requiresAuth:!0});if(!r.data.length)return;document.getElementById("recommendedItemsDiv").style.display="block";let o=document.getElementById("recommendedItemsList");o.innerHTML="";let a=[],l=0;for(let t of r.data){a.includes(t.maiSize)||a.push(t.maiSize);let n=t.images.modelImageLarge||t.images.modelImage||t.images.enhancedFrontImageLarge||t.images.enhancedFrontImage,i=`<div class="div-block-14-big"><a id="recommendedItemCard${l++}" href="${t.platformListings.maiShop.url}"/><div class="ratio-box _16-9"><div class="conten-block with-image">
                        <div class="img-container" style="background-image: url('${n}')"></div></div></div>
                        <div class="recently-added-text-block">
                            <div class="recent-added-items-subheader">${t.cleanedBrand}</div>
                            <div class="recent-added-items-subheader-category">${t.category}, ${t.maiSize}</div>
                            <div class="recently-added-price">${t.platformListings.maiShop.currentPrice} kr</div>
                            <div class="recently-added-brands-link-text">Mai Shop</div>
                        </div><a/></div>`;o.innerHTML+=i}o.querySelectorAll("a").forEach(t=>t.addEventListener("click",linkClickTracker)),document.getElementById("goToMaiShopLinkRecommendations").setAttribute("href",`https://shop.maiapp.se/collections/damklader/${r.data[0].sex||"Woman"}?sort_by=created-descending&filter.p.m.global.size=${a.join("&filter.p.m.global.size=")}`);let s=new IntersectionObserver((t,n)=>{let i=o.getBoundingClientRect(),r=i.top>=0&&i.bottom<=(window.innerHeight||document.documentElement.clientHeight);r&&(console.log("Recommendations viewed"),analytics.track("Element Viewed",{elementID:"recommendedItems"}),s.disconnect())},{threshold:1,root:null});s.observe(o)}catch(t){errorHandler.report(t),console.log("error",t)}}function S(){document.getElementById("triggerPickupToastClose").click()}function B(){document.getElementById("triggerFeedbackFormClose").click(),setTimeout(function(){location.reload()},400)}async function w(){let t="";for(var n=document.getElementsByName("Pickup"),i=0;i<n.length;i++)n[i].checked&&(t=n[i].value);// yyyy--mm-dd
db.collection("items").doc(pickupFlowItemId).update({pickupDate:t,shippingMethod:"Pickup"}).then(n=>{console.log(`pickupDate '${t}' and shippingMethod 'Pickup' is now updated on Firestore item`),S(),document.getElementById("triggerFeedbackFormOpen").click()})}async function T(t){let n=db.collection("items").doc(pickupFlowItemId);await n.update({happinessRate:t}).then(function(){console.log("happinessRate is now set on Firestore item"),happinessQuestionDiv.style.display="none",openQuestionDiv.style.display="block",feedbackSubmitButton.style.display="block"})}async function E(){let t=feedbackTextField.value,n=db.collection("items").doc(pickupFlowItemId);await n.update({feedbackText:t}).then(function(){console.log("feedbackText is now set on Firestore item"),B()})}async function L(){document.getElementById("approvedSaleInfoBox").style.display="none",document.getElementById("darkOverlay").classList.remove("active")}async function D(){document.getElementById("darkOverlay").classList.remove("active"),document.getElementById("trustedSellerBottomSheet").classList.remove("active");try{await callBackendApi("/api/users",{data:{data:{trustedSellerStatusChange:{type:user.current?.trustedSellerStatusChange?.type,timestamp:new Date,seen:!0}}},method:"PUT"})}catch(t){errorHandler.report(t),console.log("Error updating user",t)}}m&&(m?.referralData?.referralCode,u(m)),checkCookie("invite"),localStorage.removeItem("latestItemCreated"),sessionStorage.removeItem("itemToBeCreatedAfterSignIn"),console.log(`user ${user.current}`),user.whenSet(y),//Disable webflow form submissions
Webflow.push(function(){$("form").submit(function(){return!1})});let C=!1;function M(){console.log("onLoadHandler running"),menuSignoutButton.addEventListener("click",a.signOut),bookPickupForm.addEventListener("submit",w),closePickupToastIcon.addEventListener("click",S),closeFeedbackFormButton.addEventListener("click",B),happySmileyButton.addEventListener("click",function(){T(3)},!1),neutralSmileyButton.addEventListener("click",function(){T(2)},!1),angrySmileyButton.addEventListener("click",function(){T(1)},!1),feedbackSubmitButton.addEventListener("click",E),saveReferralCodeButton.addEventListener("click",async function(){saveRefCodeLoadingDiv.style.display="flex",saveReferralCodeButton.style.display="none";let t=referralCodeInput.value;await connectReferralUsers(t)}),closeMeasurementsToastButton.addEventListener("click",function(){triggerMeasurementsToastClose.click()}),closeNewPriceToastButton.addEventListener("click",function(){triggerNewPriceToastClose.click()}),closeInviteToastButton.addEventListener("click",function(){triggerInviteToastClose.click()}),closeServicePointToastButton.addEventListener("click",function(){triggerServicePointToastClose.click()}),confirmServicePointButton.addEventListener("click",function(){document.getElementById("feedbackFormTitle").innerHTML="",triggerServicePointToastClose.click(),triggerFeedbackFormOpen.click()}),closeLongerPeriodToastButton.addEventListener("click",function(){triggerLongerPeriodToastClose.click()}),shareCodeButton.addEventListener("click",a.shareCode),sharePersonalLinkButton.addEventListener("click",a.shareCode),C=!0,menuButton.addEventListener("click",function(){Intercom("update",{hide_default_launcher:!0})}),closeMenuButton.addEventListener("click",function(){Intercom("update",{hide_default_launcher:!1})}),document.getElementById("closeAppPromo").addEventListener("click",function(t){console.log("Close button clicked!"),h()}),document.getElementById("darkOverlay").addEventListener("click",function(){D(),L()}),document.getElementById("closeTrustedSellerBottomSheet").addEventListener("click",D),document.getElementById("trustedSellerButton").addEventListener("click",D),document.getElementById("approvedSalesLines").addEventListener("click",function(){document.getElementById("approvedSaleInfoBox").style.display="block",document.getElementById("darkOverlay").classList.add("active")}),document.getElementById("closeApprovedSaleInfoBox").addEventListener("click",L)}localStorage.getItem("lwlItemDrafts")&&(location.href="/lwl?createDrafts=true"),window.addEventListener("load",M),console.log(`document.readyState ${document.readyState}`),"complete"!==document.readyState||C||(console.log("Running it since event listener did not"),M()),window.addEventListener("pageshow",t=>{t.persisted?(console.log("This page was restored from the bfcache."),"none"!==menu.style.display&&(menu.style.display="none")):console.log("This page was loaded normally.")}),window.intercomSettings={app_id:"klyy0le5"},function(){var t=window,n=t.Intercom;if("function"==typeof n)n("reattach_activator"),n("update",t.intercomSettings);else{var i=document,r=function(){r.c(arguments)};r.q=[],r.c=function(t){r.q.push(t)},t.Intercom=r;var o=function(){var t=i.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://widget.intercom.io/widget/klyy0le5";var n=i.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)};t.attachEvent?t.attachEvent("onload",o):t.addEventListener("load",o,!1)}}()},{"./general":"1tOWF","./infoRequestsFunctions":"21npA","./loadItemCards":"dxOtH","@parcel/transformer-js/src/esmodule-helpers.js":"bNgzC"}],"21npA":[function(t,n,i){let r,o;var a=t("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(i),a.export(i,"loadInfoRequests",()=>m);var l=t("./general");async function s(t,n){measurementDescriptionText.innerHTML=n,measurementsSubmitButton.addEventListener("click",async function(){let n=measurementsInput.value;n.length>0&&" "!==n&&await db.collection("items").doc(t).update({measurements:n,"infoRequests.measurements.status":"Resolved"}),triggerMeasurementsToastClose.click(),setTimeout(function(){location.reload()},400)}),triggerMeasurementsToastOpen.click()}async function d(t,n,i,r){if(!t)return;console.log("is this happening?");let o=10*Math.ceil(.7*i/10),a=10*Math.ceil(.8*i/10);priceAfterDiscount30.innerHTML=`(Priset blir ${o} kr)`,priceAfterDiscount20.innerHTML=`(Priset blir ${a} kr)`,priceNoDiscount.innerHTML=`(${i} kr)`,i>=140&&!r?(longerPeriodDescriptionText.innerHTML=`S\xe4ljperioden f\xf6r ditt ${n}-plagg har n\xe5tt sitt slut. V\xe4lj om du vill f\xf6rl\xe4nga s\xe4ljperioden med ytterligare 30 dagar och om du vill s\xe4nka priset f\xf6r att \xf6ka chansen att f\xe5 det s\xe5lt.`,discountFormDiv.style.display="block"):(longerPeriodDescriptionText.innerHTML=`S\xe4ljperioden f\xf6r ditt ${n}-plagg har n\xe5tt sitt slut. Vill du f\xf6rl\xe4nga s\xe4ljperioden med ytterligare 30 dagar eller avsluta f\xf6rs\xe4ljningen?`,discountFormDiv.style.display="none"),// Accept longer selling window and store chosen discount
longerPeriodAcceptButton.addEventListener("click",async function(){let n=new Date,r=n.toISOString().split("T")[0],l=i,s=0;for(var d=document.getElementsByName("Discount"),c=0;c<d.length;c++)if(d[c].checked){let t=d[c].value;"30"===t&&(l=o,s=30),"20"===t&&(l=a,s=20)}await db.collection("items").doc(t).update({longerPeriodAcceptedDate:r,"infoRequests.longerPeriod.status":"Resolved","infoRequests.longerPeriod.response":"Accepted",longerPeriodAcceptedDiscount:s,minPriceEstimate:l}),triggerLongerPeriodToastClose.click(),setTimeout(function(){location.reload()},300)}),// Decline longer selling period and quit sales
longerPeriodDenyButton.addEventListener("click",async function(){await db.collection("items").doc(t).update({"infoRequests.longerPeriod.status":"Resolved","infoRequests.longerPeriod.response":"Denied",status:"Unsold"// This field is normally mastered by AT - I do this for the user to see the effect immediately (the card is removed)
}),triggerLongerPeriodToastClose.click(),setTimeout(function(){location.reload()},300)}),triggerLongerPeriodToastOpen.click()}async function c(t,n,i,r,o){// Deny price
if(console.log("storePriceResponse",t,n,i,r),"Accepted"===r&&await db.collection("items").doc(t).update({"infoRequests.price.status":"Resolved","infoRequests.price.response":"Accepted",maxPriceEstimate:n,minPriceEstimate:i}).then(function(){triggerNewPriceToastClose.click(),setTimeout(function(){location.reload()},300)}),"Denied"===r){let n={"infoRequests.price.status":"Resolved","infoRequests.price.response":"Denied"};"New"===o&&(n.archived=!0,n.willNotSell=!0),await db.collection("items").doc(t).update(n).then(function(){triggerNewPriceToastClose.click(),setTimeout(function(){location.reload()},300)})}}async function u(t,n,i,a,l,s,d,u,m,g){console.log("openNewPriceToast",t,n,i,a,l,s,d,u,m,g),previousMinPrice.style.display="none",previousMaxPrice.style.display="none",maxPriceDiv.style.display="block",minPriceDiv.style.display="block",// Set content of toast
newPriceToastTitle.innerHTML="Nytt l\xe4gsta pris",newPriceHeading.innerHTML=`${l}-plagg`;let p=d.toLowerCase();p&&"null"!==p&&(newPriceHeading.innerHTML=`${l}-${p}`),maxPrice.innerHTML=i,minPrice.innerHTML=a,m&&"null"!==m&&""!==m&&"undefined"!==m&&i!==m&&(previousMaxPrice.innerHTML=m,previousMaxPrice.style.display="block"),g&&"null"!==g&&""!==g&&"undefined"!==g&&a!==g&&(previousMinPrice.innerHTML=g,previousMinPrice.style.display="block"),acceptNewPriceButton.innerHTML="S\xe4lj med nytt pris",denyNewPriceButton.innerHTML="S\xe4nk ej","New"===n&&"Valuation"===u&&(newPriceToastTitle.innerHTML="V\xe4rdering",acceptNewPriceButton.innerHTML="S\xe4lj till v\xe4rdering",denyNewPriceButton.innerHTML="Avb\xf6j och avsluta"),"Adjusted ML Valuation"===u&&(newPriceToastTitle.innerHTML="Nytt prisintervall"),"Valuation"!==u&&"Adjusted ML Valuation"!==u&&(minPrice.innerHTML=`${a} kr`,maxPriceDiv.style.display="none"),s&&"undefined"!==s&&""!==s&&"null"!==s&&(newPriceText.innerHTML=s,descriptionDiv.style.display="block"),acceptNewPriceButton.removeEventListener("click",r);let y=()=>{c(t,i,a,"Accepted",n)};acceptNewPriceButton.addEventListener("click",y),r=y,denyNewPriceButton.removeEventListener("click",o);let f=()=>{c(t,i,a,"Denied",n)};denyNewPriceButton.addEventListener("click",f),o=f,// Open toast
triggerNewPriceToastOpen.click()}function m(t){let n=document.getElementById("infoRequestMeasurementsTemplate").cloneNode(!0),i=document.getElementById("infoRequestLongerPeriodTemplate").cloneNode(!0),r=document.getElementById("infoRequestImagesTemplate").cloneNode(!0),o=document.getElementById("infoRequestValuationTemplate").cloneNode(!0),a=document.getElementById("infoRequestsList");a.replaceChildren(),(t||[]).forEach(t=>{let c=t.id,m=t.infoRequests,g=t.status,p=t.brand.replace(/'/g,""),y=t.minPriceEstimate,f=t.maxPriceEstimate,x=t?.infoRequests?.price?.response==="Denied",v=t.archived,k=t.category,h=(0,l.itemCoverImage)(t);void 0==v&&"Unsold"!==g&&"Sold"!==g&&m&&function(){for(let t in m)if(m[t]?.status==="Active"){let l=m[t].description;// PRICE REQUEST
if(l&&(l=l.replace(/'/g,"")),"price"===t){let n=m[t].type,i=o.cloneNode(!0);i.id=`infoRequestPrice-${c}`,i.querySelector(".img-container").style.backgroundImage=`url('${h}')`,i.querySelector("a .pricebuttontext").innerText="Se prisf\xf6rslag",i.querySelector(".text-block-72").innerText="Vill du s\xe4nka priset och f\xe5 det s\xe5lt?",a.appendChild(i),"New"===g&&"Adjusted ML Valuation"!==n?(i.querySelector("a .pricebuttontext").innerText="Se v\xe4rdering",i.querySelector(".text-block-72").innerText="Vill du s\xe4lja till v\xe5r v\xe4rdering?",i.querySelector("a").href=`/item-valuation?id=${c}`):setTimeout(()=>{let i=m[t].maxPrice,r=m[t].minPrice;document.querySelector(`#infoRequestPrice-${c} a`).addEventListener("click",async()=>{await u(c,g,i,r,p,l,k,n,f,y)})},0)}// MEASUREMENTS REQUEST
if("measurements"===t){let t=n.cloneNode(!0);t.id=`infoRequestMeasurements-${c}`,t.querySelector(".img-container").style.backgroundImage=`url('${h}')`,a.appendChild(t),setTimeout(()=>{document.querySelector(`#infoRequestMeasurements-${c} a`).addEventListener("click",async()=>{await s(c,l)})},0)}// IMAGES REQUEST
if("images"===t){let t=r.cloneNode(!0);t.id=`infoRequestImages-${c}`,t.querySelector(".img-container").style.backgroundImage=`url('${h}')`,t.querySelector("a").href=`/edit-item?id=${c}`,a.appendChild(t)}// LONGER PERIOD REQUEST
if("longerPeriod"===t){let t=i.cloneNode(!0);t.id=`infoRequestLongerPeriod-${c}`,t.querySelector(".img-container").style.backgroundImage=`url('${h}')`,a.appendChild(t),setTimeout(()=>{document.querySelector(`#infoRequestLongerPeriod-${c} a`).addEventListener("click",async()=>{await d(c,p,y,x)})},0)}infoRequestsDiv.style.display="block"}}()});/*
    db.collection("items").where("user", "==", userId).get().then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
            const itemId = doc.id;
            const item = doc.data();
            const infoRequests = item.infoRequests;
            const status = item.status;
            const brand = item.brand.replace(/'/g, '');
            const currentMinPrice = item.minPriceEstimate;
            const currentMaxPrice = item.maxPriceEstimate;
            const deniedBefore = item?.infoRequests?.price?.response === "Denied" ? true : false;
            const archived = item.archived;
            const category = item.category;
            const frontImageUrl = itemCoverImage(item);
            if (archived == undefined && status !== "Unsold" && status !== "Sold" && infoRequests) {
                displayRequests();
            }

            function displayRequests() {
                for (const req in infoRequests) {
                    if (infoRequests[req]?.status === "Active") {
                        let description = infoRequests[req].description;
                        
                        if (description) { description = description.replace(/'/g, ''); }
                        // PRICE REQUEST
                        if (req === "price") {
                            const type = infoRequests[req].type;
                            const newRequest = valuationClone.cloneNode(true);
                            newRequest.id = `infoRequestPrice-${itemId}`;
                            newRequest.querySelector('.img-container').style.backgroundImage = `url('${frontImageUrl}')`;
                            newRequest.querySelector('a .pricebuttontext').innerText = 'Se prisförslag';
                            newRequest.querySelector('.text-block-72').innerText = "Vill du sänka priset och få det sålt?";
                            infoRequestsList.appendChild(newRequest);
                            if (status === "New" && type !== 'Adjusted ML Valuation') {
                                newRequest.querySelector('a .pricebuttontext').innerText = 'Se värdering';
                                newRequest.querySelector('.text-block-72').innerText = 'Vill du sälja till vår värdering?'
                                newRequest.querySelector('a').href = `/item-valuation?id=${itemId}`;
                            } else {
                                setTimeout(() => {
                                    const max = infoRequests[req].maxPrice;
                                    const min = infoRequests[req].minPrice;
                                    document.querySelector(`#infoRequestPrice-${itemId} a`).addEventListener('click', async () => {
                                        await openNewPriceToast(itemId, status, max, min, brand, description, category, type, currentMaxPrice, currentMinPrice);
                                    })
                                }, 0);
                            }
                        }
                        // MEASUREMENTS REQUEST
                        if (req === "measurements") {
                            const newRequest = measurementsClone.cloneNode(true);
                            newRequest.id = `infoRequestMeasurements-${itemId}`;
                            newRequest.querySelector('.img-container').style.backgroundImage = `url('${frontImageUrl}')`;
                            infoRequestsList.appendChild(newRequest);
                            setTimeout(() => {
                              document.querySelector(`#infoRequestMeasurements-${itemId} a`).addEventListener('click', async () => {
                                await openMeasurementsToast(itemId, description);
                              })
                            }, 0);
                        }
                        // IMAGES REQUEST
                        if (req === "images") {
                            const newRequest = updateImagesClone.cloneNode(true);
                            newRequest.id = `infoRequestImages-${itemId}`;
                            newRequest.querySelector('.img-container').style.backgroundImage = `url('${frontImageUrl}')`;
                            newRequest.querySelector('a').href = `/edit-item?id=${itemId}`;
                            infoRequestsList.appendChild(newRequest);
                        }
                        // LONGER PERIOD REQUEST
                        if (req === "longerPeriod") {
                            const newRequest = longerPeriodClone.cloneNode(true);
                            newRequest.id = `infoRequestLongerPeriod-${itemId}`;
                            newRequest.querySelector('.img-container').style.backgroundImage = `url('${frontImageUrl}')`;
                            infoRequestsList.appendChild(newRequest);
                            setTimeout(() => {
                              document.querySelector(`#infoRequestLongerPeriod-${itemId} a`).addEventListener('click', async () => {
                                await openLongerPeriodToast(itemId, brand, currentMinPrice, deniedBefore);
                              })
                            }, 0);
                        }
                        infoRequestsDiv.style.display = "block";
                    }
                }
            }
        });
    });
*/}},{"./general":"1tOWF","@parcel/transformer-js/src/esmodule-helpers.js":"bNgzC"}],"2G59s":[function(t,n,i){var r=t("@parcel/transformer-js/src/esmodule-helpers.js");async function o(t,n,i=null){try{return await a(t,n,i)}catch(r){if("ImageResizeError"!==r.name)// Retry once for upload errors
return console.error("Failed to upload image",r),errorHandler.report(r),await a(t,n,i);throw console.error("Failed to resize image",r),errorHandler.report(r),r;// Don't retry for resize errors
}}async function a(t,n,i=null){let r;i||sessionStorage.getItem("newItemId")||sessionStorage.setItem("newItemId",await u());let o=i||sessionStorage.getItem("newItemId");try{r=await l(t),console.log(`Scaled image size: ${(r.size/1024/1024).toFixed(2)} MB`)}catch(n){let t=Error("Failed to resize image");throw t.name="ImageResizeError",t.originalError=n,t}if(!r)throw Error("Fel vid bearbetning av vald bild.");let a=new FormData;a.append("itemId",o),a.append("fileName",n),a.append("file",r),a.append("temporary",!i),a.append("generateSmallImage","true");let s=await fetch(`${BACKEND_API_URL}/api/items/${o}/uploadImage`,{method:"POST",body:a});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);return await s.json()}async function l(t){if(t.size<5242880)return Promise.resolve(t);if("createImageBitmap"in window)try{return console.log("Attempting to scale image with createImageBitmap"),await s(t,3024,4032)}catch(t){console.warn("createImageBitmap scaling method failed",t)}// If createImageBitmap is not supported or failed, try OffscreenCanvas
if("OffscreenCanvas"in window)try{return console.log("Attempting to scale image with OffscreenCanvas"),await d(t,3024,4032)}catch(t){console.warn("OffscreenCanvas scaling method failed",t)}// If both modern methods fail or are not supported, fall back to the original method
try{return console.log("Attempting to scale image with original method"),await c(t,3024,4032)}catch(t){throw console.error("All scaling methods failed",t),Error("Unable to process image")}}async function s(t,n,i){try{let r=await createImageBitmap(t),o=new OffscreenCanvas(n,i),a=o.getContext("2d"),{width:l,height:s}=r;return l>s?l>n&&(s*=n/l,l=n):s>i&&(l*=i/s,s=i),o.width=l,o.height=s,a.drawImage(r,0,0,l,s),await o.convertToBlob({type:"image/jpeg",quality:.9})}catch(t){throw console.error("Image scaling failed",t),Error("Unable to process image")}}async function d(t,n,i){let r=await createImageBitmap(t),o=r.width,a=r.height;o>a?o>n&&(a*=n/o,o=n):a>i&&(o*=i/a,a=i);let l=new OffscreenCanvas(o,a),s=l.getContext("2d");return s.drawImage(r,0,0,o,a),l.convertToBlob({type:"image/jpeg",quality:.9})}async function c(t,n,i){return new Promise((r,o)=>{let a=new Image;a.onload=()=>{let t=document.createElement("canvas"),o=a.width,l=a.height;o>l?o>n&&(l*=n/o,o=n):l>i&&(o*=i/l,l=i),t.width=o,t.height=l;let s=t.getContext("2d");s.drawImage(a,0,0,o,l),t.toBlob(t=>{console.log(`Fallback resize: ${(t.size/1024/1024).toFixed(2)} MB`),r(t)},"image/jpeg",.9)},a.onerror=o,a.src=URL.createObjectURL(t)})}async function u(){try{let t=await callBackendApi("/api/id",{method:"POST",requiresAuth:!1});return t.data.id}catch(t){return console.error(`Failed to fetch unique ID, generating uuidv4 id: ${t.message}`,t),uuidv4()}}async function m(t,n=!0){let i=await g(t);return i?.url&&(n&&y("enhancedFrontImage",i.url,i.urlSmall),f("frontImage",window.innerWidth<=370?i.urlSmall:i.url)),p("frontImage"),i}async function g(t){try{let n=await callBackendApi("/api/images/enhance",{data:{imageUrl:t},requiresAuth:!1,timeoutSec:30});return sessionStorage.setItem("enhancedFrontImage",n.data.url),n.data}catch(t){return errorHandler.report(t),console.error(t),""}}function p(t){document.getElementById(`loading${x(t)}Icon`).style.display="none",document.getElementById(`delete${x(t)}Icon`).style.display="inline-block","frontImage"===t&&(document.getElementById("enhancedAnimationDiv").style.display="none")}function y(t,n,i){let r=JSON.parse(localStorage.getItem("newItem")||JSON.stringify({})),o=r.images||{};o[t]=n,o[`${t}Small`]=i,r.images=o,localStorage.setItem("newItem",JSON.stringify(r))}function f(t,n){document.getElementById(`${t}Preview`).style.backgroundImage=`url('${n}')`,p(t)}function x(t){return t.charAt(0).toUpperCase()+t.slice(1)}async function v(t,n,i=!0){try{h(n);let r=URL.createObjectURL(t);document.getElementById(`${n}PreviewUploading`).style.backgroundImage=`url('${r}')`,document.getElementById(`${n}Preview`).style.backgroundImage=`url('${r}')`,I(n),b(n,"success-state");let{url:a,urlSmall:l}=await o(t,n);return i&&y(n,a,l),a}catch(i){console.error("Failed to upload image",i),errorHandler.report(i),document.getElementById(`${n}PreviewUploading`).style.backgroundImage="",document.getElementById(`${n}Preview`).style.backgroundImage="",document.getElementById(`loading${x(n)}Icon`).style.display="none",b(n,"default-state"),t.size>10485760?k(n,"Error: Bilden \xe4r f\xf6r stor. Max 10 MB."):k(n,"Error: N\xe5got gick fel vid uppladdning, f\xf6rs\xf6k igen eller kontakt oss om felet kvarst\xe5r."),document.getElementById(n).value=""}}function k(t,n){let i=document.getElementById(t).parentNode.parentNode;i.querySelector(".w-file-upload-error").style.display="block",i.querySelector(".w-file-upload-error-msg").innerText=n}function h(t){let n=document.getElementById(t).parentNode.parentNode;n.querySelector(".w-file-upload-error").style.display="none"}function b(t,n){let i=document.getElementById(t).parentNode.parentNode.childNodes;for(let t=0;t<i.length;t++)i[t].className.includes(n)?i[t].style.display="block":i[t].style.display="none"}function I(t){if("frontImage"===t){document.getElementById(`delete${x(t)}Icon`).style.display="none",document.getElementById(`loading${x(t)}Icon`).style.display="none",localStorage.getItem("sessionUser")||(document.getElementById("photoroomDiv").style.display="flex"),document.getElementById("enhancedAnimationDiv").style.display="block",triggerEnhancingAnimation.click();return}document.getElementById(`loading${x(t)}Icon`).style.display="inline-block",document.getElementById(`delete${x(t)}Icon`).style.display="none"}function S(t,n){let i=["shein","lager 157","divided","brandy melville","cubus","bubbleroom","bondelid","nelly","dobber","\xe5hl\xe9ns","kappahl","primark","jack & jones","sisters point","missguided","topman","bik bok","cubus","happy holly","zign","glamorous","hollister","river island","light before dark","bohoo","crocker","forever 21","maze","mint&berry","chiara forthi","zalando","din sko","pull & bear","svea","zoul","boohoo","gap","topshop","ellos","lager 157","stradivarius","studio total","indiska","bershka","shein","riley","vero moda","vila","don donna","aldo","new look denim"],r=document.getElementById("hardToSellDiv");document.getElementById("itemBrand").setCustomValidity("");let o=getParamsObject();return!o.id&&(i.includes(t.toLowerCase())||!["boots","dunjacka","jacka","k\xe4ngor","kappa","kavaj","kostym","p\xe4lsjacka","regnjacka","rock","skinnjacka","vinterskor"].includes(n?.toLowerCase())&&["tom tailor","monki","dressmann","urban outfitters","asos","holly & white","only","gina tricot"].includes(t.toLowerCase())||["baddr\xe4kt","bikini","bodysuit","chinos","flip-flops","halsduk","handduk","hatt","jeans","keps","l\xe5ng\xe4rmad t-shirt","linne","mjukisbyxor","morgonrock","m\xf6ssa","necess\xe4r","pik\xe9","pyjamas","sandaler","sarong","shorts","slips","sport-bh","strumpbyxor","t-shirt","tights","topp","tr\xe4ningsbyxor","tr\xe4ningstr\xf6ja","underst\xe4ll","vantar"].includes(n?.toLowerCase())&&["karl kani","rieker","uniqlo","carin wester","stockh lm","weekday","mango","wera","ichi","lindex","h&m","zara","mng","mq","cheap monday","h&m premium","na-kd","clarks","gant","hackett","hugo boss","la chemise","lacoste","lyle & scott","marc o'polo","melvin & hamilton","ray-ban","reebok","sebago","stenstr\xf6ms","the shirt factory","hampton republic","quicksilver","banana republic","pieces","sprit","denim","east west","xit","jacqueline de yong","mexx","fb sister","ok\xe4nt","bodyflirt","dorothy perkins","fransa","laurel","rut&circle","soc","junkyard","soyaconcept","amisu","u.s. polo assn.","line of oslo","gossip","i say","jascha stockholm","noisy may","six ames","velour by nostalgi","house of lola","fiveunits","miss me","flash","champion","under armour","oasis","fornarina","isolde","rosebud","chiquelle","kaffe","mckinley","cream","abercrombie & fitch","modstr\xf6m","ecco","esprit","alice bizous","craft","ellesse","wesc","dry lake","r\xf6hnisch","acqua limone","anna field","le","ax paris","burton","hansen & jacob","lou in love","mad lady","selected homme","tenson","whistles","zizzi","gerry weber"].includes(t.toLowerCase()))?(hardToSellText.innerHTML=i.includes(t.toLowerCase())?`Vi s\xe4ljer tyv\xe4rr inte ${t}-plagg p\xe5 grund av f\xf6r l\xe5g efterfr\xe5gan.`:`Vi s\xe4ljer tyv\xe4rr inte kategorin ${n} fr\xe5n ${t} p\xe5 grund av f\xf6r l\xe5g efterfr\xe5gan.`,stopIcon.style.display="flex",warningIcon.style.display="none",r.style.display="block",document.getElementById("itemBrand").setCustomValidity(i.includes(t.toLowerCase())?`Vi s\xe4ljer inte plagg fr\xe5n ${t}`:`Vi s\xe4ljer inte kategorin '${n}' fr\xe5n ${t}`),!0):["H&M","HM","Zara","ASOS","Nelly","Gina Tricot","BikBok","Bik Bok","Lindex","Kappahl","Cubus","NA-KD","NAKD","Mango","Ellos","Primark","Shein","Vila","Forever 21","Pull & Bear","Bershka","Stradivarius"].some(n=>t.toLowerCase().includes(n.toLowerCase()))?(hardToSellText.innerHTML=`Vi s\xe4ljer i regel inte ${t}-plagg p\xe5 grund av f\xf6r l\xe5gt andrahandsv\xe4rde. Undantag kan finnas.`,stopIcon.style.display="none",warningIcon.style.display="block",r.style.display="block",!0):void(r.style.display="none")}function B(t="Kategori",n=S){$("#itemCategory").select2({selectionCssClass:"form-field",placeholder:t||"Kategori",data:[{id:"",text:""},{text:"\xd6verdelar",children:[{id:"Tr\xf6ja",text:"Tr\xf6ja"},{id:"Blus",text:"Blus"},{id:"Topp",text:"Topp"},{id:"Skjorta",text:"Skjorta"},{id:"Linneskjorta",text:"Linneskjorta"},{id:"T-shirt",text:"T-shirt"},{id:"Kavaj",text:"Kavaj"},{id:"Sweatshirt",text:"Sweatshirt"},{id:"Hoodie",text:"Hoodie"},{id:"Polotr\xf6ja",text:"Polotr\xf6ja"},{id:"Tunika",text:"Tunika"},{id:"V\xe4st",text:"V\xe4st"},{id:"Kofta",text:"Kofta"},{id:"Linne",text:"Linne"},{id:"Tr\xe4ningstr\xf6ja",text:"Tr\xe4ningstr\xf6ja"},{id:"Poncho",text:"Poncho"},{id:"Pik\xe9",text:"Pik\xe9"},{id:"L\xe5ng\xe4rmad T-shirt",text:"L\xe5ng\xe4rmad T-shirt"},{id:"Kostymv\xe4st",text:"Kostymv\xe4st"}]},{text:"Underdelar",children:[{id:"Kjol",text:"Kjol"},{id:"Byxor",text:"Byxor"},{id:"Jeans",text:"Jeans"},{id:"Chinos",text:"Chinos"},{id:"Fritidsbyxor",text:"Fritidsbyxor"},{id:"Tr\xe4ningsbyxor",text:"Tr\xe4ningsbyxor"},{id:"Tights",text:"Tights"},{id:"Strumpbyxor",text:"Strumpbyxor"},{id:"Mjukisbyxor",text:"Mjukisbyxor"},{id:"Kostymbyxor",text:"Kostymbyxor"},{id:"Shorts",text:"Shorts"},{id:"Sarong",text:"Sarong"}]},{text:"Helkropp",children:[{id:"Kl\xe4nning",text:"Kl\xe4nning"},{id:"Kaftan",text:"Kaftan"},{id:"Kostym",text:"Kostym"},{id:"Set",text:"Set"},{id:"Jumpsuit",text:"Jumpsuit"},{id:"Baddr\xe4kt",text:"Baddr\xe4kt"},{id:"Bikini",text:"Bikini"},{id:"Pyjamas",text:"Pyjamas"},{id:"Morgonrock",text:"Morgonrock"},{id:"Br\xf6llopskl\xe4nning",text:"Br\xf6llopskl\xe4nning"},{id:"Balkl\xe4nning",text:"Balkl\xe4nning"},{id:"Bodysuit",text:"Bodysuit"},{id:"Underst\xe4ll",text:"Underst\xe4ll"}]},{text:"Ytterkl\xe4der",children:[{id:"Jacka",text:"Jacka"},{id:"Kappa",text:"Kappa"},{id:"Rock",text:"Rock"},{id:"Fritidsjacka",text:"Fritidsjacka"},{id:"Trenchcoat",text:"Trenchcoat"},{id:"Skinnjacka",text:"Skinnjacka"},{id:"Dunjacka",text:"Dunjacka"},{id:"Regnjacka",text:"Regnjacka"},{id:"P\xe4lsjacka",text:"P\xe4lsjacka"}]},{text:"Skor",children:[{id:"Sneakers",text:"Sneakers"},{id:"Sandaler",text:"Sandaler"},{id:"Klackar",text:"Klackar"},{id:"Ballerinaskor",text:"Ballerinaskor"},{id:"Loafers",text:"Loafers"},{id:"Flip-flops",text:"Flip-flops"},{id:"Regnst\xf6vlar",text:"Regnst\xf6vlar"},{id:"Boots",text:"Boots"},{id:"K\xe4ngor",text:"K\xe4ngor"},{id:"Vinterskor",text:"Vinterskor"},{id:"Skor",text:"Annat (Skor)"}]},{text:"V\xe4skor",children:[{id:"Axelremsv\xe4ska",text:"Axelremsv\xe4ska"},{id:"Handv\xe4ska",text:"Handv\xe4ska"},{id:"Kuvertv\xe4ska",text:"Kuvertv\xe4ska"},{id:"Ryggs\xe4ck",text:"Ryggs\xe4ck"},{id:"Tr\xe4ningsv\xe4ska",text:"Tr\xe4ningsv\xe4ska"},{id:"Resv\xe4ska",text:"Resv\xe4ska"},{id:"Datorv\xe4ska",text:"Datorv\xe4ska"},{id:"V\xe4ska",text:"Annat (V\xe4ska)"}]},{text:"Accessoarer",children:[{id:"Solglas\xf6gon",text:"Solglas\xf6gon"},{id:"Glas\xf6gon",text:"Glas\xf6gon"},{id:"\xd6rh\xe4nge",text:"\xd6rh\xe4nge"},{id:"Halsband",text:"Halsband"},{id:"Armband",text:"Armband"},{id:"Ring",text:"Ring"},{id:"Brosch",text:"Brosch"},{id:"Keps",text:"Keps"},{id:"Sjal",text:"Sjal"},{id:"Krage",text:"Krage"},{id:"B\xe4lte",text:"B\xe4lte"},{id:"Pl\xe5nbok",text:"Pl\xe5nbok"},{id:"Halsduk",text:"Halsduk"},{id:"Hatt",text:"Hatt"},{id:"M\xf6ssa",text:"M\xf6ssa"},{id:"Vantar",text:"Vantar"},{id:"Necess\xe4r",text:"Necess\xe4r"},{id:"Slips",text:"Slips"},{id:"Handduk",text:"Handduk"},{id:"Klocka",text:"Klocka"}]}]}),$("body").on("click",".select2-container--open .select2-results__group",function(){$(this).parent().attr("class").match(/expanded-group/)?$(this).parent().removeClass("expanded-group"):($(".expanded-group").first().removeClass("expanded-group"),$(this).parent().addClass("expanded-group"))});let i=!1;$("#itemCategory").on("select2:select",()=>{analytics.track("Click",{elementID:"itemCategoryValue"}),document.querySelector("#itemCategory").dispatchEvent(new Event("change"))});let r=!1;$("#itemCategory").on("select2:open",()=>{r||(r=!0,$("input.select2-search__field").on("click",()=>{analytics.track("Click",{elementID:"itemCategorySearch"})}))}),$("#itemCategory").on("select2:close",()=>{document.querySelector("body").style.overflow="auto",document.querySelector("body").style.position="static",document.querySelector("html").style.overflow="static"}),$("#itemCategory").on("select2:open",function(){analytics.track("Element Viewed",{elementID:"itemCategoryContainer"}),document.querySelector("body").style.overflow="hidden",document.querySelector("body").style.position="fixed",document.querySelector("html").style.overflow="fixed";let t=document.querySelector(".select2-search__field");if(t.placeholder="S\xf6k... (t.ex. Kl\xe4nning/Sneakers/Blus)",$(".select2-search__field").on("input",t=>{t.target.value.length>0?$(".select2-results__option[role=group]").each((t,n)=>$(n).addClass("expanded-group")):$(".expanded-group").each((t,n)=>$(n).removeClass("expanded-group"))}),!i){let t=document.getElementById("categoryPopUpHeader"),n=document.querySelector(".select2-dropdown");n.insertBefore(t,n.firstChild),t.style.display="block",t.querySelector("#categorySelectClose").onclick=()=>$("#itemCategory").select2("close"),i=!0}document.querySelector(".select2-results__options").addEventListener("scroll",()=>document.activeElement.blur())}),$("#itemCategory").on("change",t=>{w("itemCategoryLabel")(t);let i=document.getElementById("itemCategory"),r=document.getElementById("itemBrand");n(r.value,i.value)}),// From https://github.com/select2/select2/issues/3015#issuecomment-570171720
$("#itemCategory").on("select2:open",function(){$(".select2-results").css("visibility","hidden")}),$("#itemCategory").on("select2:opening",function(){setTimeout(function(){$(".select2-results").css("visibility","visible")},50)})}function w(t){return n=>{document.getElementById(t).style.display=n.target.value.length>0?"inline-block":"none"}}r.defineInteropFlag(i),r.export(i,"uploadTempImage",()=>o),r.export(i,"requestUniqueId",()=>u),r.export(i,"enhanceFrontImage",()=>m),r.export(i,"showDeleteImageIcon",()=>p),r.export(i,"rememberNewItemImageField",()=>y),r.export(i,"showImagePreview",()=>f),r.export(i,"capitalizeFirstLetter",()=>x),r.export(i,"uploadImageAndShowPreview",()=>v),r.export(i,"showImageError",()=>k),r.export(i,"hideImageError",()=>h),r.export(i,"showImageState",()=>b),r.export(i,"showLoadingIcon",()=>I),r.export(i,"checkBlockedOrLowShareSoldBrand",()=>S),r.export(i,"initializeCategorySelect",()=>B),r.export(i,"fieldLabelToggle",()=>w),r.export(i,"colorMapping",()=>T),r.export(i,"colorName",()=>E),r.export(i,"swedishColorToEnglish",()=>L);let T={Beige:"Beige",Blue:"Bl\xe5",Brown:"Brun",Green:"Gr\xf6n",Grey:"Gr\xe5",Yellow:"Gul",Gold:"Guld",Purple:"Lila",Navy:"Navy",Orange:"Orange",Pink:"Rosa",Red:"R\xf6d",Silver:"Silver",Black:"Svart",Turquoise:"Turkos",Burgundy:"Vinr\xf6d",White:"Vit",Multicolour:"Flerf\xe4rgad"};function E(t){return T[t]||t}function L(t){return Object.entries(T).find(([n,i])=>i.toLowerCase()===t.toLowerCase())?.[0]||t}},{"@parcel/transformer-js/src/esmodule-helpers.js":"bNgzC"}]},["dxOtH"],"dxOtH","parcelRequire81ca")//# sourceMappingURL=loadItemCards.js.map
;
//# sourceMappingURL=loadItemCards.js.map
