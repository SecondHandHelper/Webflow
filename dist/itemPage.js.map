{"mappings":"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","sources":["<anon>","itemPage.js"],"sourcesContent":["(function () {\nfunction $559cd7f2ce0a728f$var$loadItem(itemId) {\n    db.collection(\"items\").doc(itemId).get().then((doc)=>{\n        if (doc.exists) {\n            console.log(\"Item data:\", doc.data());\n            data = doc.data();\n            const itemId = doc.id;\n            const brand = data.brand;\n            const infoRequests = data.infoRequests;\n            let imgUrl = itemCoverImage(data);\n            const status = data.status;\n            const category = data.category ? data.category : \"\";\n            const longerPeriodAcceptedDate = data.longerPeriodAcceptedDate;\n            let statusText = \"\";\n            let publishedDate = data.publishedDate;\n            let daysLeftText = \"\";\n            if (data.publishedDate) {\n                publishedDate = new Date(publishedDate);\n                let nowDate = new Date();\n                let timeDifference = nowDate.getTime() - publishedDate.getTime();\n                let daysDifference = timeDifference / 86400000;\n                let sellingPeriodLength = longerPeriodAcceptedDate ? 60 : 30;\n                let daysLeft = Math.round(sellingPeriodLength - daysDifference);\n                if (daysLeft <= 0) daysLeftText = `0 dagar kvar`;\n                else daysLeftText = `${daysLeft} dagar kvar`;\n            }\n            let min = data.minPriceEstimate;\n            let max = data.maxPriceEstimate;\n            const valuationText = min && max ? `${min}-${max} kr` : \"\";\n            const soldPrice = data.soldPrice;\n            const sellerGets = data.sellerGets;\n            const payoutStatus = data.payoutStatus;\n            const shippingStatus = data.shippingStatus;\n            let text1 = \"\";\n            let text2 = \"\";\n            if (status === \"New\") {\n                if (infoRequests?.price?.status === \"Active\") {\n                    statusText = `Inväntar ditt svar`;\n                    text1 = \"P\\xe5 huvudsidan kan du se plaggets v\\xe4rdering och<br>v\\xe4lja om du vill s\\xe4lja till v\\xe4rderingen eller inte.\";\n                } else if (min && max) {\n                    statusText = `Förbereds`;\n                    text1 = \"F\\xf6rbereder det sista inf\\xf6r publicering.<br>Du f\\xe5r ett SMS n\\xe4r f\\xf6rs\\xe4ljningen p\\xe5b\\xf6rjas.\";\n                    text2 = valuationText;\n                } else {\n                    statusText = `Värdering pågår`;\n                    text1 = \"Du f\\xe5r ett SMS n\\xe4r v\\xe4rderingen \\xe4r klar.<br>V\\xe4rderingen tar normalt 2 vardagar.\";\n                }\n            }\n            if (status === \"Published\" && min && max) {\n                statusText = `Försäljning pågår`;\n                text1 = daysLeftText;\n                text2 = valuationText;\n            }\n            if (status === \"Sold\") {\n                statusText = `Såld!`;\n                itemStatusText.style.fontSize = \"18px\";\n                itemStatusText.style.fontWeight = \"500\";\n                text1 = payoutStatus === \"Payed\" ? \"\" : \"Utbetalning kommer via Swish inom en dag\";\n                if (shippingStatus === \"Not sent\") {\n                    text1 = \"Utbetalning sker n\\xe4r du skickat plagget\";\n                    toShipItemLink.href = window.location.origin + `/ship-item?id=${itemId}`;\n                    toShipItemLink.style.display = \"flex\";\n                }\n                sellerGetsTitle.innerHTML = payoutStatus === \"Payed\" ? \"Du fick\" : \"Du f\\xe5r\";\n                sellerGetsText.innerHTML = `${sellerGets} kr`;\n                sellerGetsDiv.style.display = \"flex\";\n            }\n            itemBrandText.innerHTML = brand;\n            itemCategoryText.innerHTML = category;\n            pageTitleDiv.style.display = \"flex\";\n            coverImageDiv.style.backgroundImage = `url('${imgUrl}')`;\n            itemStatusText.innerHTML = statusText;\n            itemText1.innerHTML = text1;\n            itemText2.innerHTML = text2;\n            itemDiv.style.display = \"block\";\n            loadingDiv.style.display = \"none\";\n        }\n    }).catch((e)=>{\n        console.log(\"Error getting item document:\", e);\n        errorHandler.report(e);\n    });\n}\nasync function $559cd7f2ce0a728f$var$loadItemEvents(itemId) {\n    itemEventsDiv.innerHTML = \"\";\n    let response = await fetch(`https://europe-west3-second-hand-helper.cloudfunctions.net/itemEvents/${itemId}`, {\n        method: \"GET\",\n        headers: {\n            \"Content-Type\": \"application/json\"\n        }\n    });\n    const events = await response.json();\n    console.log(events);\n    itemAddedEventExists = false;\n    if (events) {\n        for(let i = 0; i < events.length; i++){\n            const event = events[i];\n            if (event.type === \"itemAdded\") itemAddedEventExists = true;\n            // Build lists...\n            let style = i === events.length - 1 ? \"highlighted\" : \"\";\n            const component = $559cd7f2ce0a728f$var$getEventComponent(event, style);\n            if (component) {\n                let content = itemEventsDiv.innerHTML;\n                itemEventsDiv.innerHTML = component.concat(content);\n            }\n        }\n        itemEventsDiv.style.display = \"block\";\n        itemEventsLoadingDiv.style.display = \"none\";\n        // Show list if itemAdded exists\n        if (!itemAddedEventExists) sellingProcessDiv.style.display = \"none\";\n    }\n}\nfunction $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, text, time) {\n    return `<div class=\"div-block-135\"><div class=\"div-block-144\"><div class=\"div-block-142\">\n                        <div class=\"div-block-139\" style=\"display: ${displayLine};\"></div>\n                        </div>\n                        <div class=\"div-block-138\">${icon}</div>\n                        </div>\n                    <div class=\"div-block-136\">\n                        <div class=\"item-event-text ${className}\">${text}</div>\n                        <div class=\"text-block-82\">${time}</div>\n                    </div></div>`;\n}\nfunction $559cd7f2ce0a728f$var$getEventComponent(event, style) {\n    let className = \"\";\n    let icon = '<div class=\"div-block-143\"></div>';\n    // Highlighted event styling\n    if (style === \"highlighted\") {\n        className = \"highlighted-event\";\n        icon = '<img src=\"https://global-uploads.webflow.com/6297d3d527db5dd4cf02e924/62c53fa9db6d0f383ee430f9_check-mark%202%20(1).svg\" loading=\"lazy\" width=\"auto\" alt=\"\">';\n    }\n    const displayLine = \"block\";\n    const weekdays = [\n        \"S\\xf6n\",\n        \"M\\xe5n\",\n        \"Tis\",\n        \"Ons\",\n        \"Tor\",\n        \"Fre\",\n        \"L\\xf6r\",\n        \"S\\xf6n\"\n    ];\n    const months = [\n        \"Jan\",\n        \"Feb\",\n        \"Mar\",\n        \"Apr\",\n        \"Maj\",\n        \"Jun\",\n        \"Jul\",\n        \"Aug\",\n        \"Sep\",\n        \"Okt\",\n        \"Nov\",\n        \"Dec\"\n    ];\n    const date = new Date(event.timestamp);\n    const minutes = date.getMinutes() < 10 ? \"0\" + date.getMinutes() : date.getMinutes();\n    const hours = date.getHours() < 10 ? \"0\" + date.getHours() : date.getHours();\n    let time = weekdays[date.getDay()] + \" \" + hours + \":\" + minutes;\n    let now = new Date();\n    let daysDiff = Math.round((now.getTime() - date.getTime()) / 86400000);\n    if (daysDiff > 6) time = date.getDate() + \" \" + months[date.getMonth()] + \" \" + hours + \":\" + minutes;\n    if (event.type === \"itemAdded\") return $559cd7f2ce0a728f$var$eventComponentHtml(\"none\", icon, className, \"Plagg lades upp p\\xe5 Mai\", time);\n    if (event.type === \"valuationCompleted\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Värderades till ${event.data.min}-${event.data.max} kr`, time);\n    if (event.type === \"valuationAccepted\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Du accepterade värderingen`, time);\n    if (event.type === \"valuationFinalOffer\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Omvärderades till ${event.data.min}-${event.data.max} kr`, time);\n    if (event.type === \"itemPublished\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Försäljning påbörjades`, time);\n    if (event.type === \"priceAdjusted\") {\n        const { platform: platform, newPrice: newPrice } = event.data;\n        const capPlatform = platform && platform.charAt(0).toUpperCase() + platform.slice(1).split(/(?=[A-Z])/).join(\" \");\n        return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Pris sänktes till ${newPrice} kr ${platform && platform !== \"\" ? \" p\\xe5 \" + capPlatform : \"\"}`, time);\n    }\n    if (event.type === \"priceRequestSent\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Nytt prisförslag på ${event.data.min}-${event.data.max} kr`, time);\n    if (event.type === \"priceRequestResponse\") {\n        if (event.data.response === \"Accepted\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Du accepterade prisförslaget`, time);\n        else if (event.data.response === \"Denied\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Du avböjde prisförslaget`, time);\n    }\n    if (event.type === \"listingRenewal\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Annonser förnyades`, time);\n    if (event.type === \"platformAdded\") return (event.data.platforms || []).filter((p)=>p !== \"Google Shopping\" && p !== \"Instagram Shop\" && p !== \"Facebook Shop\").map((p)=>$559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Publicerades på ${p}${p === \"Mai Shop\" ? \"<br>(Google Shopping, Instagram Shop, Facebook Shop)\" : \"\"}`, time)).join(\"\\n\");\n    if (event.type === \"itemSold\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Såld för ${event.data.soldPrice} kr till ${event.data.buyerFirstName} i ${event.data.buyerAddressCity}`, time);\n    if (event.type === \"bagSentToSeller\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Fraktpåse skickades till dig`, time);\n    if (event.type === \"itemSent\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Plagget skickades iväg`, time);\n    if (event.type === \"payoutCompleted\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Du fick ${event.data.amount} kr utbetalt`, time);\n    if (event.type === \"valuationUserAdjusted\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Du justerade värderingen till ${event.data.min}-${event.data.max} kr`, time);\n    return false;\n}\neditItemLink.addEventListener(\"click\", function() {\n    location.href = `/edit-item?id=${params.id}`;\n});\n// Load item\n$559cd7f2ce0a728f$var$loadItem(params.id);\n$559cd7f2ce0a728f$var$loadItemEvents(params.id);\n\n})();\n//# sourceMappingURL=itemPage.js.map\n","function loadItem(itemId) {\n    db.collection(\"items\").doc(itemId)\n        .get().then((doc) => {\n        if (doc.exists) {\n            console.log(\"Item data:\", doc.data());\n            data = doc.data();\n            const itemId = doc.id;\n            const brand = data.brand;\n            const infoRequests = data.infoRequests;\n            let imgUrl = itemCoverImage(data);\n            const status = data.status;\n            const category = data.category ? data.category : \"\";\n            const longerPeriodAcceptedDate = data.longerPeriodAcceptedDate;\n            let statusText = \"\"\n            let publishedDate = data.publishedDate;\n            let daysLeftText = \"\";\n            if (data.publishedDate) {\n                publishedDate = new Date(publishedDate);\n                let nowDate = new Date();\n                let timeDifference = nowDate.getTime() - publishedDate.getTime();\n                let daysDifference = timeDifference / (1000 * 3600 * 24);\n                let sellingPeriodLength = longerPeriodAcceptedDate ? 60 : 30;\n                let daysLeft = Math.round(sellingPeriodLength - daysDifference);\n                if (daysLeft <= 0) {\n                    daysLeftText = `0 dagar kvar`;\n                } else {\n                    daysLeftText = `${daysLeft} dagar kvar`;\n                }\n            }\n            let min = data.minPriceEstimate;\n            let max = data.maxPriceEstimate;\n            const valuationText = min && max ? `${min}-${max} kr` : \"\";\n            const soldPrice = data.soldPrice;\n            const sellerGets = data.sellerGets;\n            const payoutStatus = data.payoutStatus;\n            const shippingStatus = data.shippingStatus;\n            let text1 = \"\";\n            let text2 = \"\";\n\n            if (status === \"New\") {\n                if (infoRequests?.price?.status === \"Active\") {\n                    statusText = `Inväntar ditt svar`;\n                    text1 = \"På huvudsidan kan du se plaggets värdering och<br>välja om du vill sälja till värderingen eller inte.\";\n                } else if (min && max) {\n                    statusText = `Förbereds`;\n                    text1 = \"Förbereder det sista inför publicering.<br>Du får ett SMS när försäljningen påbörjas.\";\n                    text2 = valuationText;\n                } else {\n                    statusText = `Värdering pågår`;\n                    text1 = \"Du får ett SMS när värderingen är klar.<br>Värderingen tar normalt 2 vardagar.\";\n                }\n            }\n            if (status === \"Published\" && min && max) {\n                statusText = `Försäljning pågår`;\n                text1 = daysLeftText;\n                text2 = valuationText;\n            }\n            if (status === \"Sold\") {\n                statusText = `Såld!`;\n                itemStatusText.style.fontSize = \"18px\";\n                itemStatusText.style.fontWeight = \"500\";\n                text1 = payoutStatus === \"Payed\" ? \"\" : \"Utbetalning kommer via Swish inom en dag\";\n                if (shippingStatus === \"Not sent\") {\n                    text1 = \"Utbetalning sker när du skickat plagget\"\n                    toShipItemLink.href = window.location.origin + `/ship-item?id=${itemId}`;\n                    toShipItemLink.style.display = \"flex\";\n                }\n                sellerGetsTitle.innerHTML = payoutStatus === \"Payed\" ? \"Du fick\" : \"Du får\";\n                sellerGetsText.innerHTML = `${sellerGets} kr`\n                sellerGetsDiv.style.display = \"flex\";\n            }\n\n            itemBrandText.innerHTML = brand;\n            itemCategoryText.innerHTML = category;\n            pageTitleDiv.style.display = \"flex\";\n            coverImageDiv.style.backgroundImage = `url('${imgUrl}')`;\n            itemStatusText.innerHTML = statusText;\n            itemText1.innerHTML = text1;\n            itemText2.innerHTML = text2;\n\n            itemDiv.style.display = \"block\";\n            loadingDiv.style.display = \"none\";\n        }\n    }).catch((e) => {\n        console.log(\"Error getting item document:\", e);\n        errorHandler.report(e);\n    });\n}\n\nasync function loadItemEvents(itemId) {\n    itemEventsDiv.innerHTML = '';\n    let response = await fetch(`https://europe-west3-second-hand-helper.cloudfunctions.net/itemEvents/${itemId}`, {\n        method: 'GET',\n        headers: {'Content-Type': 'application/json'},\n    });\n    const events = await response.json();\n    console.log(events);\n    itemAddedEventExists = false;\n\n    if (events) {\n        for (let i = 0; i < events.length; i++) {\n            const event = events[i];\n            if (event.type === 'itemAdded') {\n                itemAddedEventExists = true;\n            }\n\n            // Build lists...\n            let style = i === events.length - 1 ? 'highlighted' : '';\n            const component = getEventComponent(event, style);\n            if (component) {\n                let content = itemEventsDiv.innerHTML;\n                itemEventsDiv.innerHTML = component.concat(content);\n            }\n        }\n        itemEventsDiv.style.display = 'block';\n        itemEventsLoadingDiv.style.display = 'none';\n\n        // Show list if itemAdded exists\n        if (!itemAddedEventExists) {\n            sellingProcessDiv.style.display = 'none';\n        }\n    }\n}\n\nfunction eventComponentHtml(displayLine, icon, className, text, time) {\n    return `<div class=\"div-block-135\"><div class=\"div-block-144\"><div class=\"div-block-142\">\n                        <div class=\"div-block-139\" style=\"display: ${displayLine};\"></div>\n                        </div>\n                        <div class=\"div-block-138\">${icon}</div>\n                        </div>\n                    <div class=\"div-block-136\">\n                        <div class=\"item-event-text ${className}\">${text}</div>\n                        <div class=\"text-block-82\">${time}</div>\n                    </div></div>`;\n}\n\nfunction getEventComponent(event, style) {\n    let className = '';\n    let icon = '<div class=\"div-block-143\"></div>';\n    // Highlighted event styling\n    if (style === 'highlighted') {\n        className = 'highlighted-event';\n        icon = '<img src=\"https://global-uploads.webflow.com/6297d3d527db5dd4cf02e924/62c53fa9db6d0f383ee430f9_check-mark%202%20(1).svg\" loading=\"lazy\" width=\"auto\" alt=\"\">';\n    }\n    const displayLine = 'block';\n    const weekdays = ['Sön', 'Mån', 'Tis', 'Ons', 'Tor', 'Fre', 'Lör', 'Sön']\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'Maj', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec']\n    const date = new Date(event.timestamp);\n    const minutes = date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes();\n    const hours = date.getHours() < 10 ? '0' + date.getHours() : date.getHours();\n    let time = weekdays[date.getDay()] + \" \" + hours + \":\" + minutes;\n    let now = new Date();\n    let daysDiff = Math.round((now.getTime() - date.getTime()) / (1000 * 3600 * 24));\n    if (daysDiff > 6) {\n        time = date.getDate() + \" \" + months[date.getMonth()] + \" \" + hours + \":\" + minutes;\n    }\n\n    if (event.type === 'itemAdded') {\n        return eventComponentHtml('none', icon, className, 'Plagg lades upp på Mai', time);\n    }\n    if (event.type === 'valuationCompleted') {\n        return eventComponentHtml(displayLine, icon, className, `Värderades till ${event.data.min}-${event.data.max} kr`, time);\n    }\n    if (event.type === 'valuationAccepted') {\n        return eventComponentHtml(displayLine, icon, className, `Du accepterade värderingen`, time);\n    }\n    if (event.type === 'valuationFinalOffer') {\n        return eventComponentHtml(displayLine, icon, className, `Omvärderades till ${event.data.min}-${event.data.max} kr`, time);\n    }\n    if (event.type === 'itemPublished') {\n        return eventComponentHtml(displayLine, icon, className, `Försäljning påbörjades`, time);\n    }\n    if (event.type === 'priceAdjusted') {\n        const {platform, newPrice} = event.data\n        const capPlatform = platform && platform.charAt(0).toUpperCase() + platform.slice(1).split(/(?=[A-Z])/).join(' ');\n        return eventComponentHtml(displayLine, icon, className,\n            `Pris sänktes till ${newPrice} kr ${platform && platform !== '' ? ' på ' + capPlatform : ''}`,\n            time);\n    }\n    if (event.type === 'priceRequestSent') {\n        return eventComponentHtml(displayLine, icon, className, `Nytt prisförslag på ${event.data.min}-${event.data.max} kr`, time);\n    }\n    if (event.type === 'priceRequestResponse') {\n        if (event.data.response === 'Accepted') {\n            return eventComponentHtml(displayLine, icon, className, `Du accepterade prisförslaget`, time);\n        } else if (event.data.response === 'Denied') {\n            return eventComponentHtml(displayLine, icon, className, `Du avböjde prisförslaget`, time);\n        }\n    }\n    if (event.type === 'listingRenewal') {\n        return eventComponentHtml(displayLine, icon, className, `Annonser förnyades`, time);\n    }\n    if (event.type === 'platformAdded') {\n        return (event.data.platforms || [])\n            .filter(p => p !== 'Google Shopping' && p !== 'Instagram Shop' && p !== 'Facebook Shop')\n            .map(p => eventComponentHtml(displayLine, icon, className,\n                `Publicerades på ${p}${p === 'Mai Shop' ? '<br>(Google Shopping, Instagram Shop, Facebook Shop)' : ''}`,\n                time))\n            .join('\\n');\n    }\n    if (event.type === 'itemSold') {\n        return eventComponentHtml(displayLine, icon, className,\n            `Såld för ${event.data.soldPrice} kr till ${event.data.buyerFirstName} i ${event.data.buyerAddressCity}`,\n            time);\n    }\n    if (event.type === 'bagSentToSeller') {\n        return eventComponentHtml(displayLine, icon, className, `Fraktpåse skickades till dig`, time);\n    }\n    if (event.type === 'itemSent') {\n        return eventComponentHtml(displayLine, icon, className, `Plagget skickades iväg`, time);\n    }\n    if (event.type === 'payoutCompleted') {\n        return eventComponentHtml(displayLine, icon, className, `Du fick ${event.data.amount} kr utbetalt`, time);\n    }\n    if (event.type === 'valuationUserAdjusted') {\n        return eventComponentHtml(displayLine, icon, className, `Du justerade värderingen till ${event.data.min}-${event.data.max} kr`, time);\n    }\n    return false;\n}\n\neditItemLink.addEventListener('click', function () {\n    location.href = `/edit-item?id=${params.id}`;\n});\n\n// Load item\nloadItem(params.id);\nloadItemEvents(params.id);\n"],"names":["$559cd7f2ce0a728f$var$loadItemEvents","itemId","itemEventsDiv","innerHTML","response","fetch","method","headers","events","json","console","log","itemAddedEventExists","i","length","event","type","style","component","$559cd7f2ce0a728f$var$getEventComponent","className","icon","displayLine","date","Date","timestamp","minutes","getMinutes","hours","getHours","time","weekdays","getDay","Math","round","now","getTime","getDate","months","getMonth","$559cd7f2ce0a728f$var$eventComponentHtml","data","min","max","platform","newPrice","capPlatform","charAt","toUpperCase","slice","split","join","platforms","filter","p","map","soldPrice","buyerFirstName","buyerAddressCity","amount","content","concat","display","itemEventsLoadingDiv","sellingProcessDiv","text","editItemLink","addEventListener","location","href","params","id","db","collection","doc","get","then","exists","brand","infoRequests","imgUrl","itemCoverImage","status","category","longerPeriodAcceptedDate","statusText","publishedDate","daysLeftText","daysLeft","sellingPeriodLength","timeDifference","nowDate","minPriceEstimate","maxPriceEstimate","valuationText","sellerGets","payoutStatus","shippingStatus","text1","text2","price","itemStatusText","fontSize","fontWeight","toShipItemLink","window","origin","sellerGetsTitle","sellerGetsText","sellerGetsDiv","itemBrandText","itemCategoryText","pageTitleDiv","coverImageDiv","backgroundImage","itemText1","itemText2","itemDiv","loadingDiv","catch","e","errorHandler","report"],"version":3,"file":"itemPage.js.map"}