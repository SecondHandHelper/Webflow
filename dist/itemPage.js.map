{"mappings":"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","sources":["<anon>","itemPage.js"],"sourcesContent":["(function () {\nfunction $559cd7f2ce0a728f$var$loadItem(itemId) {\n    db.collection(\"items\").doc(itemId).get().then((doc)=>{\n        if (doc.exists) {\n            console.log(\"Item data:\", doc.data());\n            data = doc.data();\n            const itemId = doc.id;\n            const brand = data.brand;\n            const infoRequests = data.infoRequests;\n            let imgUrl = itemCoverImage(data);\n            const status = data.status;\n            const category = data.category ? data.category : \"\";\n            const longerPeriodAcceptedDate = data.longerPeriodAcceptedDate;\n            let statusText = \"\";\n            let publishedDate = data.publishedDate;\n            let daysLeftText = \"\";\n            if (data.publishedDate) {\n                publishedDate = new Date(publishedDate);\n                let nowDate = new Date();\n                let timeDifference = nowDate.getTime() - publishedDate.getTime();\n                let daysDifference = timeDifference / 86400000;\n                let sellingPeriodLength = longerPeriodAcceptedDate ? 60 : 30;\n                let daysLeft = Math.round(sellingPeriodLength - daysDifference);\n                if (daysLeft <= 0) daysLeftText = `0 dagar kvar`;\n                else daysLeftText = `${daysLeft} dagar kvar`;\n            }\n            let min = data.minPriceEstimate;\n            let max = data.maxPriceEstimate;\n            const valuationText = min && max ? `${min}-${max} kr` : \"\";\n            const soldPrice = data.soldPrice;\n            const sellerGets = data.sellerGets;\n            const payoutStatus = data.payoutStatus;\n            const shippingStatus = data.shippingStatus;\n            let text1 = \"\";\n            let text2 = \"\";\n            if (status === \"New\") {\n                if (infoRequests?.price?.status === \"Active\") {\n                    statusText = `Inv\\xe4ntar ditt svar`;\n                    text1 = \"P\\xe5 huvudsidan kan du se plaggets v\\xe4rdering och<br>v\\xe4lja om du vill s\\xe4lja till v\\xe4rderingen eller inte.\";\n                } else if (min && max) {\n                    statusText = `F\\xf6rbereds`;\n                    text1 = \"F\\xf6rbereder det sista inf\\xf6r publicering.<br>Du f\\xe5r ett SMS n\\xe4r f\\xf6rs\\xe4ljningen p\\xe5b\\xf6rjas.\";\n                    text2 = valuationText;\n                } else {\n                    statusText = `V\\xe4rdering p\\xe5g\\xe5r`;\n                    text1 = \"Du f\\xe5r ett SMS n\\xe4r v\\xe4rderingen \\xe4r klar.<br>V\\xe4rderingen tar normalt 2 vardagar.\";\n                }\n            }\n            if (status === \"Published\" && min && max) {\n                statusText = `F\\xf6rs\\xe4ljning p\\xe5g\\xe5r`;\n                text1 = daysLeftText;\n                text2 = valuationText;\n            }\n            if (status === \"Sold\") {\n                statusText = `S\\xe5ld!`;\n                itemStatusText.style.fontSize = \"18px\";\n                itemStatusText.style.fontWeight = \"500\";\n                text1 = payoutStatus === \"Payed\" ? \"\" : \"Utbetalning kommer via Swish inom en dag\";\n                if (shippingStatus === \"Not sent\") {\n                    text1 = \"Utbetalning sker n\\xe4r du skickat plagget\";\n                    toShipItemLink.href = window.location.origin + `/ship-item?id=${itemId}`;\n                    toShipItemLink.style.display = \"flex\";\n                }\n                sellerGetsTitle.innerHTML = payoutStatus === \"Payed\" ? \"Du fick\" : \"Du f\\xe5r\";\n                sellerGetsText.innerHTML = `${sellerGets} kr`;\n                sellerGetsDiv.style.display = \"flex\";\n            }\n            itemBrandText.innerHTML = brand;\n            itemCategoryText.innerHTML = category;\n            pageTitleDiv.style.display = \"flex\";\n            coverImageDiv.style.backgroundImage = `url('${imgUrl}')`;\n            itemStatusText.innerHTML = statusText;\n            itemText1.innerHTML = text1;\n            itemText2.innerHTML = text2;\n            itemDiv.style.display = \"block\";\n            loadingDiv.style.display = \"none\";\n        }\n    }).catch((e)=>{\n        console.log(\"Error getting item document:\", e);\n        errorHandler.report(e);\n    });\n}\nasync function $559cd7f2ce0a728f$var$loadItemEvents(itemId) {\n    itemEventsDiv.innerHTML = \"\";\n    let response = await fetch(`https://europe-west3-second-hand-helper.cloudfunctions.net/itemEvents/${itemId}`, {\n        method: \"GET\",\n        headers: {\n            \"Content-Type\": \"application/json\"\n        }\n    });\n    const events = await response.json();\n    console.log(events);\n    itemAddedEventExists = false;\n    if (events) {\n        for(let i = 0; i < events.length; i++){\n            const event = events[i];\n            if (event.type === \"itemAdded\") itemAddedEventExists = true;\n            // Build lists...\n            let style = i === events.length - 1 ? \"highlighted\" : \"\";\n            const component = $559cd7f2ce0a728f$var$getEventComponent(event, style);\n            if (component) {\n                let content = itemEventsDiv.innerHTML;\n                itemEventsDiv.innerHTML = component.concat(content);\n            }\n        }\n        itemEventsDiv.style.display = \"block\";\n        itemEventsLoadingDiv.style.display = \"none\";\n        // Show list if itemAdded exists\n        if (!itemAddedEventExists) sellingProcessDiv.style.display = \"none\";\n    }\n}\nfunction $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, text, time) {\n    return `<div class=\"div-block-135\"><div class=\"div-block-144\"><div class=\"div-block-142\">\n                        <div class=\"div-block-139\" style=\"display: ${displayLine};\"></div>\n                        </div>\n                        <div class=\"div-block-138\">${icon}</div>\n                        </div>\n                    <div class=\"div-block-136\">\n                        <div class=\"item-event-text ${className}\">${text}</div>\n                        <div class=\"text-block-82\">${time}</div>\n                    </div></div>`;\n}\nfunction $559cd7f2ce0a728f$var$getEventComponent(event, style) {\n    let className = \"\";\n    let icon = '<div class=\"div-block-143\"></div>';\n    // Highlighted event styling\n    if (style === \"highlighted\") {\n        className = \"highlighted-event\";\n        icon = '<img src=\"https://global-uploads.webflow.com/6297d3d527db5dd4cf02e924/62c53fa9db6d0f383ee430f9_check-mark%202%20(1).svg\" loading=\"lazy\" width=\"auto\" alt=\"\">';\n    }\n    const displayLine = \"block\";\n    const weekdays = [\n        \"S\\xf6n\",\n        \"M\\xe5n\",\n        \"Tis\",\n        \"Ons\",\n        \"Tor\",\n        \"Fre\",\n        \"L\\xf6r\",\n        \"S\\xf6n\"\n    ];\n    const months = [\n        \"Jan\",\n        \"Feb\",\n        \"Mar\",\n        \"Apr\",\n        \"Maj\",\n        \"Jun\",\n        \"Jul\",\n        \"Aug\",\n        \"Sep\",\n        \"Okt\",\n        \"Nov\",\n        \"Dec\"\n    ];\n    const date = new Date(event.timestamp);\n    const minutes = date.getMinutes() < 10 ? \"0\" + date.getMinutes() : date.getMinutes();\n    const hours = date.getHours() < 10 ? \"0\" + date.getHours() : date.getHours();\n    let time = weekdays[date.getDay()] + \" \" + hours + \":\" + minutes;\n    let now = new Date();\n    let daysDiff = Math.round((now.getTime() - date.getTime()) / 86400000);\n    if (daysDiff > 6) time = date.getDate() + \" \" + months[date.getMonth()] + \" \" + hours + \":\" + minutes;\n    if (event.type === \"itemAdded\") return $559cd7f2ce0a728f$var$eventComponentHtml(\"none\", icon, className, \"Plagg lades upp p\\xe5 Mai\", time);\n    if (event.type === \"valuationCompleted\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `V\\xe4rderades till ${event.data.min}-${event.data.max} kr`, time);\n    if (event.type === \"valuationAccepted\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Du accepterade v\\xe4rderingen`, time);\n    if (event.type === \"valuationFinalOffer\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Omv\\xe4rderades till ${event.data.min}-${event.data.max} kr`, time);\n    if (event.type === \"itemPublished\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `F\\xf6rs\\xe4ljning p\\xe5b\\xf6rjades`, time);\n    if (event.type === \"priceAdjusted\") {\n        const { platform: platform, newPrice: newPrice } = event.data;\n        const capPlatform = platform && platform.charAt(0).toUpperCase() + platform.slice(1).split(/(?=[A-Z])/).join(\" \");\n        return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Pris s\\xe4nktes till ${newPrice} kr ${platform && platform !== \"\" ? \" p\\xe5 \" + capPlatform : \"\"}`, time);\n    }\n    if (event.type === \"priceRequestSent\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Nytt prisf\\xf6rslag p\\xe5 ${event.data.min}-${event.data.max} kr`, time);\n    if (event.type === \"priceRequestResponse\") {\n        if (event.data.response === \"Accepted\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Du accepterade prisf\\xf6rslaget`, time);\n        else if (event.data.response === \"Denied\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Du avb\\xf6jde prisf\\xf6rslaget`, time);\n    }\n    if (event.type === \"listingRenewal\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Annonser f\\xf6rnyades`, time);\n    if (event.type === \"platformAdded\") return (event.data.platforms || []).filter((p)=>p !== \"Google Shopping\" && p !== \"Instagram Shop\" && p !== \"Facebook Shop\").map((p)=>$559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Publicerades p\\xe5 ${p}${p === \"Mai Shop\" ? \"<br>(Google Shopping, Instagram Shop, Facebook Shop)\" : \"\"}`, time)).join(\"\\n\");\n    if (event.type === \"itemSold\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `S\\xe5ld f\\xf6r ${event.data.soldPrice} kr till ${event.data.buyerFirstName} i ${event.data.buyerAddressCity}`, time);\n    if (event.type === \"bagSentToSeller\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Fraktp\\xe5se skickades till dig`, time);\n    if (event.type === \"itemSent\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Plagget skickades iv\\xe4g`, time);\n    if (event.type === \"payoutCompleted\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Du fick ${event.data.amount} kr utbetalt`, time);\n    if (event.type === \"valuationUserAdjusted\") return $559cd7f2ce0a728f$var$eventComponentHtml(displayLine, icon, className, `Du justerade v\\xe4rderingen till ${event.data.min}-${event.data.max} kr`, time);\n    return false;\n}\neditItemLink.addEventListener(\"click\", function() {\n    location.href = `/edit-item?id=${params.id}`;\n});\n// Load item\n$559cd7f2ce0a728f$var$loadItem(params.id);\n$559cd7f2ce0a728f$var$loadItemEvents(params.id);\n\n})();\n//# sourceMappingURL=itemPage.js.map\n","function loadItem(itemId) {\n    db.collection(\"items\").doc(itemId)\n        .get().then((doc) => {\n        if (doc.exists) {\n            console.log(\"Item data:\", doc.data());\n            data = doc.data();\n            const itemId = doc.id;\n            const brand = data.brand;\n            const infoRequests = data.infoRequests;\n            let imgUrl = itemCoverImage(data);\n            const status = data.status;\n            const category = data.category ? data.category : \"\";\n            const longerPeriodAcceptedDate = data.longerPeriodAcceptedDate;\n            let statusText = \"\"\n            let publishedDate = data.publishedDate;\n            let daysLeftText = \"\";\n            if (data.publishedDate) {\n                publishedDate = new Date(publishedDate);\n                let nowDate = new Date();\n                let timeDifference = nowDate.getTime() - publishedDate.getTime();\n                let daysDifference = timeDifference / (1000 * 3600 * 24);\n                let sellingPeriodLength = longerPeriodAcceptedDate ? 60 : 30;\n                let daysLeft = Math.round(sellingPeriodLength - daysDifference);\n                if (daysLeft <= 0) {\n                    daysLeftText = `0 dagar kvar`;\n                } else {\n                    daysLeftText = `${daysLeft} dagar kvar`;\n                }\n            }\n            let min = data.minPriceEstimate;\n            let max = data.maxPriceEstimate;\n            const valuationText = min && max ? `${min}-${max} kr` : \"\";\n            const soldPrice = data.soldPrice;\n            const sellerGets = data.sellerGets;\n            const payoutStatus = data.payoutStatus;\n            const shippingStatus = data.shippingStatus;\n            let text1 = \"\";\n            let text2 = \"\";\n\n            if (status === \"New\") {\n                if (infoRequests?.price?.status === \"Active\") {\n                    statusText = `Inväntar ditt svar`;\n                    text1 = \"På huvudsidan kan du se plaggets värdering och<br>välja om du vill sälja till värderingen eller inte.\";\n                } else if (min && max) {\n                    statusText = `Förbereds`;\n                    text1 = \"Förbereder det sista inför publicering.<br>Du får ett SMS när försäljningen påbörjas.\";\n                    text2 = valuationText;\n                } else {\n                    statusText = `Värdering pågår`;\n                    text1 = \"Du får ett SMS när värderingen är klar.<br>Värderingen tar normalt 2 vardagar.\";\n                }\n            }\n            if (status === \"Published\" && min && max) {\n                statusText = `Försäljning pågår`;\n                text1 = daysLeftText;\n                text2 = valuationText;\n            }\n            if (status === \"Sold\") {\n                statusText = `Såld!`;\n                itemStatusText.style.fontSize = \"18px\";\n                itemStatusText.style.fontWeight = \"500\";\n                text1 = payoutStatus === \"Payed\" ? \"\" : \"Utbetalning kommer via Swish inom en dag\";\n                if (shippingStatus === \"Not sent\") {\n                    text1 = \"Utbetalning sker när du skickat plagget\"\n                    toShipItemLink.href = window.location.origin + `/ship-item?id=${itemId}`;\n                    toShipItemLink.style.display = \"flex\";\n                }\n                sellerGetsTitle.innerHTML = payoutStatus === \"Payed\" ? \"Du fick\" : \"Du får\";\n                sellerGetsText.innerHTML = `${sellerGets} kr`\n                sellerGetsDiv.style.display = \"flex\";\n            }\n\n            itemBrandText.innerHTML = brand;\n            itemCategoryText.innerHTML = category;\n            pageTitleDiv.style.display = \"flex\";\n            coverImageDiv.style.backgroundImage = `url('${imgUrl}')`;\n            itemStatusText.innerHTML = statusText;\n            itemText1.innerHTML = text1;\n            itemText2.innerHTML = text2;\n\n            itemDiv.style.display = \"block\";\n            loadingDiv.style.display = \"none\";\n        }\n    }).catch((e) => {\n        console.log(\"Error getting item document:\", e);\n        errorHandler.report(e);\n    });\n}\n\nasync function loadItemEvents(itemId) {\n    itemEventsDiv.innerHTML = '';\n    let response = await fetch(`https://europe-west3-second-hand-helper.cloudfunctions.net/itemEvents/${itemId}`, {\n        method: 'GET',\n        headers: {'Content-Type': 'application/json'},\n    });\n    const events = await response.json();\n    console.log(events);\n    itemAddedEventExists = false;\n\n    if (events) {\n        for (let i = 0; i < events.length; i++) {\n            const event = events[i];\n            if (event.type === 'itemAdded') {\n                itemAddedEventExists = true;\n            }\n\n            // Build lists...\n            let style = i === events.length - 1 ? 'highlighted' : '';\n            const component = getEventComponent(event, style);\n            if (component) {\n                let content = itemEventsDiv.innerHTML;\n                itemEventsDiv.innerHTML = component.concat(content);\n            }\n        }\n        itemEventsDiv.style.display = 'block';\n        itemEventsLoadingDiv.style.display = 'none';\n\n        // Show list if itemAdded exists\n        if (!itemAddedEventExists) {\n            sellingProcessDiv.style.display = 'none';\n        }\n    }\n}\n\nfunction eventComponentHtml(displayLine, icon, className, text, time) {\n    return `<div class=\"div-block-135\"><div class=\"div-block-144\"><div class=\"div-block-142\">\n                        <div class=\"div-block-139\" style=\"display: ${displayLine};\"></div>\n                        </div>\n                        <div class=\"div-block-138\">${icon}</div>\n                        </div>\n                    <div class=\"div-block-136\">\n                        <div class=\"item-event-text ${className}\">${text}</div>\n                        <div class=\"text-block-82\">${time}</div>\n                    </div></div>`;\n}\n\nfunction getEventComponent(event, style) {\n    let className = '';\n    let icon = '<div class=\"div-block-143\"></div>';\n    // Highlighted event styling\n    if (style === 'highlighted') {\n        className = 'highlighted-event';\n        icon = '<img src=\"https://global-uploads.webflow.com/6297d3d527db5dd4cf02e924/62c53fa9db6d0f383ee430f9_check-mark%202%20(1).svg\" loading=\"lazy\" width=\"auto\" alt=\"\">';\n    }\n    const displayLine = 'block';\n    const weekdays = ['Sön', 'Mån', 'Tis', 'Ons', 'Tor', 'Fre', 'Lör', 'Sön']\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'Maj', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec']\n    const date = new Date(event.timestamp);\n    const minutes = date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes();\n    const hours = date.getHours() < 10 ? '0' + date.getHours() : date.getHours();\n    let time = weekdays[date.getDay()] + \" \" + hours + \":\" + minutes;\n    let now = new Date();\n    let daysDiff = Math.round((now.getTime() - date.getTime()) / (1000 * 3600 * 24));\n    if (daysDiff > 6) {\n        time = date.getDate() + \" \" + months[date.getMonth()] + \" \" + hours + \":\" + minutes;\n    }\n\n    if (event.type === 'itemAdded') {\n        return eventComponentHtml('none', icon, className, 'Plagg lades upp på Mai', time);\n    }\n    if (event.type === 'valuationCompleted') {\n        return eventComponentHtml(displayLine, icon, className, `Värderades till ${event.data.min}-${event.data.max} kr`, time);\n    }\n    if (event.type === 'valuationAccepted') {\n        return eventComponentHtml(displayLine, icon, className, `Du accepterade värderingen`, time);\n    }\n    if (event.type === 'valuationFinalOffer') {\n        return eventComponentHtml(displayLine, icon, className, `Omvärderades till ${event.data.min}-${event.data.max} kr`, time);\n    }\n    if (event.type === 'itemPublished') {\n        return eventComponentHtml(displayLine, icon, className, `Försäljning påbörjades`, time);\n    }\n    if (event.type === 'priceAdjusted') {\n        const {platform, newPrice} = event.data\n        const capPlatform = platform && platform.charAt(0).toUpperCase() + platform.slice(1).split(/(?=[A-Z])/).join(' ');\n        return eventComponentHtml(displayLine, icon, className,\n            `Pris sänktes till ${newPrice} kr ${platform && platform !== '' ? ' på ' + capPlatform : ''}`,\n            time);\n    }\n    if (event.type === 'priceRequestSent') {\n        return eventComponentHtml(displayLine, icon, className, `Nytt prisförslag på ${event.data.min}-${event.data.max} kr`, time);\n    }\n    if (event.type === 'priceRequestResponse') {\n        if (event.data.response === 'Accepted') {\n            return eventComponentHtml(displayLine, icon, className, `Du accepterade prisförslaget`, time);\n        } else if (event.data.response === 'Denied') {\n            return eventComponentHtml(displayLine, icon, className, `Du avböjde prisförslaget`, time);\n        }\n    }\n    if (event.type === 'listingRenewal') {\n        return eventComponentHtml(displayLine, icon, className, `Annonser förnyades`, time);\n    }\n    if (event.type === 'platformAdded') {\n        return (event.data.platforms || [])\n            .filter(p => p !== 'Google Shopping' && p !== 'Instagram Shop' && p !== 'Facebook Shop')\n            .map(p => eventComponentHtml(displayLine, icon, className,\n                `Publicerades på ${p}${p === 'Mai Shop' ? '<br>(Google Shopping, Instagram Shop, Facebook Shop)' : ''}`,\n                time))\n            .join('\\n');\n    }\n    if (event.type === 'itemSold') {\n        return eventComponentHtml(displayLine, icon, className,\n            `Såld för ${event.data.soldPrice} kr till ${event.data.buyerFirstName} i ${event.data.buyerAddressCity}`,\n            time);\n    }\n    if (event.type === 'bagSentToSeller') {\n        return eventComponentHtml(displayLine, icon, className, `Fraktpåse skickades till dig`, time);\n    }\n    if (event.type === 'itemSent') {\n        return eventComponentHtml(displayLine, icon, className, `Plagget skickades iväg`, time);\n    }\n    if (event.type === 'payoutCompleted') {\n        return eventComponentHtml(displayLine, icon, className, `Du fick ${event.data.amount} kr utbetalt`, time);\n    }\n    if (event.type === 'valuationUserAdjusted') {\n        return eventComponentHtml(displayLine, icon, className, `Du justerade värderingen till ${event.data.min}-${event.data.max} kr`, time);\n    }\n    return false;\n}\n\neditItemLink.addEventListener('click', function () {\n    location.href = `/edit-item?id=${params.id}`;\n});\n\n// Load item\nloadItem(params.id);\nloadItemEvents(params.id);\n"],"names":["$559cd7f2ce0a728f$var$loadItemEvents","itemId","itemEventsDiv","innerHTML","response","fetch","method","headers","events","json","console","log","itemAddedEventExists","i","length","event","type","component","$559cd7f2ce0a728f$var$getEventComponent","style","className","icon","displayLine","date","Date","timestamp","minutes","getMinutes","hours","getHours","time","weekdays","getDay","Math","round","now","getTime","getDate","months","getMonth","$559cd7f2ce0a728f$var$eventComponentHtml","data","min","max","platform","newPrice","capPlatform","charAt","toUpperCase","slice","split","join","platforms","filter","p","map","soldPrice","buyerFirstName","buyerAddressCity","amount","content","concat","display","itemEventsLoadingDiv","sellingProcessDiv","text","editItemLink","addEventListener","location","href","params","id","$559cd7f2ce0a728f$var$loadItem","db","collection","doc","get","then","exists","brand","infoRequests","imgUrl","itemCoverImage","status","category","longerPeriodAcceptedDate","statusText","publishedDate","daysLeftText","daysLeft","sellingPeriodLength","timeDifference","nowDate","minPriceEstimate","maxPriceEstimate","valuationText","sellerGets","payoutStatus","shippingStatus","text1","text2","price","itemStatusText","fontSize","fontWeight","toShipItemLink","window","origin","sellerGetsTitle","sellerGetsText","sellerGetsDiv","itemBrandText","itemCategoryText","pageTitleDiv","coverImageDiv","backgroundImage","itemText1","itemText2","itemDiv","loadingDiv","catch","e","errorHandler","report"],"version":3,"file":"itemPage.js.map"}